
Object.keys=Object.keys||function(o){var result=[];for(var name in o){if(o.hasOwnProperty(name))
result.push(name);}
return result;};if(!Array.prototype.indexOf){indexOf=function(list,elt){var len=list.length>>>0;var from=0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0)
from+=len;for(;from<len;from++)
if(list[from]===elt)
return from;return-1;};}else{indexOf=function(list,elt){return list.indexOf(elt);}}
if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};String.prototype.ltrim=function(){return this.replace(/^\s+/,'');};String.prototype.rtrim=function(){return this.replace(/\s+$/,'');};String.prototype.fulltrim=function(){return this.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,'').replace(/\s+/g,' ');};}
getKey=function(obj,index){var keys=Object.keys(obj);return keys[index];}
getValue=function(obj,index){return obj[getKey(obj,index)];}
getFirstKey=function(obj){return getKey(obj,0);}
getFirstValue=function(obj){return getValue(obj,0);}
searchKey=function(obj,key){var keys=Object.keys(obj);return indexOf(keys,key.toString());}
hasKey=function(obj,key){return searchKey(obj,key)!==-1;}
find=function(list,elt){return indexOf(list,elt)!==-1;}
pixartParseFloat=function(v){return parseFloat(v)||0;}
minNotZero=function(){var numbers=[];for(var i=0;i<arguments.length;i++){var num=pixartParseFloat(arguments[i]);if(num>0)
numbers.push(num);}
if(numbers.length>0)
return Math.min.apply(Math,numbers);else
return 0;}
keyMinNotZero=function(list,keys){var newList=[];if(typeof(keys)=='undefined')
keys=Object.keys(list);for(var i in keys)
if(pixartParseFloat(list[keys[i]])==list[keys[i]])
newList.push(list[keys[i]]);var min=minNotZero.apply(null,newList);var index=indexOf(newList,min);return keys[index];}
isDefined=function(obj){return typeof(obj)!='undefined';}
isUndefined=function(obj){return!isDefined(obj);}
normalizeNumber=function(n){if(n=="Infinity"||isNaN(n))
return 0;return n;}
if(isUndefined(window['count']))
count=function(obj){var c=0;for(var i in obj)c++;return c;}
exceeds=function(base,altezza,DIM){var b=Math.max(base,altezza);var h=Math.min(base,altezza);var container=DIM.split('x');var B=Math.max(container[0],container[1]);var H=Math.min(container[0],container[1]);if(b>B||h>B||(h>H&&b>H))return true;else return false;}
ProductView=function(ctr){var self=this;self.ctr=ctr;self.cache={};self.conversionClass=null;self.conversionData={};self.conversionFunction=null;self.conversionLabels={};self.conversionFeatures={};self.templates={'select':'.feature-select','gallery':'.feature-gallery','input':'.feature-input','fastlane':'.feature-fastlane','dataSpedizione':'.top_data_spedizione','prezzo':'.dettaglio_quantita','Quantity':'.quantity','Arrow':'.row_fa','rowQuantity':'.row_qta_data'};var priceGrid={};var intro=introJs();var viewStep={};var viewedStep=$.cookie('introStep')?JSON.parse($.cookie('introStep')):{};var label_promo='<span class="label label-pill label-info">Promo</span>';var label_arrow='<i class="fa fa-angle-down"></i>';widthXsSmall=function(){return($(window).width()<768)?true:false;};widthSmall=function(){return($(window).width()>=768&&$(window).width()<992)?true:false;};widthMedium=function(){return($(window).width()>=992&&$(window).width()<1200)?true:false;};widthLarge=function(){return($(window).width()>=1200)?true:false;};var width_xs=widthXsSmall();var width_sm=widthSmall();var width_md=widthMedium();var width_lg=widthLarge();var numValidates=0;var firstInvalidFeature=-1;var width=$(window).width();var numero_priorita_visibili=0;var numero_priorita=1;var limite_qta_visibili=5;var categorie_fastlane=[408];$(window).resize(function(){if($(this).width()!==width)
{width=$(this).width();width_xs=widthXsSmall();width_sm=widthSmall();width_md=widthMedium();width_lg=widthLarge();}
if(parseInt(self.ctr.data('id_categoria_padre'))!==370)
{if(width_md){$(".feature-slick").find('img').height(66);}else{$(".feature-slick").find('img').height(84);}}});var autoFilledFeature={'Dorso':1};var mmFeature={'Dorso':1};var is_fastlane=($.inArray(self.ctr.get('id_categoria'),categorie_fastlane)>-1);if(self.ctr.data('note').match("<QTA>(.*)<\/QTA>"))
{var match=self.ctr.data('note').match("<QTA>(.*)<\/QTA>");limite_qta_visibili=Math.abs(parseInt(match[1]));}
var limit_qta=!is_fastlane&&!self.ctr.data('qta_libera')&&(count(self.ctr.feature(self.ctr.data('caratteristica_qta'))["opzioni"])>limite_qta_visibili);var conf_gallery={dots:false,autoplay:false,infinite:false,slidesToShow:5,slidesToScroll:5,responsive:[{breakpoint:992,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:1}}]};if(width_xs)
{numero_priorita_visibili=2;}
else
{numero_priorita_visibili=4;}
this.init=function(){self.initKeepAliveCache();self.loadTemplates();self.initConversionFeatures();self.initFeatures();self.initOpzAggiuntive();self.initTaxRate();self.ctr.data('showMsgInfo',false);self.ctr.data('continue_configuratore',0);if(isDefined(self.ctr.data)){if(is_fastlane)
{self.$('.loading_element .prev_title').eq(0).html($('.loading_element .prev_title').eq(0).data('fastlane'));}
self.initAddToCart();self.initTemplate();self.initConfigurator();self.initZipcodeVerification();self.initPromocodeVerification();self.showPrev();bindShowClick($('a',self.$('.nome_lavorazione')));self.ctr.data('priorityClick',false);self.initShowPriceGrid();self.updatePriorityTimes();self.$(".go_to_grid").click(function(){if(!self.ctr.isValid()||$(this).hasClass('disabled')){_kmq=_kmq||[];_kmq.push(['record','clicked on "fai preventivo"']);$.Tc_TrackEvent($(this),'ga_event',{'type':'Fai preventivo','action':'right-btn','label':self.ctr.data('nome')});$('html, body').animate({    scrollTop:$('label.text-danger').offset().top-100},1000);}
else{$('html, body').animate({    scrollTop:$('#price_grid').offset().top-200},1000);}});}};toggleGrid=function(toggle){switch(toggle){case"hide":self.$("#fixed_recap_bar").hide();break;case"show":self.$("#fixed_recap_bar").show();break;}};this.showPrev=function(){self.$('.loading_element').css({visibility:'visible'});self.$('#price_grid').css({visibility:'visible'});self.$("#riepilogo_scroll .recap_right").affix({offset:{top:$(".banner_prod_container").offset().top+$(".banner_prod_container").height(),bottom:function(){return $('body, html').height()-$('#verifica_promocode_box').offset().top;        }}});self.$('#prev_loader').hide();};Tour=function(){var step_intro=[];var step=self.ctr.data('step');var feature_type=[];var featuresName=self.ctr.getFeaturesName();for(var f in featuresName){var feature=self.ctr.feature(featuresName[f]);if((feature.data('hidden')==='0'&&feature.data('interno')==='0')&&feature.nome!==self.ctr.data('caratteristica_qta')&&!isDefined(feature_type[feature.data('tipo_car')])&&(self.ctr.data('step')!==null&&isDefined(self.ctr.data('step')['feature-'+feature.data('tipo_car')]))&&(count(viewedStep)===0||count(viewedStep)>0&&!isDefined(viewedStep["feature-"+feature.data('tipo_car')])))
{feature_type[feature.data('tipo_car')]=1;step_intro.push({element:self.$('#ui-'+feature.id_rel)[0],intro:self.ctr.data('step')['feature-'+feature.data('tipo_car')]['diz'],type_step:'feature-'+feature.data('tipo_car')});}}
for(var i in step)
{if(i.indexOf("feature-")===-1)
{if(self.$('#'+i).is(':visible')&&(count(viewedStep)===0||count(viewedStep)>0&&!isDefined(viewedStep[i])))
{var step_to_push={element:self.$('#'+i)[0],intro:step[i]["diz"],position:step[i]["position"],type_step:i};if(step[i]["insert"]==="unshift")
{step_intro.unshift(step_to_push);}
else
{step_intro.push(step_to_push);}}}}
step_intro.unshift({intro:self.ctr.data('primo_step_intro')});if(count(step_intro)>1&&!$.cookie('NOintroStep'))
{intro.setOptions({steps:step_intro,showStepNumbers:false,skipLabel:"abbandona",exitOnEsc:false,exitOnOverlayClick:false});intro.start();}
intro.onexit(function(){$.cookie('NOintroStep',1,{path:"/",expires:5});}).oncomplete(function(){$.extend(viewedStep,viewStep);$.cookie('introStep',JSON.stringify(viewedStep),{path:"/",expires:60});}).onbeforechange(function(){var introItems=intro._introItems;var previousItem=intro._currentStep;if(isDefined(introItems[previousItem]["type_step"]))
{viewStep[introItems[previousItem]["type_step"]]=1;}}).onafterchange(function(){if($('.introjs-nextbutton').hasClass('introjs-disabled'))
{$('.introjs-skipbutton').addClass('introjs-done');}
else
{$('.introjs-skipbutton').removeClass('introjs-done');}});};this.initKeepAliveCache=function(){var self=this;if(isDefined(self.ctr.data('verify'))){var verify=self.ctr.data('verify');if(isDefined(verify['cacheId'])){var keepAliveCacheTimeout=setInterval(function(){$.phpIsAliveCache({id_prodotto:self.ctr.id,cacheId:verify['cacheId']},function(data){if(data['isAlive']=='reload'){clearTimeout(keepAliveCacheTimeout);showAlert(msgSessioneScaduta,function(){window.location.reload();});}});},self.ctr.data('cacheTimeout')*1000);}}};this.loadTemplates=function(){for(var i in self.templates){var selector=self.templates[i];self.templates[i]=$(selector)[0].outerHTML;$(selector).remove();}};this.initTaxRate=function(){if(self.ctr.data('aliquota')>0&&parseInt(self.ctr.data('preventivo_con_iva'))===0){self.$('.iva_toggler').removeClass('hide');}
else
{self.$('.iva_toggler').addClass('hide');self.$('.row_qta_head').removeClass('col-sm-8');}};this.initFeatures=function(){var featuresName=self.ctr.getFeaturesName();for(var f in featuresName){var feature=self.ctr.feature(featuresName[f]);if(feature.data('interno')!=='1'){switch(feature['tipo']){case'select':if(feature.data('label')!=='quantita')
{if(is_fastlane)
{self.initFastLane(feature);}
else
{self.initSelect(feature);}}
else
{self.initQty(feature);}
break;case'grid':case'gallery':if(is_fastlane)
{self.initFastLane(feature);}
else
{self.initGallery(feature);}
break;case'input':if(feature.data('label')!=='quantita')
{if(is_fastlane)
{self.initFastLane(feature);}
else
{self.initInput(feature);}}
else
{self.initInputQty(feature);}
break;default:}}else{}}
if(is_fastlane)
{$('<div class="clearfix"></div>').appendTo('#features');}};this.initSelect=function(feature){var name=feature['nome'];var options=self.ctr.getOptionsList(name);if(count(options)>0){var select=$(self.templates['select']).prop('id','ui-'+feature.id_rel);var info='<span class="pull-right"><a class="info" href="javascript:void(0)"><i class="fa fa-info-circle"></i></a></span>';$('label',select).html(feature.data('nome'));$('.info-icon',select).html(info);var innerSelect=$('select',select).prop('id',feature.id_rel);var groups={};var prev_opt_group="";bindShowClick($('a',select));for(var o in options){var target=innerSelect;if(options[o]['opt_group']!==prev_opt_group){if(isUndefined(groups[options[o]['opt_group']])&&options[o]['opt_group']!==''){var label_opt=self.ctr.data('caratteristiche')['c'+feature.id].opzioni;var txt_opt_group="";for(var l in label_opt){if(label_opt[l]["id_rel"]===feature.opt_group[options[o]['opt_group']]["id_rel"])
{txt_opt_group=label_opt[l]["optgroup"];}}
groups[options[o]['opt_group']]=$('<optgroup label="'+txt_opt_group+'" id="'+feature.opt_group[options[o]['opt_group']]["id_rel"]+'" />');self.addToCache(feature.opt_group[options[o]['opt_group']]["id_rel"],groups[options[o]['opt_group']]);target.append(groups[options[o]['opt_group']]);}
prev_opt_group=options[o]['opt_group'];}
if(prev_opt_group!==''){target=groups[prev_opt_group];}
var valore=getOptionName(options[o]);if(self.ctr.data('user_test')&&parseInt(options[o].data('testing'))===1)
{valore+=" - TESTING";}
if(valore&&valore.match("\[span=(.+)\](.+)\[/span\]"))
{valore=valore.replace('[span=',"<span style='").replace(']',"'>").replace('[/span]','</span>');}
target.append('<option value="'+options[o].data('name')+'" id="'+options[o]["id_rel"]+'">'+valore+'</option>');}
innerSelect.change(function(){self.closeGallery();self.ctr.change(name,$(this).val());});self.$('#features').append(select);if(self.ctr.data('user_test')&&parseInt(feature.data('testing'))===1)
{self.$('.panel-heading','#ui-'+feature.id_rel).addClass('feature-testing');}
if(feature.data('hidden')==='1')
{self.$('#ui-'+feature.id_rel).addClass('hide');}}};this.initQty=function(feature){var name=feature['nome'],options=self.ctr.getOptionsList(name);if(feature.data('hidden')==='1')
{self.$('#ui-'+feature.id_rel).addClass('hide');}
initGridPrice(feature,options,0);};this.initShowPriceGrid=function(){$(".btn-spec").click(function(){if($(this).find('.cart_prev_consegna_number').size()>0){$(".top_data_spedizione.selected .box_data").removeClass("flash_gray");setTimeout(function(){$(".top_data_spedizione.selected .box_data").addClass("flash_gray");},1);}else if($(this).find('.cart_qta_prodotto').size()>0){$(".quantity.selected").removeClass("flash_gray");setTimeout(function(){$(".quantity.selected").addClass("flash_gray");},1);}else if($(this).find('.cart_prev_netto').size()>0){$(".dettaglio_quantita.selected .prezzi").removeClass("flash_gray");setTimeout(function(){$(".dettaglio_quantita.selected .prezzi ").addClass("flash_gray");},1);}});};this.initPromocodeVerification=function(){if(self.ctr.promocode)
{var promocodes=self.ctr.promocode;var promocode_box_msg_valore_loss=false;var promocode_types=new Array();promocode_types['with_code']=0;promocode_types['no_code']=0;for(var p in promocodes){if(promocodes[p]['codice_richiesto']==1){promocode_types['with_code']++;}else{promocode_types['no_code']++;}
if(promocodes[p]['sconto_tipo']=='valore'){promocode_box_msg_valore_loss=true;}}
if(promocode_types['with_code']>0){if(promocode_box_msg_valore_loss){self.$("#promocode_box_msg_valore_loss").removeClass('hide');}
if(promocode_types['no_code']>0){self.$("#promocode_box_msg_substitution").removeClass('hide');}}
self.ctr.log(_FUNCTION,"initPromocodeVerification");self.$('#promocode').on('keypress',function(e){if(e.keyCode===13||e.which===13){self.$('#verifica_promocode').click();}});bindShowClick($('a',self.$('#verifica_promocode_box')));self.$('#verifica_promocode').on('click',function(){if(!self.$(this).prop('disabled'))
{if(self.ctr.data('logged')===false)
{var params={html_out:self.ctr.data('promo-msg-login'),title:'&nbsp;',do_quote:0,show_action:false,show_login:true,txt_close:'OK'};self.openModal(params);}
else
{self.ctr.connector.getPromocodeVerification(function(data){if(data)
{var params={html_out:data.msg,title:data.res==0?'<i class="fa fa-ban text-info"></i>':'<i class="fa fa-tags text-info"></i>',do_quote:0,show_action:false,result_promocode:data.res,show_login:false,txt_close:'OK'};self.openModal(params);if(data.res>=1)
{if(data.id_promocode!==''&&data.id_promocode!==null&&data.id_promocode!=='null')
{self.ctr.set('id_promocode',data.id_promocode);}
if(data.promocode.length!==0)
{self.ctr.setPromocode(data);}
self.ctr.doQuote();if(data.res===2){}}}});}}});}};this.initOpzAggiuntive=function(){if(self.ctr.data('verifica_prestampa')>0){self.initPrepressCheck();}
if(parseInt(self.ctr.data('assicurazione'))===1&&parseInt(self.ctr.get('id_fornitore'))===0){self.$('#assicurazione').removeClass('hide');self.initInsurance();}};this.initPrepressCheck=function(){self.$("#check_prestampa").bootstrapSwitch({size:'small',state:(self.ctr.get('verifica_prestampa')==='Da verificare'?true:false),onText:diz_attiva,offText:diz_not_attiva,onSwitchChange:function(event,state){if(self.ctr.isValid())
{var verifica='Non verificare';if(state)
{verifica='Da verificare';}
self.ctr.set('verifica_prestampa',verifica);self.refresh();}}});bindShowClick($('a',self.$('#verifica_prestampa')));};this.initInsurance=function(){self.$("#check_assicurazione").bootstrapSwitch({size:'small',state:(self.ctr.get('assicurazione')==='1'?true:false),onText:diz_attiva,offText:diz_not_attiva,onSwitchChange:function(event,state){if(self.ctr.isValid())
{var assicurazione_check=0;if(state)
{assicurazione_check=1;}
self.ctr.set('assicurazione',assicurazione_check);self.refresh();}}});bindShowClick($('a',self.$('#assicurazione')));};this.initTemplate=function(){var template_available=false;if(self.ctr.getFeatureIs({'and':{'template_dinamico':['1']}},'boolean')){template_available=true;}else if(self.$('.download_template').size()===1&&self.$('.download_template').hasClass('zip')){template_available=true;this.ctr.data('fixed_zip_template',true);}
if(template_available&&self.ctr.isValid()){self.ctr.data('template_downloadable',1);}else{self.ctr.data('template_downloadable',0);}
if(!template_available)
{self.$('.download_template').addClass('hide');self.$('#alert_template').addClass('hide');}
else
{self.$('.download_template').removeClass('hide');}
if(!self.ctr.data('template_downloadable'))
{if(!self.$('.download_template').hasClass('hide'))
{self.$('#alert_template').html(testo_template_non_disp).removeClass('hide');}
self.$('.download_template').addClass('disabled');}};this.initConfigurator=function(){self.ctr.log(_FUNCTION,"initConfigurator");var configuratorDiv=self.$('#configura_btn');self.$('#domid').val(Math.round((new Date().getTime())/1000));self.$('#session_id').val(self.ctr.data('session_id'));self.$('#num_lav').val(self.ctr.get('lavorazione_orig'));if(this.ctr.data('configurabile')!=='1')
{var configuratorFeature=self.ctr.getFeatureIs({'and':{'configurabile':['1','2']}},'object');if(configuratorFeature!==false)
{if(configuratorFeature.data('configurabile')==='1')
{self.updateConfigurator(configuratorFeature);}
else if(configuratorFeature.data('configurabile')==='2')
{configuratorDiv=self.$('#edocbuilder_btn');if(self.$('#iframe_src_edocbuilder').data('path')===null)
{self.$('#iframe_src_edocbuilder').data('path',self.$('#iframe_src_edocbuilder').val());}}}}
configuratorDiv.click(function(){if(self.ctr.data('configurabile')===1)
{self.$('#loader-conf').removeClass('hide');self.$('#conf_preview').hide();self.$('.row_title_configuratore .prev_title').html(self.$('.row_title_configuratore .prev_title').data('personalizza'));self.$('#delete_configuratore').addClass('hide');self.$('.modifica_grafica').addClass('hide');self.$('.crea_grafica').removeClass('hide');var configuratorSrc=self.ctr.data('configuratorSrc');if(browser_info['comp_conf']===0)
{var params={html_out:msgBrowserConfiguratore,title:'<div class="modal_icon warning"><span class="body"></span><span class="dot"></span></div>',do_quote:0,show_action:false,show_close:true,show_cart:false,icon_type:"warning"};self.openModal(params);}
else
{$(this).addClass('disabled');self.$('.info_features','#cnt_iframe_conf').html('<iframe frameborder="0" scrolling="no" width="100%" src="'+configuratorSrc+'" id="iframe_conf" name="iframe_conf"></iframe>');}}});self.$('#delete_configuratore').click(function(){self.$('#domid').val('');self.ctr.set('parametri_configuratore','');var configuratorFeature=self.ctr.getFeatureIs({'and':{'configurabile':['1','2']}},'object');self.updateConfigurator(configuratorFeature);self.$('#menu_prodotto_configuratore').hide();self.$('#conf_preview').hide();$(this).addClass('hide');});};this.initFastLane=function(feature){var name=feature['nome'];var options=self.ctr.getOptionsList(name);if(count(options)>0&&parseInt(feature.data('hidden'))===0){var ui=$(self.templates['fastlane']).prop('id','ui-'+feature.id_rel);for(var o in options){var img="/img/opzione/select/"+options[o]["id"]+"_"+feature.id+"_"+self.ctr.id+"_opt_sel.png";}
$('.img',ui).html('<img class="img-responsive" src="'+img+'" title="" alt="" />');$('.description',ui).html('<h5>'+feature.data('nome')+"</h5>"+infoMessage(feature['nome']));self.$('#features').append(ui);}};this.initGallery=function(feature){var name=feature['nome'];var options=self.ctr.getOptionsList(name);if(count(options)>0){var ui=$(self.templates['gallery']).prop('id','ui-'+feature.id_rel);self.$('#features').append(ui);var galleryId='#ui-'+feature.id_rel;self.$('label',galleryId).html(feature.data('nome'));bindShowClick(self.$('a',galleryId));var carousel=$('.feature-slick',galleryId).prop('id',feature.id_rel);var index=0;for(var o in options){var img="https://images.pixartprinting.net/"+self.ctr.data("images_data")["img"]+"/img/opzione/gallery/images/"+options[o]["id"]+"_"+feature.id+"_"+self.ctr.id+"_opt.jpg";var class_item='';if(index===0)
{class_item=' active';}
options[o]["carousel_index"]=index;index++;var valore=getOptionName(options[o]);if(self.ctr.data('user_test')&&parseInt(options[o].data('testing'))===1)
{valore+=" - TESTING";}
carousel.append('<div class="item col-xs-6 col-sm-3 col-md-1-5th'+class_item+'" id="'+options[o]["id_rel"]+'"><div class="opt text-center"><img src="'+img+'" class="img-responsive" /></div><div class="top-5 text-center text">'+valore+'</div></div>');}}
if(feature['tipo']!="grid"||width_xs||width_sm){self.$('#'+feature.id_rel,galleryId).slick(conf_gallery);}else{self.$('#'+feature.id_rel,galleryId).addClass("grid");}
self.$('#'+feature.id_rel,galleryId).on('reInit',function(){var slick=$(this).slick('getSlick');var slick_to_show=slick.options.slidesToShow;var slick_count=slick.slideCount;if(slick_count>slick_to_show)
{self.$('.open_gallery','#ui-'+feature.id_rel).removeClass('hide');}
else
{self.$('.open_gallery','#ui-'+feature.id_rel).addClass('hide');}});self.$('.item','#'+feature.id_rel).click(function(){if(!self.$('#'+feature.id_rel).hasClass('slick-initialized')){var barra;if(width_sm)
{barra=95;}
else
{barra=101;}
var posizione=self.$('#'+feature.id_rel).offset().top-barra;$('html, body').animate({    scrollTop:posizione},1000);}
self.$('.item',feature.id_rel).removeClass('active');$(this).addClass('active');self.$('.open_gallery','#ui-'+feature.id_rel).find('.fa').prop('class','fa fa-eye');var id_rel=parseInt($(this).prop('id'));self.$('#'+feature.id_rel).removeData('slick_removed');feature["clicked"]=true;self.ctr.change(feature['nome'],self.ctr.id_rels[id_rel]['nome']);});self.$('.open_gallery','#ui-'+feature.id_rel).click(function(){if(isUndefined(self.$('#'+feature.id_rel).data('slick_removed')))
{$(this).find('.fa').removeClass('fa-eye').addClass('fa-eye-slash');self.$('#'+feature.id_rel).slick('slickUnfilter');self.$('#'+feature.id_rel).slick('unslick');self.$('#'+feature.id_rel).data('slick_removed',true);}
else
{$(this).find('.fa').removeClass('fa-eye-slash').addClass('fa-eye');self.$('#'+feature.id_rel).removeData('slick_removed');self.$('#'+feature.id_rel).slick(conf_gallery);self.$('#'+feature.id_rel).slick('slickFilter',':not(.hide)');self.$('#'+feature.id_rel).slick('slickGoTo',feature.data('goTo'),true);}
equalHeight($('#'+feature.id_rel+' .item'));});if(feature.data('hidden')==='1')
{self.$('#ui-'+feature.id_rel).addClass('hide');}
if(self.ctr.data('user_test')&&parseInt(feature.data('testing'))===1)
{self.$('.panel-heading','#ui-'+feature.id_rel).addClass('feature-testing');}};this.initInput=function(feature){var name=feature['nome'];var input=$(self.templates['input']).prop('id','ui-'+feature.id_rel);var info='<span class="pull-right"><a class="info" href="javascript:void(0)"><i class="fa fa-info-circle"></i></a></span>';$('label',input).html(feature.data('nome'));$('.info-icon',input).html(info);var innerInput=$('input',input).prop('id',feature.id_rel);var maxlenght=feature.data('maxlength');if(!feature.data('label')&&feature.data('tipo')!='TEXT')
{maxlenght=4;}
innerInput.prop('maxlength',maxlenght);if(!isDefined(autoFilledFeature[feature.nome]))
{innerInput.removeAttr("disabled");}
bindShowClick($('a',input));innerInput.change(function(){self.closeGallery();self.ctr.change(name,$(this).val());});self.$('#features').append(input);self.initConversion(feature);if(feature.data('hidden')==='1')
{self.$('#ui-'+feature.id_rel).addClass('hide');}};this.initConversionFeatures=function(){var self=this;if(count(self.ctr.data('unita_misura'))>0){self.conversionLabels={'base':1,'altezza':'1'};self.conversionFeatures={'Dorso':1,'Formato':1};self.ctr.eachFeature(function(feature){if(self.conversionLabels[feature.data('label')]=='1'||self.conversionFeatures[feature["nome"]]=='1'){var unita_misura=self.ctr.data('unita_misura');if(self.conversionClass==null){self.conversionClass=new ConversionClass(unita_misura);self.conversionClass.init();}
for(var i in unita_misura){if(typeof(self.conversionData[feature.data('name')+"_"+unita_misura[i]['nome']])!='object'){self.conversionData[feature.data('name')+"_"+unita_misura[i]['nome']]={};}
self.conversionData[feature.data('name')+"_"+unita_misura[i]['nome']]['feature']=feature.data('name');self.conversionData[feature.data('name')+"_"+unita_misura[i]['nome']]['precision']=unita_misura[i]['precisione'];self.conversionData[feature.data('name')+"_"+unita_misura[i]['nome']]['id']=unita_misura[i]['id'];}
if(count(self.conversionData)>0&&typeof(self.conversionFunction)!='function'){self.conversionFunction=function(elem){var id=elem.attr('id');var value=elem.val();var precisione=self.conversionData[id]['precision'];if(precisione<0){precisione=0;}
var feature=self.ctr.feature(self.conversionData[id]['feature']);var dimensions={1:0};for(var i in self.conversionData){var udm=self.conversionData[i];if(udm['feature']==self.conversionData[id]['feature']){var i_value=$('#'+i).val();if(i_value>0){dimensions[self.conversionData[i]['id']]=i_value;}}}
if(count(dimensions)>0){var conv_to_cm=self.conversionClass.mUnitTocm(dimensions);self.$('#'+feature['id_rel']).val(conv_to_cm);$('#'+feature['id_rel']).change();self.refreshConversionInput(conv_to_cm,feature['nome']);}};}}});}};this.initConversion=function(feature){if(self.hasConversion(feature)){var domFeature=$('#'+feature['id_rel']);var unita_misura=self.ctr.data('unita_misura');var dom='';var ids=[];for(var i in unita_misura){var um_dom='<div class="col-xs-6 form-group no_padding container'+unita_misura[i]['nome']+'">';um_dom+='<input';um_dom+=' id="'+feature.data('name')+'_'+unita_misura[i]['nome']+'"';um_dom+=' class="form-control"';if(isDefined(autoFilledFeature[feature.data('name')]))
{um_dom+=' disabled="disabled"';}
um_dom+=' name="'+feature.data('name')+'_'+unita_misura[i]['nome']+'"';um_dom+=' onblur="#ku#" value="" maxlength="8"';ids.push(feature.data('name')+'_'+unita_misura[i]['nome']);um_dom+='/>';um_dom+='<label for="'+feature.data('name')+'_'+unita_misura[i]['nome']+'">';um_dom+=unita_misura[i]['simbolo'];um_dom+='</label>';um_dom+='</div>';dom=um_dom+dom;}
dom='<div class="udm_caratteristica form-inline">'+dom+'</div>';dom=dom.replace(/#ku#/g,"p.view.conversionFunction($(this));");domFeature.before(dom);for(var i in ids)
{self.$('#'+ids[i]).keyup(function(e){var old_string=$(this).val();var new_string=checkCharInput(old_string,false);if(e.keyCode!==37&&e.keyCode!==39){if(new_string==="")
{new_string=0;}
if(old_string!=='')
{$(this).val(new_string);}}});}
domFeature.addClass('hide');}};this.hasConversion=function(feature){if((isDefined(this.conversionLabels[feature.data('label')])||isDefined(this.conversionFeatures[feature["nome"]]))&&count(this.ctr.data('unita_misura'))>0){return true;}
return false;};this.reInitPriorities=function(){self.$('#fixed_recap_bar, .griglia_prezzi').append('<div class="opacity layer"></div>');self.ctr.cacheId="";var old_priority=self.ctr.get('id_priorita');var old_consegna=self.ctr.summary()["deliveryDate"];self.ctr.connector.getProductData(function(data){if(data){self.ctr.data('priorita',data['priorita']);self.ctr.data('priorita_sort',data['priorita_sort']);var verify=data['verify'];if(isDefined(verify)&&isDefined(verify['cacheId'])&&verify['cacheId']!=''){var new_verify=self.ctr.data('verify');new_verify['cacheId']=data['verify']['cacheId'];self.ctr.data('verify',new_verify);}
self.ctr.cleanShippingPriorities();var qtyFeature=self.ctr.data('caratteristica_qta');var feature=self.ctr.feature(qtyFeature);switch(feature['tipo']){case'select':self.initQty(feature);break;case'input':feature.data('noAppendQty',true);self.initInputQty(feature);break;}
self.ctr.changePriority(old_priority);self.updateSummary();self.$('#fixed_recap_bar, .griglia_prezzi').find('.opacity.layer').remove();self.$('#label_cap').find('.fa').remove();self.$('.cap_destinazione','#label_cap').removeClass('hide');self.$('.inserisci_cap','#label_cap').addClass('hide');self.$('#label_cap').prepend('<i class="fa fa-check text-success"></i>');self.$('#verify_zipcode').removeClass('btn-success-custom').addClass('btn-info-custom').html(self.$('#verify_zipcode').data('sostituisci'));if(self.ctr.summary()["deliveryDate"]!==old_consegna)
{$.Tc_TrackEvent($(this),'ga_event',{'type':'Verifica CAP','action':'Griglia aggiornata con CAP','label':self.ctr.data('nome')});}}});};this.initZipcodeVerification=function(){self.$('#zipcode').on('keypress',function(e){if(e.keyCode===13||e.which===13){self.$('#verify_zipcode').click();}});self.$('#verify_zipcode').click(function(){if(self.$('#zipcode').hasClass('hide'))
{self.$('#zipcode').removeClass('hide');self.$('#span_cap').addClass('hide');self.$('.cap_destinazione','#label_cap').addClass('hide');self.$('.inserisci_cap','#label_cap').removeClass('hide');$(this).html($(this).data('verifica'));}
else
{$.Tc_TrackEvent($(this),'ga_event',{'type':'Verifica CAP','action':'click Verifica CAP','label':self.ctr.data('nome')});self.ctr.connector.setZipcode(function(r){self.reInitPriorities();});}});};this.initInputQty=function(feature){var input=$(self.templates['input']).prop('id','ui-'+feature.id_rel);$('label',input).html(feature.data('nome'));var info='<span class="pull-right"><a class="info" href="javascript:void(0)"><i class="fa fa-info-circle"></i></a></span>';$('.info-icon',input).html(info);var innerInput=$('input',input).prop('id',feature.id_rel);innerInput.addClass('qta_libera');innerInput.prop('maxlength',6);innerInput.removeAttr("disabled");if(!isDefined(feature.data('noAppendQty')))
{bindShowClick($('a',input));innerInput.keyup(function(e){var old_string=$(this).val();var new_string=checkCharInput(old_string,true);if(e.keyCode!==37&&e.keyCode!==39){if(new_string==="")
{new_string=0;}
if(old_string!=='')
{$(this).val(new_string);}
self.ctr.change(feature['nome'],new_string);}}).change(function(){return false;}).blur(function(){self.closeGallery();$(this).keyup();});self.$('#features').append(input);}
else
{feature.removeData('noAppendQty');}
if(feature.data('hidden')==='1')
{self.$('#ui-'+feature.id_rel).addClass('hide');}
var options={1:{'id_rel':'000'+feature.id_rel,'incompatibile':false,'nome':1,'non_disponibile':false,'changed':false}};initGridPrice(feature,options,1);};initGridPrice=function(feature,options,input){var priorities=self.ctr.data('priorita'),priorities_sort=self.ctr.data('priorita_sort'),show_prev=count(priorities_sort)>2,n_options=0;self.$(".qta_plus").click(function(){$('.grid_scroll').animate({scrollLeft:$('.grid_scroll').scrollLeft()+$(".top_data_spedizione.selected").width()+8},500,function(){var quantita=($(".top_data_spedizione.selected").width()+4)*$(".top_data_spedizione:visible").size();var spostamento=$('.grid_scroll').scrollLeft();var larghezza=$('.grid_scroll').width();if($('.grid_scroll').scrollLeft()>0)
{self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');self.$('.qta_start').removeClass('hide');self.$('.qta_minus').removeClass('hide');}
if(quantita-spostamento-larghezza<=4)
{self.$('.qta_end').addClass('hide');self.$('.qta_plus').addClass('hide');}});});self.$(".qta_minus").click(function(){$('.grid_scroll').animate({scrollLeft:$('.grid_scroll').scrollLeft()-$(".top_data_spedizione.selected").width()-8},500,function(){self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');if($('.grid_scroll').scrollLeft()===0)
{self.$('.qta_start').addClass('hide');self.$('.qta_minus').addClass('hide');self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');}});});self.$(".qta_start").click(function(){$('.grid_scroll').animate({scrollLeft:0},500,function(){self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');self.$('.qta_start').addClass('hide');self.$('.qta_minus').addClass('hide');});});self.$(".qta_end").click(function(){$('.grid_scroll').animate({scrollLeft:($(".top_data_spedizione.selected").width()+4)*$(".top_data_spedizione:visible").size()},500,function(){self.$('.qta_end').addClass('hide');self.$('.qta_plus').addClass('hide');self.$('.qta_start').removeClass('hide');self.$('.qta_minus').removeClass('hide');});});var lastScrollLeft=0;self.$('.grid_scroll').scroll(function(){var documentScrollLeft=$(this).scrollLeft();if(lastScrollLeft!==documentScrollLeft){lastScrollLeft=documentScrollLeft;var quantita=($(".top_data_spedizione.selected").width()+4)*$(".top_data_spedizione:visible").size();var larghezza=$(this).width();self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');self.$('.qta_start').removeClass('hide');self.$('.qta_minus').removeClass('hide');if(lastScrollLeft===0)
{self.$('.qta_start').addClass('hide');self.$('.qta_minus').addClass('hide');self.$('.qta_end').removeClass('hide');self.$('.qta_plus').removeClass('hide');}
if(quantita-lastScrollLeft-larghezza<=2)
{self.$('.qta_end').addClass('hide');self.$('.qta_plus').addClass('hide');}}
if(numero_priorita<numero_priorita_visibili){self.$('.qta_start, .qta_end, .qta_minus, .qta_plus').addClass('hide');}});if(parseInt(self.ctr.data('preventivo_con_iva'))===0)
{self.$('.btn-group .btn').click(function(){showPriceVat($(this).data('ivato'),options);});}
else
{self.$('.btn-group').addClass('hide');}
var date_column="col-sm-3 col-xs-6 col-xs-offset-0";var column_xs=" col-xs-6";var class_column=Math.ceil(12/count(priorities_sort));for(var p in priorities_sort){switch(count(priorities_sort)){case 1:date_column="col-sm-4 col-sm-offset-4 col-xs-12 col-xs-offset-0";column_xs=" col-xs-12";break;case 2:if(p==0){date_column="col-sm-4 col-sm-offset-1";}else{date_column="col-sm-4 col-sm-offset-2";}
date_column+=" col-xs-6 col-xs-offset-0";break;case 3:date_column="col-sm-4 col-xs-6 col-xs-offset-0";break;}
var date_sm=$(self.templates['dataSpedizione']),arrow=$(self.templates['Arrow']),id_priorita=priorities_sort[p];ds=priorities[id_priorita]['data_consegna'].split('-'),d=new Date(ds[0],(parseInt(ds[1],10)-1),ds[2]);if(self.$('P'+id_priorita).size()===0)
{date_sm.prop('id','p_'+id_priorita).addClass(date_column);arrow.addClass(date_column);self.bindPriorityClick(date_sm,feature,id_priorita);self.addToCache('P'+id_priorita,date_sm);self.addToCache('Arrow'+id_priorita,arrow);if(parseInt(self.ctr.data('preventivo_con_iva'))!==0)
{self.$('P'+id_priorita).addClass('con_iva');}
$('.giorno_spedizione',date_sm).html(giorni_long[d.getDay()]);$('.numero_spedizione',date_sm).html(d.getDate());$('.mese_spedizione',date_sm).html(mesi_long[d.getMonth()]);date_sm.click(function(){return false;});self.$('.delivery_dates').append(date_sm);self.$('.row_promo').append(arrow);}
else
{$('.giorno_spedizione',self.$('P'+id_priorita)).html(giorni_long[d.getDay()]);$('.numero_spedizione',self.$('P'+id_priorita)).html(d.getDate());$('.mese_spedizione',self.$('P'+id_priorita)).html(mesi_long[d.getMonth()]);}
n_options++;}
n_options=0;for(var o in options){var rowQuantity=$(self.templates['rowQuantity']),Quantity=$(self.templates['Quantity']),id_rel=options[o].id_rel;if(self.$(id_rel).size()===0)
{self.bindQtyOptionClick(Quantity,feature,options[o]);self.addToCache(id_rel,rowQuantity);self.addToCache('Q'+id_rel,Quantity);var qta_out="0";if(!input)
{var qta_out=options[o].data('name');if(self.ctr.data('locale')==="en_US")
{qta_out=formatNumberLocale(qta_out);}}
self.$('.right_quantity').append(Quantity);Quantity.html(qta_out);priceGrid[options[o]['nome']]={};for(var ps in priorities_sort){var p=priorities_sort[ps];priceGrid[options[o]['nome']][p]={};var priceCell=$(self.templates['prezzo']);self.addToCache(id_rel+'_'+p,priceCell);self.bindQtyPriorityClick(priceCell,feature,options[o],p);priceCell.addClass('col-sm-'+class_column+column_xs);rowQuantity.append(priceCell);var priceCell_sm=priceCell.find('.netto');var priceCellGross_sm=priceCell.find('.ivato');if(parseInt(self.ctr.data('preventivo_con_iva'))===0)
{priceCell.find('.colonna-ivato').addClass('hide');}
self.addToCache(id_rel+'_sm_'+p,priceCell_sm);self.addToCache(id_rel+'_sm_gross_'+p,priceCellGross_sm);priceGrid[options[o]['nome']][p]["sm"]=priceCell_sm;priceGrid[options[o]['nome']][p]["gross_sm"]=priceCellGross_sm;}
self.$('.row_qta_container').append(rowQuantity);if(parseInt(self.ctr.data('preventivo_con_iva'))!==0)
{self.$('.dettaglio_quantita',id_rel).addClass('con_iva');self.$('Q'+id_rel).addClass('con_iva');}}
n_options++;}
self.$('button','.more_button').click(function(){self.$('.collapsed_grid').css({overflow:'hidden',height:'auto'});self.$('.more_button').addClass('hide');});if(is_fastlane)
{self.$('.recap_toggler').addClass('hide');if(!width_xs)
{self.$('#price_grid').addClass('hide');self.$('.inner_price_grid .prev_title').addClass('hide');}}};this.initAddToCart=function(){this.$('.add_carrello').click(function(event){if(!self.ctr.isValid()||$(this).hasClass('disabled')){_kmq=_kmq||[];_kmq.push(['record','clicked on "fai preventivo"']);$.Tc_TrackEvent($(this),'ga_event',{'type':'Fai preventivo','action':$(this).data('position'),'label':self.ctr.data('nome')});posizionaPagina('#ui-'+firstInvalidFeature);return false;}
self.$('#error_configuratore').addClass('hide');var solo_configurabile=false;var msgInfo="";if(self.ctr.get('parametri_configuratore')==="")
{if(self.ctr.data('solo_configuratore')==='1')
{solo_configurabile=true;}
else
{self.ctr.eachFeature(function(feature){var f=feature['nome'];if(feature.data('solo_configuratore')==='1')
{solo_configurabile=true;}
if(self.ctr.hasOptions(f)&&self.ctr.selected(f).data('solo_configuratore')=='1')
{solo_configurabile=true;}});}}
if(self.ctr.data('configurabile')===1&&!self.$('#cnt_iframe_conf').hasClass('hide')&&self.ctr.data('continue_configuratore')===0)
{if(self.ctr.get('parametri_configuratore')==='')
{self.$('.open','#error_configuratore').removeClass('hide');self.$('.already','#error_configuratore').addClass('hide');}
else
{self.$('.already','#error_configuratore').removeClass('hide');self.$('.open','#error_configuratore').addClass('hide');}
self.$('#error_configuratore').removeClass('hide');posizionaPagina('#error_configuratore');return false;}
else if(isDefined(self.ctr.data('continue_configuratore'))&&self.ctr.data('continue_configuratore')===1)
{self.ctr.data('continue_configuratore',2);self.ctr.set('parametri_configuratore','');}
if(solo_configurabile)
{var html_out='';html_out='<div class="text-left">'+msgSoloConfiguratore+'<div class="top-30 clearfix"><button class="btn btn-info-custom btn-lg col-xs-12" role="button" onclick="$(\'#modal\').modal(\'hide\');$(\'#configura_btn\').click();">'+dialog_config_configuratore+'</button></div></div>';var params={html_out:html_out,title:'<div class="modal_icon warning"><span class="body"></span><span class="dot"></span></div>',do_quote:0,show_action:false,show_close:true,show_cart:false,show_add:false,icon_type:"warning"};self.openModal(params);return false;}
switch(self.ctr.id){case 286:msgInfo=msgFogliMacchina;break;case 194:msgInfo=msgBrossuraGrecata;break;}
if(msgInfo.length>0&&self.ctr.data('showMsgInfo')===false)
{var html_out='';html_out='<div class="text-left">'+msgInfo+'</div>';var params={html_out:html_out,title:'<span class="fa fa-info-circle text-info" aria-hidden="true"></span><h3>Info</h3>',do_quote:0,show_action:false,show_close:true,show_cart:false,show_add:true};self.ctr.data('showMsgInfo',true);self.openModal(params);return false;}
if(self.$('.feature').find('.alert-warning').size()>0&&$(this).data("warning")!==true){var html_out='';html_out='<div class="text-left">'+self.ctr.data('warnings-advice');self.$('.feature').find('.alert-warning').each(function(){html_out+='<div class="top-10">'+$(this).html()+'</div>';});html_out+=self.ctr.data('warnings-advice-continue')+'</div>';var params={html_out:html_out,title:'<div class="modal_icon warning"><span class="body"></span><span class="dot"></span></div>',do_quote:0,show_action:false,show_close:true,show_cart:false,show_add:true,icon_type:"warning"};self.openModal(params);return false;}
self.addToCart($(this));});};self.addToCart=function($el){self.ctr.set('file',self.$('.nome_lavorazione').find('input').val());self.ctr.set('invio','subito');self.ctr.finalize();removePromoFromOptions();if(self.ctr.get('myId')<self.ctr.data('itemLimit')){self.$('.add_carrello').addClass('disabled');var active_promo_id=self.ctr.activePromo();if(active_promo_id!==false){active_promo_id=active_promo_id['id'];if(active_promo_id==="1"&&self.ctr.data('logged')===false){var params={html_out:self.ctr.data('promo-msg'),title:'&nbsp;',do_quote:0,show_action:false,show_login:true,txt_close:'OK'};self.openModal(params);return;}}
self.ctr.add(function(data){self.ctr.doQuote();self.ctr.set('myId',parseInt(self.ctr.get('myId'))+1);self.ctr.set('lavorazione_orig',parseInt(self.ctr.get('myId'))+1);self.ctr.set('num_lav',parseInt(self.ctr.get('myId'))+1);self.ctr.set('assicurazione',0);self.ctr.set('verifica_prestampa','Non verificare');self.$('#check_prestampa').bootstrapSwitch('state',false);self.$('#check_assicurazione').bootstrapSwitch('state',false);var summary=self.ctr.summary();window.optimizely.push(["trackEvent","add_to_cart_responsive"]);var formato='';var configuration=JSON.stringify(self.ctr.getConfiguration(true));if(self.ctr.feature('Formato'))
{formato=self.ctr.selected('Formato').nome;}
else if(self.ctr.feature('Tipo di formato'))
{formato=self.ctr.selected('Tipo di formato').nome;}
$.Tc_TrackEvent($el,"add_to_cart",{'add_product_id':self.ctr.id,'add_product_name':self.ctr.data('nome'),'add_product_unitprice_ati':summary.gross.toFixed(2),'add_product_unitprice_tf':summary.net.toFixed(2),'add_product_quantity':self.ctr.get('_QTA'),'add_product_page':window.location.href,'add_product_num_validates':numValidates,'add_product_configuration':configuration,'add_product_format':formato,'add_product_hxw':self.ctr.get('_B')+'x'+self.ctr.get('_H'),'add_product_currency_conversion':self.ctr.currency['rate']});self.$(".empty-cart-recap").addClass("hide");self.$(".details-recap").removeClass("hide");self.$(".total-recap").removeClass("hide");self.$(".recap_n_prodotti").html(data.num_lav_recap);if(isDefined(data['updates'])&&count(data['updates'])>0){for(var i in data['updates']){self.$('#recap_right_'+i).removeClass('hide');for(var j in data['updates'][i]){self.$('#recap_right_'+j).html(data['updates'][i][j]).removeClass('hide');}}}
self.$(".recap_right_netto").html(data.netto);self.$(".recap_right_iva").html(data.iva);self.$(".recap_right_totale").html(data.totale);self.$(".cart_dropdown_totale .text-right").html(data.netto);$('<li class="cart_dropdown_articolo"><div class="col-xs-12 top-5"><strong>'+data.num_lav+'</strong></div><div class="col-xs-7">'+data.nome_last+'</div><div class="col-xs-5 text-right">'+$(".cart_prev_netto").html()+'</div></li><div class="divider"></div>').insertBefore(".dropdown-cart .cart_dropdown_totale");var param_modal='ok';if(isDefined(data.messaggio))
{param_modal=data.messaggio;}
self.showMessageCart(param_modal);});}else{self.showMessageCart('ko');}};this.bindPriorityClick=function($obj,feature,p){$obj.click(function(){if(self.ctr.isValid())
{if(!self.ctr.data('qta_libera'))
{self.$(self.ctr.selected(feature['nome']).id_rel+'_'+p).click();}
else
{var priority=self.ctr.priceList[1][p];if(self.ctr.get('id_priorita')!==p&&priority["enabled"]){self.ctr.changePriority(p);self.refresh();}}}});};this.bindQtyOptionClick=function($obj,feature,option){$obj.click(function(){if(self.ctr.isValid())
{var price=self.ctr.priceList[option['nome']];var p=self.ctr.get('id_priorita');if(price[p]['enabled']!==false&&!self.ctr.data('qta_libera')){self.ctr.data('priorityClick',true);if(self.ctr.change(feature['nome'],option['nome'],false))
{if(self.ctr.data('priorityClick'))
{self.ctr.data('priorityClick',false);$('.grid_scroll').animate({scrollLeft:$(".top_data_spedizione:visible").width()*($(".top_data_spedizione.selected").index()-1)},500);}}
else
{self.updateSummary();}}
else
{}
return false;}});};this.bindQtyPriorityClick=function(domObj,feature,option,p){domObj.click(function(){if(self.ctr.isValid())
{if(!self.ctr.data('qta_libera'))
{if(!domObj.find('.netto').hasClass('disabled'))
{var refresh=false;var price=self.ctr.priceList[option['nome']];if(price[p]['enabled']!==false){if(self.ctr.change(feature['nome'],option['nome'],false))
{refresh=true;}}
var priority=self.ctr.priceList[self.ctr.name(feature.nome)][p];if(self.ctr.get('id_priorita')!==p&&priority["enabled"]===true){self.ctr.changePriority(p);feature['changed']=true;option['changed']=true;refresh=true;}
if(refresh)
{self.updatePriorityTimes(self.ctr.data('priorita')[self.ctr.get('id_priorita')]);self.refreshQty(feature);self.updateSummary();}}
else
{}}
else
{var priority=self.ctr.priceList[1][p];if(self.ctr.get('id_priorita')!==p&&priority["enabled"]){self.ctr.changePriority(p);self.refresh();}}}});};this.openModal=function(params){if(!params.large)
{self.$('.modal-dialog','#modal').prop('class','modal-dialog '+self.$('#modal').data('modal'));}
else
{self.$('.modal-dialog','#modal').prop('class','modal-dialog '+self.$('#modal').data('needhelp'));}
self.$('.modal-footer','#modal').removeClass('hide');self.$('.modal-body','#modal').html(params.html_out);self.$('.modal-title','#modal').html(params.title);self.$('.modal_action','#modal').removeClass('hide');self.$('.modal_add','#modal').removeClass('hide');self.$('.modal_menu','#modal').removeClass('hide');self.$('.modal_cart','#modal').removeClass('hide');self.$('.modal_close','#modal').removeClass('hide');if(!params.show_action)
{self.$('.modal_action','#modal').addClass('hide');}
if(!params.show_add)
{self.$('.modal_add','#modal').addClass('hide');}
if(!params.show_close)
{self.$('.modal_close','#modal').addClass('hide');}
if(params.show_cart)
{$('.btn-spec','#modal').removeClass('flash');if(!$('.modal_cart','#modal').data('assegnato'))
{$('.modal_cart','#modal').data('position',self.ctr.data('position'));$('.modal_cart','#modal').data('assegnato',true);$('.modal_cart','#modal').click(function(){self.addToCart($(this));$(this).off('click');return false;});}}
else
{self.$('.modal_cart','#modal').addClass('hide');}
self.$('.modal_close','#modal').html(self.$('.modal_close','#modal').data('text'));if(params.txt_close)
{self.$('.modal_close','#modal').html(params.txt_close);}
if(params.txt_action)
{self.$('.modal_action','#modal').html(params.txt_action);}
self.$('#modal').on('hide.bs.modal',function(e){if(self.ctr.data('logged')===true&&parseInt(self.ctr.data('id_categoria'))===319)
{window.location.reload();}});self.$('#modal').on('hidden.bs.modal',function(e){$(".modal_close_txt","#modal").remove();$(".modal_action_txt","#modal").remove();$(this).data('bs.modal',null);self.$('.add_carrello').removeClass('disabled');if(params.do_quote)
{$(this).removeData('params');if(self.ctr.data('configurabile')===1){var num_lav=self.ctr.get('myId')+1;var d=Math.round((new Date().getTime())/1000);var src=$('#iframe_src').data('path');self.$('#num_lav').val(num_lav);self.ctr.set('parametri_configuratore','');self.$('#domid').val(d);self.ctr.set('domidlav',d);src+=self.createConfiguratorUrl(d);self.$('#iframe_src').val(src);self.$('#conf_preview').empty();self.$('#menu_prodotto_configuratore').hide();}
self.$('.modal_cart','#modal').removeData('assegnato');self.ctr.initPromo(function(){self.ctr.doQuote();});}
else
{self.ctr.set('assicurazione',0);self.ctr.set('verifica_prestampa','Non verificare');var prev_price=self.$('.cart_prev_totale').html().substring(2);updateInsurance();self.updateAddToCart();self.updateSummary();if(self.$('.griglia_prezzi').size()>0)
{self.fillPriceGrid();}}
if(params.show_login)
{showLogin();}
if(params.result_promocode===0)
{self.$('#promocode').focus();}});self.$('button.close','#modal').removeClass('hide');self.$('#modal').modal({backdrop:true,keyboard:true});if(params.icon_type=="success"){$('.modal_icon.success').addClass('animate');$('.modal_icon.success').animate({opacity:1.0});$('.modal_icon.success .line.tip').addClass('animateSuccessTip');$('.modal_icon.success .line.long').addClass('animateSuccessLong');}else if(params.icon_type=="error"){$('.modal_icon.error').addClass('animateErrorIcon');$('.modal_icon.error').animate({opacity:1.0});$('.modal_icon.error .x-mark .line').addClass('animateXLines');}else if(params.icon_type=="warning"){$('.modal_icon.warning').addClass('pulseWarning');$('.modal_icon.warning').animate({opacity:1.0});$('.modal_icon.warning .body').addClass('pulseWarningIns');$('.modal_icon.warning .dot').addClass('pulseWarningIns');}};this.getPriceGrid=function(){return priceGrid;};this.updateConfigurator=function(configuratorFeature){var configuratorSrc='';if(isUndefined(configuratorFeature))
{configuratorFeature=self.ctr.getFeatureIs({'and':{'configurabile':['1','2']}},'object');}
self.$('#iframe_conf').empty();self.$('#conf_preview').empty();self.$('#cnt_iframe_conf').addClass('hide');self.$('#configura_btn').removeClass('disabled');if(isDefined(configuratorFeature)&&configuratorFeature!=false){self.ctr.data('configurabile',1);self.$('#id_opzione').val(configuratorFeature.data('id'));self.$('#id_caratteristica').val(configuratorFeature.data('id_caratteristica'));var orientation=self.ctr.selected('Orientamento');if(orientation&&orientation.data('id')==='848')
{self.$('#orientamento').val('P');}
else
{self.$('#orientamento').val('L');}
if(self.$('#iframe_src').data('path')===undefined)
{self.$('#iframe_src').data('path',self.$('#iframe_src').val());}
configuratorSrc=self.$('#iframe_src').data('path');var d_iframe=self.$('#domid').val();if(d_iframe==='')
{d_iframe=Math.round((new Date().getTime())/1000);}
if(!self.$('#iframe_src').data('old_parameters')){self.$('#iframe_src').data('old_parameters',{num_lav:self.$('#num_lav').val(),id_prodotto:self.$('#id_prodotto').val(),id_caratteristica:self.$('#id_caratteristica').val(),id_opzione:self.$('#id_opzione').val(),orientamento:self.$('#orientamento').val()});self.$('#domid').val(d_iframe);}
var old_parameters=self.$('#iframe_src').data('old_parameters');var change=false;if(old_parameters["id_caratteristica"]!==self.$('#id_caratteristica').val()){change=true;}
if(old_parameters["id_opzione"]!==self.$('#id_opzione').val()){change=true;}
if(old_parameters["orientamento"]!==self.$('#orientamento').val()){change=true;}
if(change){d_iframe=Math.round((new Date().getTime())/1000);self.$('#domid').val(d_iframe);self.$('#iframe_src').data('old_parameters',{num_lav:self.$('#num_lav').val(),id_prodotto:self.$('#id_prodotto').val(),id_caratteristica:self.$('#id_caratteristica').val(),id_opzione:self.$('#id_opzione').val(),orientamento:self.$('#orientamento').val()});self.$('#conf_preview').empty().removeClass('border_bottom').addClass('no_border_bottom');self.$('#menu_prodotto_configuratore').hide();}
self.$('.row_title_configuratore .prev_title').html(self.$('.row_title_configuratore .prev_title').data('inizio'));self.$('.configuratore_row').removeClass('hide');self.$('#cnt_configura_btn').removeClass('hide');self.$('#delete_configuratore').addClass('hide');self.$('.modifica_grafica').addClass('hide');self.$('.crea_grafica').removeClass('hide');self.ctr.set('domidlav',self.$('#domid').val());configuratorSrc='/international/uptime.php?service=configuratore&url='+encodeURIComponent(configuratorSrc+self.createConfiguratorUrl(d_iframe));self.ctr.data('configuratorSrc',configuratorSrc);}else{self.$('#domid').val(Math.round((new Date().getTime())/1000));self.ctr.data('configurabile',0);self.$('#ctn_configura_btn').addClass('hide');self.$('#conf_preview').empty().removeClass('border_bottom').addClass('no_border_bottom');self.$('#menu_prodotto_configuratore').hide();}};this.createConfiguratorUrl=function(d){return'?session_id='+self.$('#session_id').val()+'&num_lav='+self.$('#num_lav').val()+'&id_prodotto='+self.$('#id_prodotto').val()+'&id_caratteristica='+self.$('#id_caratteristica').val()+'&id_opzione='+self.$('#id_opzione').val()+'&orientamento='+self.$('#orientamento').val()+'&domid='+d+'&lang='+self.$('#lang').val()+'&version='+self.$('#tipo_configuratore').val()+'&date='+d+'&xs=1';};this.countValidations=function(){if(self.ctr.isValid()){numValidates+=1;if(numValidates===1){$.Tc_TrackEvent(self.$('.cart_prev_totale'),'preventivo_valido',{'add_product_id':self.ctr.data('id'),'add_product_nome':self.ctr.data('nome')});}}};this.showMessageCart=function(param){var cart_num=this.$('#top_carrello .cart_badge').first(),cart_num_xs=this.$('#button_cart .cart_badge'),lavorazioni=parseInt(cart_num.text());var html_out='';if(param==='ko'){html_out=msgLimiteOrdine;}else{cart_num.text(lavorazioni+1).removeClass('hide');cart_num_xs.text(lavorazioni+1).removeClass('hide');html_out='<h4>'+prodotto_aggiunto+'</h4>';if(param!=='ok')
{var messaggi=param.split("|");self.$(".modal_close","#modal").before('<div class="modal_close_txt col-xs-12 text-center bottom-10">'+messaggi[0]+'</div>');self.$(".modal_action","#modal").before('<div class="modal_action_txt col-xs-12 text-center top-10">'+messaggi[1]+'</div>');}}
var params={html_out:html_out,title:'<div class="modal_icon success"><span class="line tip"></span><span class="line long"></span><div class="placeholder"></div><div class="fix"></div></div>',do_quote:1,show_action:true,show_close:true,txt_action:vai_al_carrello,txt_close:continua_gli_acquisti,icon_type:"success"};self.openModal(params);};this.updateAddToCart=function(){if(self.ctr.isValid()){self.$('.add_carrello').removeClass('btn-info-custom').addClass('btn-cart-custom');self.$('.add_carrello').html(self.$('.add_carrello').data('valid'));self.$('.add_carrello').css({"color":"#515151","font-weight":"bold"});self.$('.fa','.add_carrello').removeClass('fa-calculator').addClass('fa-cart-arrow-down');self.$('.go_to_grid').removeClass('btn-info-custom').addClass('btn-cart-custom');self.$('.go_to_grid').html(self.$('.go_to_grid').data('valid'));self.$('.recap_txt').removeClass('hide');}else{self.$('.add_carrello').removeClass('btn-cart-custom').addClass('btn-info-custom');self.$('.add_carrello').html(self.$('.add_carrello').data('invalid'));self.$('.add_carrello').css({"color":"white","font-weight":"normal"});self.$('.fa','.add_carrello').removeClass('fa-cart-arrow-down').addClass('fa-calculator');self.$('.go_to_grid').removeClass('btn-cart-custom').addClass('btn-info-custom');if(width_xs){self.$('.go_to_grid').html('<i class="fa fa-calculator fa-2x"></i>');}else{self.$('.go_to_grid').html(self.$('.go_to_grid').data('invalid'));}
self.$('.recap_txt').addClass('hide');}};updatePromocodeVerification=function(){if(self.ctr.isValid())
{self.$('#verifica_promocode').prop('disabled',false);}
else
{self.$('#verifica_promocode').prop('disabled',true);}};this.updateSummary=function(){var summary=this.ctr.summary(),valuta=this.ctr.currency['symbol'];var html_netto=valuta+' '+formatPrice(summary['net'],false);var html_netto_right=html_netto;if(summary["modifier"]==="promo"||summary["modifier"]==="discount")
{var priceList=self.ctr.priceList;var p=parseInt(self.ctr.get('id_priorita'));var qta=summary['qty'];if(self.ctr.data('qta_libera'))
{qta=1;}
var priorities=priceList[qta][p];html_netto_right="<span style='text-decoration: line-through;color:#515151;vertical-align:top;'>"+valuta+' '+formatPrice(priorities['net'],false)+"</span><br />"+html_netto;}
var qta_out=summary['qty'];if(self.ctr.data('locale')==="en_US")
{qta_out=formatNumberLocale(qta_out);}
this.$('.cart_qta_prodotto').html(qta_out);var d=new Date(summary["deliveryDate"].replace(/-/g,'/'));self.$('.cart_prev_consegna').html(giorni[d.getDay()]+'<br />'+d.getDate()+'<br />'+mesi[d.getMonth()]);self.$('.cart_prev_consegna_number').html(d.getDate()+' '+mesi[d.getMonth()]);self.$('.cart_prev_netto','.btn-spec').html(html_netto);self.$('.cart_prev_netto','.recap_txt').html(html_netto_right);self.$('#modal').hasClass('fade in')
{$('#modal .cart_prev_netto').html(html_netto);}
self.$('.cart_prev_iva').html(valuta+' '+formatPrice(summary['vat'],false));self.$('.cart_prev_totale').html(valuta+' '+formatPrice(summary['gross'],false));switch(summary['modifier']){case'promo':self.$('.cart_prev_netto').addClass('netto-promo');if(self.$(".recap_right").size()>0&&self.$(".recap_right .cart_prev_netto").parent().siblings().find(".label-promo").size()==0){self.$(".recap_right .cart_prev_netto").parent().siblings().append('<div class="label-promo"><span class="label label-pill label-info">Promo</span></div>');}
break;default:self.$('.cart_prev_netto').removeClass('netto-promo');if(self.$(".recap_right").size()>0&&self.$(".recap_right .cart_prev_netto").parent().siblings().find(".label-promo").size()>0){self.$(".recap_right .cart_prev_netto").parent().siblings().find(".label-promo").remove();}
break;}};this.updateTemplates=function(){if(self.ctr.isValid()){self.ctr.data('template_downloadable',1);var templateFeatures=self.ctr.getFeatureIs({'and':{'template_dinamico':['1']}},'array');if(templateFeatures!==false)
{createTemplateUrls(templateFeatures);}}
else
{self.ctr.data('template_downloadable',0);}
if(self.ctr.data('template_downloadable')===1)
{self.$('.download_template').removeClass('disabled').prop('disabled',false);self.$('#alert_template').addClass('hide');}
else
{self.$('.download_template').addClass('disabled').prop('disabled',true);if(!self.ctr.isValid()&&!self.$('.download_template').hasClass('hide'))
{self.$('#alert_template').removeClass('hide');}}};createTemplateUrls=function(templateFeatures){var orientamento="L",pesi={103:1,367:1,275:1,19:2,132:1,151:4,152:5,35:6,146:7,177:8,36:8},abbondanza=self.ctr.data('abbondanza'),base_documento=0,altezza_documento=0,fronte_retro=0,abbondanza_sf=0;if(abbondanza){var template=false,sup=inf=des=sin=0,piega="",layoutPieghe="",velcro="",tipo_targa="",id_opz_asola="",id_opz_rinforzo="",indice=-1;for(var feature in templateFeatures){var templateFeature=templateFeatures[feature];if(templateFeature.data('template_dinamico')==='1'){template=true;}
if(templateFeature.data('base')>0&&templateFeature.data('larghezza')>0){base_documento=parseFloat(templateFeature.data('base'))*10;altezza_documento=parseFloat(templateFeature.data('larghezza'))*10;}
else if(self.ctr.val('Base')>0&&self.ctr.val('Altezza')>0)
{base_documento=parseFloat(self.ctr.val('Base'))*10;altezza_documento=parseFloat(self.ctr.val('Altezza'))*10;}
if(base_documento<altezza_documento)
{orientamento="P";}
var id_caratteristica=templateFeature.data('id_caratteristica');if(isDefined(pesi[id_caratteristica])&&templateFeature.data('abbondanza')!=null){var peso=pesi[id_caratteristica],abbondanza_opt=templateFeature.data('abbondanza');if(peso>=indice){if(abbondanza_opt["sup"]>0){sup=abbondanza_opt["sup"];indice=peso;}
if(abbondanza_opt["inf"]>0){inf=abbondanza_opt["inf"];indice=peso;}
if(abbondanza_opt["sin"]>0){sin=abbondanza_opt["sin"];indice=peso;}
if(abbondanza_opt["des"]>0){des=abbondanza_opt["des"];indice=peso;}}}}
if(self.ctr.data('template_ok')==='0'){template=true;}
if(self.ctr.feature('Piegatura')&&self.ctr.name('Formato')&&self.ctr.name('Formato')==='Formato personalizzato'){template=false;self.$('#alert_template').html(testo_template_no_disp_formato).removeClass('hide');}
if(template)
{if(self.ctr.name('Orientamento')&&self.ctr.name('Orientamento')=='Orizzontale'){if(base_documento<altezza_documento){var tmp_base=base_documento;base_documento=altezza_documento;altezza_documento=tmp_base;}
orientamento="L";}else if(self.ctr.name('Orientamento')&&self.ctr.name('Orientamento')=='Verticale'){if(base_documento>altezza_documento){var tmp_base=base_documento;base_documento=altezza_documento;altezza_documento=tmp_base;}
orientamento="P";}
if(self.ctr.name('Retro')&&self.ctr.name('Retro')!="Non stampato"){fronte_retro=1;}
if(self.ctr.name('Indicazioni di stampa')&&self.ctr.name('Indicazioni di stampa')=="Fronte e retro uguali"){fronte_retro=0;}
var banner_products={190:1,573:1,574:1,575:1,576:1};if(isDefined(banner_products[self.ctr.id])&&self.ctr.name('Materiale')&&self.ctr.name('Materiale')=="Extreme classic bifacciale 700 gr"){if(self.ctr.name('Indicazioni di stampa')&&self.ctr.name('Indicazioni di stampa')==="Fronte e retro uguali"){fronte_retro=0;}
else
{fronte_retro=1;}
sup=sup*2;inf=inf*2;des=des*2;sin=sin*2;abbondanza_sf=1;}
if(self.ctr.name('Piegatura')){piega=self.ctr.val('Piegatura').replace('#','');}
if(self.ctr.name('Layout pieghe'))
{layoutPieghe=self.ctr.val('Layout pieghe').replace('#','');}
if(self.ctr.name('Velcro'))
{velcro=self.ctr.val('Velcro').replace('#','');}
if(self.ctr.name('Fissaggio a parete'))
{tipo_targa=self.ctr.val('Fissaggio a parete').replace('#','');}
if(self.ctr.name('Asola'))
{id_opz_asola=self.ctr.val('Asola').replace('#','');}
if(self.ctr.name('Rinforzo perimetrale'))
{id_opz_rinforzo=self.ctr.val('Rinforzo perimetrale').replace('#','');}
var template_ok=true;if(self.ctr.name('Grafica')&&self.ctr.val('Grafica')=="#913"){template_ok=true;}
else if(self.ctr.name('Grafica')&&self.ctr.val('Grafica')!="#913")
{template_ok=false;}
if(template_ok){var base_totale=base_documento+sin+des;var altezza_totale=altezza_documento+sup+inf;if((base_totale>0&&base_totale<=5000)&&(altezza_totale>0&&altezza_totale<=5000)){var template_url='/international/template_pdf/template_pdf_new.php?base='+base_documento+'&altezza='+altezza_documento+'&sup='+sup+'&inf='+inf+'&des='+des+'&sin='+sin+'&orientamento='+orientamento+'&fr='+fronte_retro+'&lang='+self.ctr.data('lang')+'&piega='+piega+'&id_prodotto='+self.ctr.id+'&nome_file='+self.ctr.data('nome_file')+'&abbondanza_sf='+abbondanza_sf+'&layoutPieghe='+layoutPieghe+'&velcro='+velcro+'&tipo_targa='+tipo_targa+'&id_opz_asola='+id_opz_asola+'&id_opz_rinforzo='+id_opz_rinforzo;self.ctr.data('template_url',template_url);self.ctr.data('template_downloadable',1);self.emptyTemplate(template_url);template_ok=true;self.$('#alert_template').addClass('hide');}else{template_ok=false;self.$('#alert_template').html(testo_template_non_gen).removeClass('hide');}}
if(!template_ok){self.ctr.data('template_downloadable',0);}}
else
{self.ctr.data('template_downloadable',0);var obj_opt_template=self.$('.download_template');if(self.ctr.data('fixed_opt_template')&&!obj_opt_template.hasClass('zip')){self.ctr.data('template_downloadable',1);self.$('#alert_template').addClass('hide');var images_data=self.ctr.data('images_data');obj_opt_template.data('fixed_opt_template_url','https://images.pixartprinting.net/'+images_data["img"]+'/img/opzione/template/'+self.ctr.data('fixed_opt_template'));var nome_prodotto=self.ctr.data('nome');obj_opt_template.unbind('click');obj_opt_template.removeClass('hide');obj_opt_template.click(function(){if(!$(this).hasClass('no_action_container')){$.Tc_TrackEvent($(this),'ga_event',{'type':'download template','action':'click','label':nome_prodotto});window.location=obj_opt_template.data('fixed_opt_template_url');}});}else{if(isDefined(self.ctr.data('fixed_zip_template'))){if(!self.ctr.data('fixed_zip_template')){self.ctr.data('template_downloadable',0);obj_opt_template.removeData('fixed_opt_template');self.$('#alert_template').addClass('hide');}
else
{self.ctr.data('template_downloadable',1);var nome_prodotto=self.ctr.data('nome');obj_opt_template.unbind('click');obj_opt_template.click(function(){if(!$(this).hasClass('no_action_container')){$.Tc_TrackEvent($(this),'ga_event',{'type':'download template','action':'click','label':nome_prodotto});}});}}
else
{self.ctr.data('template_downloadable',0);}}}}};this.emptyTemplate=function(template_url){var obj_prep_file=self.$('.download_template');var nome_prodotto=self.ctr.data('nome');obj_prep_file.unbind('click');obj_prep_file.click(function(){if(self.ctr.data('template_downloadable')===1){$.Tc_TrackEvent($(this),'ga_event',{'type':'download template','action':'click','label':nome_prodotto});window.location=template_url;}});obj_prep_file.show();};this.refresh=function(){var prev_price=self.$('.cart_prev_totale').html().substring(2);this.refreshFeatures();refreshPromo();updateInsurance();updatePromocodeVerification();self.updateAddToCart();this.updateSummary();this.fillPriceGrid();this.updateTemplates();this.countValidations();this.updateConfigurator();this.updatePreflightInfo();this.updatePriorityTimes();if(self.ctr.isValid())
{self.$('#on_time').removeClass('hide');self.$('#opzioni_aggiuntive').removeClass('hide');if(self.$('#check_prestampa').bootstrapSwitch('disabled'))
{self.$("#check_prestampa").bootstrapSwitch('toggleDisabled');}
if(self.$('#check_assicurazione').bootstrapSwitch('disabled'))
{self.$("#check_assicurazione").bootstrapSwitch('toggleDisabled');}}
else
{self.$('#on_time').addClass('hide');self.$('#opzioni_aggiuntive').addClass('hide');self.$("#check_prestampa").bootstrapSwitch('toggleDisabled');self.$("#check_assicurazione").bootstrapSwitch('toggleDisabled');}
if(self.ctr.data('tour_preventivo')===1)
{Tour();}
self.closeGallery();};this.updatePreflightInfo=function(){var width=self.ctr.get('_B_file');var height=self.ctr.get('_H_file');if((self.ctr.data('mostra_preflight_info')=='1'||(self.ctr.get('id_bestPrice')>0&&self.ctr.id!=172))&&width>0&&height>0){if(!self.ctr.data('preflight-info')){self.ctr.data('preflight-info',this.$('#preflight-info').html());}
var base_out=(width/10)+' cm';var altezza_out=(height/10)+' cm';if(self.conversionClass!==null)
{base_out=self.conversionClass.cmToMUnitsText(width/10);altezza_out=self.conversionClass.cmToMUnitsText(height/10);}
var text=self.ctr.data('preflight-info').replace('#base#',base_out).replace('#altezza#',altezza_out);self.$('#preflight-info').html(text);self.$('.preflight').removeClass("hide");self.$('#preflight-info').removeClass("hide");}else{self.$('#preflight-info').addClass("hide");if(self.$('#consigli-stampa').size()<1){$('.preflight').addClass("hide");}}};this.updatePriorityTimes=function(priority){if(!priority){var priority=self.ctr.data('priorita')[self.ctr.get('id_priorita')];}
for(var i in priority['orario'])
{this.$('.more_info_box .'+i).html(priority['orario'][i]);}};this.refreshFeatures=function(){firstInvalidFeature=-1;var featuresName=self.ctr.getFeaturesName();for(var f in featuresName){var feature=self.ctr.feature(featuresName[f]);if(isUndefined(feature["clicked"]))
{feature["clicked"]=false;}
if(feature['changed']){if(!feature["clicked"]&&!self.$('.info_features','#ui-'+feature.id_rel).parent().hasClass('hide'))
{$('.info_features',self.$('#ui-'+feature.id_rel)).parent().addClass('hide');}
feature["clicked"]=false;switch(feature['tipo']){case'select':if(feature.data('label')!=='quantita')
{self.refreshSelect(feature);}
else
{self.refreshQty(feature);}
break;case'grid':case'gallery':self.refreshGallery(feature);break;case'input':if(feature.data('label')!=='quantita')
{self.refreshInput(feature);}
else
{self.refreshInputQty(feature);}
break;default:}}
if((feature.data('label')!=='quantita'||self.ctr.data('qta_libera'))&&!is_fastlane)
{self.updateStatus(feature);}}};showPriceGrid=function(prev_price,close,caller){if(self.ctr.isValid())
{var summary=self.ctr.summary();if(self.$('#price_grid').css('display')==="block"&&close)
{slideUpPriceGrid();}
else if(prev_price==="0,00"||prev_price==="0.00"||prev_price===''||caller==="toggler")
{if(!is_fastlane)
{slideDownPriceGrid();}}
if(prev_price!==""&&prev_price!==formatPrice(summary['gross']))
{self.$("#resume_addToCart button").removeClass("flash");$('#modal .btn-spec').removeClass("flash");setTimeout(function(){self.$("#resume_addToCart button").addClass("flash");$('#modal .btn-spec').addClass("flash");},1);}}
else
{self.$('.recap_toggler').addClass('hide');slideUpPriceGrid();}};slideDownPriceGrid=function(){self.$('#price_grid').slideDown('fast',function(){self.$(".hide_price_grid_diz").removeClass('hide');self.$(".recap_toggler").css({'width':'180px'});self.$(".show_price_grid_diz").addClass('hide');$(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down");self.$('.recap_toggler').removeClass('hide');});};slideUpPriceGrid=function(){self.$('#price_grid').slideUp('fast',function(){$(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up");self.$(".hide_price_grid_diz").addClass('hide');self.$(".recap_toggler").removeAttr('style');self.$(".show_price_grid_diz").removeClass('hide');});};this.refreshSelect=function(feature){var option,domOption,optGroup={};var featureId='#'+feature.id_rel;for(var o in feature.opzioni){option=feature.opzioni[o];domOption=this.$(featureId);self.checkIncompatibility(option,domOption,optGroup,false,feature);option['changed']=false;}
checkOptgroupIncompatibility(feature,optGroup);changeIcon(feature);if(self.$(featureId).val()!==feature["selected"]){self.$(featureId).val(feature['selected']);}
if(self.$(featureId).find("option:not([hidden])").size()===1){var selected=feature["selected"];self.$(featureId).addClass('hide');self.$(featureId).parent().find('span').html(feature["opzioni"][selected].data('nome')).removeClass('hide');}
else{self.$(featureId).parent().find('span').empty().addClass('hide');self.$(featureId).removeClass('hide');}};this.updateStatus=function(feature){var class_panel="";switch(feature.tipo){case"select":class_panel="feature-select";break;case"input":class_panel="feature-input";break;case"gallery":case"grid":class_panel="feature-gallery";break;}
if(feature['valid']===false&&feature['incompatibile']===false){if(firstInvalidFeature===-1&&feature.data('interno')!=='1')
{firstInvalidFeature=feature.id_rel;}
var msg=errorMessage(feature['nome']);if(msg)
{$('.info_features',self.$('#ui-'+feature.id_rel)).find('.alert').html(msg).prop('class','alert alert-danger');if(msg.indexOf('|')===-1&&msg.indexOf('#')===-1){$('.info_features',self.$('#ui-'+feature.id_rel)).parent().removeClass('hide');}
$('a.info',self.$('#ui-'+feature.id_rel)).addClass('hide');}
else
{$('a.info',self.$('#ui-'+feature.id_rel)).addClass('hide');}
if(feature.data('hidden')!=='1')
{self.$('#ui-'+feature.id_rel).prop('class','panel panel-default has-error feature '+class_panel);self.$('label','#ui-'+feature.id_rel).removeClass('text-warning').addClass('text-danger');}}else if(feature['warning']&&feature['incompatibile']===false){var msg=warningMessage(feature['nome']);if(msg)
{$('.info_features',self.$('#ui-'+feature.id_rel)).find('.alert').html(msg).prop('class','alert alert-warning');$('.info_features',self.$('#ui-'+feature.id_rel)).parent().removeClass('hide');$('a.info',self.$('#ui-'+feature.id_rel)).addClass('hide');}
else
{self.$('a.info',self.$('#ui-'+feature.id_rel)).addClass('hide');}
if(feature.data('hidden')!=='1')
{self.$('#ui-'+feature.id_rel).prop('class','panel panel-default has-warning feature '+class_panel);self.$('label','#ui-'+feature.id_rel).removeClass('text-danger').addClass('text-warning');}}else{var msg=infoMessage(feature['nome']);var gallery=(infoGallery(feature["nome"])!==msg);if(msg.length>0||gallery)
{var class_img='col-xs-12 col-sm-7';var class_info='col-xs-12';if(msg.length===0)
{class_img='col-xs-12 col-xs-offset-0 col-sm-7 col-sm-offset-5';}
var img='';var gal=infoGallery(feature["nome"]);if(gal.length>0)
{img='<div class="'+class_img+'"><img src="'+infoGallery(feature["nome"])+'" class="pull-right" style="max-width:100%;" /></div>';class_info='col-xs-12 col-sm-5';}
if(msg.length>0)
{msg='<div class="'+class_info+'">'+msg+'</div>';}
$('.info_features','#ui-'+feature.id_rel).children().html(msg+img).prop('class','alert alert-info clearfix');$('a.info','#ui-'+feature.id_rel).removeClass('hide');}
else
{$('.info_features','#ui-'+feature.id_rel).children().html('').prop('class','alert alert-info clearfix');$('a.info','#ui-'+feature.id_rel).addClass('hide');}
if(feature.data('hidden')!=='1')
{self.$('#ui-'+feature.id_rel).prop('class','panel panel-default feature '+class_panel);self.$('label','#ui-'+feature.id_rel).removeClass('text-danger text-warning');}}};this.refreshConversionInput=function(cm,f_name,disabled){var conv_to_udm=self.conversionClass.cmToMUnits(cm);if(count(conv_to_udm)>0){var new_cm=self.conversionClass.mUnitTocm(conv_to_udm);var cur_cm=self.ctr.val(f_name);if(cur_cm!==new_cm&&isUndefined(autoFilledFeature[f_name]))
{new_cm=cur_cm;}
if(new_cm!=cm){self.$('#'+self.ctr.feature(f_name).data('id_rel')).val(new_cm);conv_to_udm=self.conversionClass.cmToMUnits(new_cm);}
if(isDefined(mmFeature[f_name]))
{new_cm=cm/10;conv_to_udm=self.conversionClass.cmToMUnits(new_cm);}
for(var i in self.conversionData){var udm=self.conversionData[i];if(udm['feature']==f_name){if(typeof(conv_to_udm[self.conversionData[i]['id']])=='undefined'){conv_to_udm[self.conversionData[i]['id']]=0;}
var value=conv_to_udm[self.conversionData[i]['id']];if(udm['precision']>0){value=value.toFixed(udm['precision']);}else{value=value.toFixed(0);}
self.$('#'+i).val(value);if(disabled===true){self.$('#'+i).prop('disabled',true);}else if(isUndefined(autoFilledFeature[f_name])){self.$('#'+i).removeAttr('disabled');}}}}};this.closeGallery=function(){$(".feature-slick:not(.slick-initialized)").each(function(){if($(this).hasClass("grid")){$(this).removeClass("grid");if(width_md){$(this).find('img').height(66);}else{$(this).find('img').height(84);}
equalHeight($(this).find('.item'));}else{var elem=$(this).parent().parent();elem.find('.open_gallery .fa').removeClass('fa-eye-slash').addClass('fa-eye');$(this).removeData('slick_removed');$(this).slick(conf_gallery);$(this).slick('slickFilter',':not(.hide)');}});};this.refreshQty=function(feature){var option,domOption,domOption_qty,optGroup={},restyleQty=false,restylePrioritiesColumn=false;var numero_opzioni_visibili=0;for(var o in feature.opzioni){option=feature.opzioni[o];var id_rel=option.id_rel;domOption=this.$(id_rel);domOption.removeClass('selected');domOption_qty=this.$('Q'+id_rel);domOption_qty.removeClass('selected');if(!option["incompatibile"])
{numero_opzioni_visibili++;}
this.$('.dettaglio_quantita',id_rel).removeClass('selected');if(self.checkIncompatibility(option,domOption,optGroup,false,feature)){restyleQty=true;}
checkNotAvailable(option,domOption);restylePrioritiesColumn=true;option['changed']=false;}
limit_qta=!is_fastlane&&!self.ctr.data('qta_libera')&&(numero_opzioni_visibili>limite_qta_visibili);this.$('.top_data_spedizione').removeClass('selected');option=feature['opzioni'][feature['selected']];domOption=self.$(option['id_rel']);domOption.addClass('selected');domOption_qty=self.$('Q'+option['id_rel']);domOption_qty.addClass('selected');self.$(option.id_rel+'_'+self.ctr.get('id_priorita')).addClass('selected');if(this.$(feature.id_rel).val()===null){this.$(feature.id_rel).val(feature['selected']);}
self.$('P'+self.ctr.get('id_priorita')).addClass('selected');option['changed']=false;feature['changed']=false;};this.refreshGallery=function(feature){if(!self.$('#'+feature.id_rel).hasClass("grid")){if(!self.$('#'+feature.id_rel).hasClass('slick-initialized'))
{self.$('#'+feature.id_rel).removeData('slick_removed');self.$('#'+feature.id_rel).slick(conf_gallery);}}
var option,domOption,optGroup={};var option_sel=self.ctr.selected(feature.nome);var id_rel=option_sel.id_rel;if(!self.$('#'+feature.id_rel).hasClass("grid")){self.$('#'+feature.id_rel).slick('slickUnfilter');}
changeIcon(feature);var index=-1;var sel_index=-1;for(var o in feature.opzioni){option=feature.opzioni[o];domOption=this.$('#'+option.id_rel);self.checkIncompatibility(option,domOption,optGroup,true,feature);option['changed']=false;if(!option.incompatibile)
{index++;}
if(option.id_rel===id_rel)
{sel_index=index;}}
self.$('.item',feature.id_rel).removeClass('active');self.$(id_rel).addClass('active');if(!self.$('#'+feature.id_rel).hasClass("grid")){self.$('#'+feature.id_rel).slick('slickFilter',':not(.hide)');self.$('#ui-'+feature.id_rel).find('.fa-eye-slash').removeClass('fa-eye-slash').addClass('fa-eye');setTimeout(function(){self.$('#'+feature.id_rel).slick('slickGoTo',sel_index,true);},500);}
feature.data('goTo',sel_index);};this.refreshInput=function(feature){var domFeature=this.$(feature.id_rel);var disabled=false;if(feature['incompatibile']){domFeature.attr('disabled',true);domFeature.addClass('disabled');disabled=true;}else{if(!isDefined(autoFilledFeature[feature.nome]))
{domFeature.removeAttr('disabled');}
domFeature.removeClass('disabled');}
domFeature.val(feature['value']);changeIcon(feature);if(feature['value']!==''&&self.hasConversion(feature)){self.refreshConversionInput(feature['value'],feature.data('name'),disabled);}};this.refreshInputQty=function(feature){var option,domOption,restyleQty=false,restylePrioritiesColumn=false;changeIcon(feature);option=feature['opzioni'][1];this.$('.top_data_spedizione').removeClass('selected');domOption=self.$(option['id_rel']);domOption.addClass('selected');var qty=pixartParseFloat(this.ctr.val(feature['nome']));if(qty!==0)
{this.$('.qta_libera').val(qty);}
this.$('.dettaglio_quantita',option.id_rel).removeClass('selected');self.$('P'+self.ctr.get('id_priorita')).addClass('selected');self.$(option.id_rel+'_'+self.ctr.get('id_priorita')).addClass('selected');};refreshPromo=function(){var promocode=self.ctr.promocode;for(var i in promocode)
{if(promocode[i]['codice_richiesto']===0)
{for(var j in promocode[i]['rel_prodotto']){}}}
removePromo();if(self.ctr.isValid()){var backupIdPromocode=self.ctr.get('id_promocode');for(var i in promocode){self.ctr.set('id_promocode',i);var promo=self.ctr.activePromo();var rel_prodotto_promocode=self.ctr.data('rel_prodotto_promocode')||{};if(promo!==false&&(isUndefined(rel_prodotto_promocode[i])||rel_prodotto_promocode[i]!==false)){if(promo['codice_richiesto']===0){for(var j in promo['priorita']){var priorita=promo['priorita'][j];}}}}
self.ctr.set('id_promocode',backupIdPromocode);}};this.fillPriceGrid=function(){var priceList=self.ctr.priceList;var enabledPriority={};var valuta=this.ctr.currency['symbol'];var option_qta=self.ctr.getOptionsList(self.ctr.data('caratteristica_qta'));var number_priority=0;if(option_qta.length===0)
{var feature=self.ctr.feature(self.ctr.data('caratteristica_qta'));option_qta=[];option_qta[1]=[];option_qta[1]["id_rel"]='000'+feature.id_rel;var quantity=pixartParseFloat(this.ctr.val(this.ctr.data('caratteristica_qta')));if(quantity!==0)
{if(self.ctr.data('locale')==="en_US")
{quantity=formatNumberLocale(quantity);}
self.$('.quantity').html(quantity);}}
var original_assicurazione=self.ctr.get('assicurazione');numero_priorita=0;for(var qty in priceList){var priorities=priceList[qty];var priorities_sort=self.ctr.data('priorita_sort');var id_rel=option_qta[qty]["id_rel"];for(var pr in priorities_sort){var p=priorities_sort[pr];var priority=priorities[p];if(typeof(enabledPriority[p])==='undefined')
{enabledPriority[p]=0;}
var modifier=keyMinNotZero(priority,['net','bestprice','discount','promo']);if(priority["enabled"])
{var prepress=self.ctr.prepressCheckModifier(priority['net']);var insurance=self.ctr.insuranceModifier(priority['net']);var new_netto=priority[modifier]+prepress+insurance;var html_netto=valuta+' '+formatPrice(new_netto);enabledPriority[p]++;if(modifier==="promo"||modifier==="discount")
{var html_netto_promo=""+valuta+' '+formatPrice(priority["net"],false)+"";var html_ivato_promo=""+valuta+' '+formatPrice(priority["net"]*(pixartParseFloat(this.ctr.data('aliquota'))/100+1),false)+"";self.$(id_rel+'_'+p).removeClass('promo_siblings promo discount');self.$(id_rel+'_'+p).find('.prezzi').removeClass('disabled_qta_promo disabled_qta_discount');self.$(id_rel+'_'+p).addClass(modifier);self.$(id_rel+'_'+p).siblings().not('.'+modifier).addClass('promo_siblings');self.$('P'+p).removeClass('promo discount');self.$('P'+p).addClass(modifier);self.$('Q'+id_rel).removeClass('promo discount');self.$('Q'+id_rel).addClass(modifier);if(modifier==="promo"&&self.$('Arrow'+p).html()!==label_promo){self.$('Arrow'+p).html(label_promo);}
priceGrid[qty][p]["sm"].parent().find('.netto_original').remove();priceGrid[qty][p]["gross_sm"].parent().find('.ivato_original').remove();priceGrid[qty][p]["sm"].parent().prepend('<div class="netto_original">'+html_netto_promo+'</div>');priceGrid[qty][p]["gross_sm"].parent().prepend('<div class="ivato_original">'+html_ivato_promo+'</div>');if(parseInt(self.ctr.data('preventivo_con_iva'))!==0)
{$('.netto_original').hide();$('.ivato_original').hide();}}
else
{self.$('Arrow'+p).html(label_arrow);self.$(id_rel+'_'+p).removeClass('promo_siblings promo discount');self.$(id_rel+'_'+p).find('.prezzi').removeClass('disabled_qta');self.$(id_rel+'_'+p).siblings().removeClass('promo_siblings');self.$('Q'+id_rel).removeClass('promo discount');self.$('P'+p).removeClass('promo discount');priceGrid[qty][p]["sm"].parent().find('.netto_original').remove();priceGrid[qty][p]["gross_sm"].parent().find('.ivato_original').remove();self.$("P"+p).removeClass("promo");self.$("P"+p).find(".label-info").remove();}
priceGrid[qty][p]["sm"].html(html_netto).removeClass('disabled').parent().parent().removeClass('disabled_qta');priceGrid[qty][p]["gross_sm"].html(valuta+' '+formatPrice(new_netto*(pixartParseFloat(this.ctr.data('aliquota'))/100+1))).removeClass('disabled').parent().parent().removeClass('disabled_qta');}
else
{var class_grid='disabled_qta';self.$(id_rel+'_'+p).find('.prezzi').removeClass('disabled_qta_promo disabled_qta_discount');if(modifier==='promo')
{class_grid='disabled_qta_promo';}
else if(modifier==='discount')
{class_grid='disabled_qta_discount';}else
                    {                        priceGrid[qty][p]["sm"].parent().find('.netto_original').remove();                        priceGrid[qty][p]["gross_sm"].parent().find('.ivato_original').remove();                    }
self.$(id_rel+'_'+p).removeClass('promo_siblings promo discount');priceGrid[qty][p]["sm"].html('-').addClass('disabled').parent().parent().addClass(class_grid);priceGrid[qty][p]["sm"].parent().find('.netto_original').html('-');priceGrid[qty][p]["gross_sm"].html('-').addClass('disabled').parent().parent().addClass(class_grid);}}}
self.ctr.set('assicurazione',original_assicurazione);if(limit_qta&&!self.$('.more_button').hasClass('hide'))
{if(self.$(".row_qta_data").not(".hide").index($(".row_qta_data.selected"))+1>limite_qta_visibili)
{self.$('.more_button').addClass('hide');self.$('.collapsed_grid').css({overflow:'hidden',height:'auto'});}
else
{self.$('.more_button').removeClass('hide');var altezza_intestazione=self.$('.delivery_dates').height()+self.$('.row_promo').height()+(self.$('.row_qta_data').find('.selected').outerHeight(true)*limite_qta_visibili)-2;self.$('.collapsed_grid').css({overflow:'hidden',height:altezza_intestazione+'px'});}}
else
{self.$('.more_button').addClass('hide');}
var priorities_sort=self.ctr.data('priorita_sort');if(numero_priorita>numero_priorita_visibili)
{self.$('.qta_start, .qta_end, .qta_minus, .qta_plus').removeClass('hide');if($('.grid_scroll').scrollLeft()==0)
{self.$('.qta_start, .qta_minus').addClass('hide');}}
for(var p in enabledPriority)
{if(enabledPriority[p]===0)
{if(width_xs)
{self.$("P"+p).addClass('hide');self.$("Arrow"+p).addClass('hide');for(var o in option_qta){var id_rel=option_qta[o].id_rel;self.$(id_rel+'_'+p).addClass('hide');}}
else
{self.$("a","P"+p).addClass('disabled');self.$('Arrow'+p).html(label_arrow);numero_priorita++;}}
else
{numero_priorita++;if(width_xs)
{self.$("P"+p).removeClass('hide');self.$("Arrow"+p).removeClass('hide');for(var o in option_qta){var id_rel=option_qta[o].id_rel;self.$(id_rel+'_'+p).removeClass('hide');}}
else
{self.$("a","P"+p).removeClass('disabled');}}}
if(numero_priorita>numero_priorita_visibili){self.$('.qta_plus').removeClass('hide');self.$('.qta_end').removeClass('hide');}};ProductView.prototype.$=this.$=function(key,context){var contextObj;if(typeof(context)=='undefined'){context='';contextObj=document;}else{contextObj=this.$(context);context+='/';}
if(!hasKey(this.cache,context+key)){var obj=null;if(parseInt(key,10)==key)
obj=$('#'+key,contextObj);else
obj=$(key,contextObj);this.cache[context+key]=obj;}
return this.cache[context+key];};this.addToCache=function(key,context,$obj){if(typeof($obj)==='undefined'){$obj=context;context='';}else{context+='/';}
this.cache[context+key]=$obj;};this.checkIncompatibility=function(option,domOption,optGroup,gallery,feature){if(option.incompatibile){if(self.$(option.id_rel,'#'+feature.id_rel).is('option'))
{self.$(option.id_rel,'#'+feature.id_rel).prop('disabled','disabled');self.$(option.id_rel,'#'+feature.id_rel).prop('hidden',true);self.$(option.id_rel,'#'+feature.id_rel).addClass('hide');}
else if(domOption.is('select'))
{self.$('#'+option.id_rel).prop('disabled','disabled');}
else if(!domOption.hasClass('hide'))
{domOption.addClass('hide');if(self.$('Q'+option.id_rel).size()>0)
{self.$('Q'+option.id_rel).addClass('hide');}}
return true;}else{if(typeof(option.opt_group)!=='undefined')
{optGroup[option.opt_group]=optGroup[option.opt_group]?optGroup[option.opt_group]+1:1;}
if(self.$(option.id_rel,'#'+feature.id_rel).is('option'))
{self.$(option.id_rel,'#'+feature.id_rel).prop('disabled',false);self.$(option.id_rel,'#'+feature.id_rel).prop('hidden',false);self.$(option.id_rel,'#'+feature.id_rel).removeClass('hide');}
else if(domOption.is('select'))
{self.$('#'+option.id_rel).prop('disabled',false);}
else if(domOption.hasClass('hide'))
{domOption.removeClass('hide');if(self.$('Q'+option.id_rel).size()>0)
{self.$('Q'+option.id_rel).removeClass('hide');}}
return true;}
return false;};checkCharInput=function(old_string,qty){var new_string;if(qty)
{new_string=old_string.replace(/\D+/g,'');}
else
{new_string=old_string.replace(/[^.\d]/g,'');new_string=new_string.split(/[.](.+)/);if(count(new_string)>1){new_string[0]=new_string[0].replace(/\D+/g,'');new_string[1]=new_string[1].replace(/\D+/g,'');new_string=new_string[0]+"."+new_string[1];}}
return new_string;};showPriceVat=function(ivato,options){var priorities_sort=self.ctr.data('priorita_sort');for(var ps in priorities_sort)
{var p=priorities_sort[ps];if(parseInt(ivato)===1)
{for(var o in options){var id_rel=options[o].id_rel;self.$(id_rel+'_'+p).find('.colonna-ivato').removeClass('hide').addClass('bold');self.$(id_rel+'_'+p).find('.colonna-netto').addClass('hide').removeClass('bold');}}
else
{for(var o in options){var id_rel=options[o].id_rel;self.$(id_rel+'_'+p).find('.colonna-ivato').addClass('hide').removeClass('bold');self.$(id_rel+'_'+p).find('.colonna-netto').removeClass('hide').addClass('bold');}}}};checkNotAvailable=function(option,domOption){if(option.non_disponibile)
{domOption.addClass('non_disponibile');}
else
{domOption.removeClass('non_disponibile');}};checkOptgroupIncompatibility=function(feature,optGroup){if(isDefined(feature['opt_group'])){for(var o in feature['opt_group']){var domOptGroup=self.$(feature['opt_group'][o]['id_rel']);if(isDefined(optGroup[o])&&optGroup[o]>0)
domOptGroup.show();else
domOptGroup.hide();}}};changeIcon=function(feature){if(feature.valid)
{var class_span='text-success';if(self.$(feature.id_rel).find("option:not([hidden])").size()===1){class_span='fa fa-lock';}
self.$('.info_box i','#ui-'+feature.id_rel).prop('class',class_span);}
else
{self.$('.info_box i','#ui-'+feature.id_rel).prop('class','text-danger fa fa-exclamation-circle');}};updateInsurance=function(){if(self.ctr.data('assicurazione')==='1'){var temp=self.ctr.get('assicurazione');var net=self.ctr.summary()['originalNet'];var vendor=self.ctr.get('id_fornitore');if(net>=8&&vendor===0){self.$('#assicurazione').removeClass('hide');var valuta=self.ctr.currency['symbol'];self.$('#costo-aggiuntivo-assicurazione').html(valuta+' '+formatPrice(self.ctr.insuranceModifier(net,true)));}else{self.$('#assicurazione').addClass('hide');if(temp==='1'){self.$('#costo-aggiuntivo-assicurazione').html('');self.ctr.set('assicurazione',0);}}}};removePromo=function(p){if(isUndefined(p)){var priorita=self.ctr.data('priorita');for(var i in priorita){}}else{}};removePromoFromOptions=function(){var promocode=self.ctr.promocode;for(var i in promocode){for(var j in promocode[i]['rel_prodotto']){var array_option=promocode[i]['rel_prodotto'][j];}}};formatPrice=function(price){return this.formatNumberLocale((price/pixartParseFloat(json_valuta['cambio_applicato'])).toFixed(2));};formatNumberLocale=function(number){var separators={'thousands':'.','decimals':','};switch(self.ctr.data('locale')){case'en_US':separators={'thousands':',','decimals':'.'};break;}
var x=String(number).split('.');var x1=x[0];var x2=x.length>1?separators['decimals']+x[1]:"";var r=/(\d+)(\d{3})/;while(r.test(x1)){x1=x1.replace(r,'$1'+separators['thousands']+'$2');}
return x1+x2;};formatDate=function(date,includeYear){date=date.split('-');return date[2]+'/'+date[1]+(includeYear!==false?'/'+date[0]:'');};getOptionName=function(option){var mostra_prezzo=(option.data('mostra_prezzo')==='1');var prezzi=option.data('prezzi');var nome='';if(isDefined(option.data('nome'))&&option.data('nome')!==false)
{nome+=option.data('nome').replace(/(<([^>]+)>)/ig," ").replace(/\s+/ig,' ');}
var unita_misura;var prezzo_out='';if(mostra_prezzo&&prezzi[0]['cad']>0)
{var cad=prezzi[0]['cad'];if(isDefined(self.ctr.data('nazioni_intrastat')[self.ctr.data('id_nazione')])&&self.ctr.data('mod_netto'))
{cad*=self.ctr.data('mod_netto');}
else if(isDefined(self.ctr.data('nazioni_intrastat')[self.ctr.data('id_nazione')])&&isUndefined(self.ctr.data('vantaggi_pf')[self.ctr.data('id_nazione')]))
{cad*=1.1;}
if(self.ctr.data('lang')==='en'||self.ctr.data('lang')==='us')
{unita_misura="sqm";}
else
{unita_misura="m&sup2;";}
if(cad>0)
{if(self.ctr.data('locale')==="en_US"){prezzo_out+=' - '+" "+json_valuta["simbolo"]+formatPrice(cad)+" "+"/"+" "+unita_misura;}else{prezzo_out+=' - '+" "+formatPrice(cad)+" "+json_valuta["simbolo"]+"/"+unita_misura;}}
if(isDefined(self.ctr.selPromocode)&&isDefined(self.ctr.promocode[self.ctr.selPromocode])&&isDefined(self.ctr.promocode[self.ctr.selPromocode]["rel_prodotto"]))
{var rel_prodotto=self.ctr.promocode[self.ctr.selPromocode]["rel_prodotto"];for(var i in rel_prodotto)
{if(rel_prodotto[i]===option["id_rel"])
{prezzo_out+=' - PROMO';}}}}
return nome+prezzo_out;};posizionaPagina=function(element){var barra;if(width_sm)
{barra=95;}
else
{barra=101;}
var posizione=self.$(element).offset().top-barra;$('html, body').animate({    scrollTop:posizione},1000);};retrieveMessage=function(f,type,no_html){var msg=self.ctr.message(f,type);if(msg&&self.conversionClass!==null){msg=self.conversionClass.msgConversion(msg);}
if(no_html===true)
{return msg?msg:'';}
else
{return msg?('<div class="padding-info">'+msg+'</div>'):'';}};errorMessage=function(f){return retrieveMessage(f,'error',true);};warningMessage=function(f){return retrieveMessage(f,'warning',true);};infoMessage=function(f){return retrieveMessage(f,'descrizione',true);};infoGallery=function(f){var msg=retrieveMessage(f,'info_gallery',true)||'';if(msg.indexOf('<img src="')!==-1){return(msg).replace(/[^"]+"([^"]+).*/,'$1');}
return'';};bindShowClick=function($obj){$obj.click(function(){var $obj=$(this).parents('.row:eq(0)').find('div.info');if(!$(this).hasClass('carousel-control')){self.$('div.info').each(function(){if(!$(this).find('.alert').hasClass('alert-danger')&&!$(this).find('.alert').hasClass('alert-warning'))
{if($(this).not($obj).size()===1)
{$(this).addClass('hide');}}});$obj.toggleClass('hide');}});};};
var ProductConnector=function(ctr){var self=this;self.getProductData=function(callback){$.phpInitPreventivo(ctr.id,ctr.cacheId,callback);};self.getQuoteAlgorithm=function(callback){var post={};post["script"]=ctr.data('script');post["data_modifica"]=ctr.data('data_modifica_preventivo');$.phpGetPreventivo(post,callback);};self.getPromo=function(callback){$.phpGetPromo((ctr.data('id_prodotto_fantasma')||ctr.id),callback);};self.addToCart=function(callback){console.log('connector::addToCart');var post=ctr.serialize();post['quantita']=ctr.get('_QTA');post["riepilogo"]=true;post["nopath"]=true;post["json_prodotto"]="";var verify_data=ctr.data('verify');if(isDefined(verify_data['cacheId'])){post["json_prodotto"]=verify_data['cacheId'];}
post["website-config"]=ctr.getConfiguration();$.post('/responsive/carrello.php',post,function(data){var parametri={'promocode':ctr.data('promocode'),'action':'add','id_prodotto':ctr.id,'qta_sel':ctr.get('_QTA')};if(ctr.get('id_promocode')&&ctr.data('id_promocode')!="")
{parametri['id_promocode']=ctr.get('id_promocode');}
$.phpSetPromo(parametri,function(){callback(data);});},'json');};self.getPromocodeVerification=function(callback){var params={};params["name"]="account";params["func"]="verifica_promocode";params["id_prodotto"]=ctr.id;params["promocode"]=$('#promocode').val();params["id_promocode"]=ctr.get('id_promocode')!='null'?ctr.get('id_promocode'):'';params["id_selezionati"]={};ctr.eachFeature(function(f){if(isDefined(this.selected(f['nome'])))params["id_selezionati"][f['nome']]=this.selected(f['nome'])['id_rel'];});$.phpVerificaPromocode(params,function(data){callback(data);});};self.setZipcode=function(callback){$.phpSetZipcode(callback);};};
_FUNCTION=1;_AJAX_CALLBACK=2;_QUOTE=4;_INTRASTAT=8;_BESTPRICE=16;_CONFIGURATION_URL=32;_STATUS=64;_PRICE=128;_TIMER=256;_TIMING=512;var ProductClass=function(id,cacheId,view){this.id=id;this.cacheId=cacheId;this.qty=0;this.in_array={};this.id_rels={};this.paths={};this.incompatibility={}
this.not_available={}
this.not_available_date={}
this.configuration={};this.attrs={};this.tags={};this.formats_info={};this.products_info={};this.folds_info={};this.priceList={};this.logLevel=0;this.currency={};this.selPromocode=null;this.promocode={};this.featureChange=true;this.status=false;this.checkSign='';this.view=null;this.connector=null;this.cnt_loops=0;this.max_loops=20;this.percentuale_corriere_default=7;this.viewClass=isDefined(view)?view:ProductView;};ProductClass.prototype={init:function(fn){this.log(_FUNCTION,'ProductClass::init');var self=this;this.connector=new ProductConnector(self);self.connector.getProductData(function(data){if(data){self.addDataMethod(self,data);self.cleanDictionary();if(typeof(fn)=='function')fn.call(self);self.cleanShippingPriorities();self.setInArray();self.setIdRels();self.setPaths();self.setDefaultAttrs();self.initQuote(function(){self.initPromo(function(){self.setFirstOptions();self.setConfigurationByUrl();self.view=new self.viewClass(self);self.view.init();self.doQuote();});});}
else
{self.view=new self.viewClass(self);self.view.init();}});},initCurrency:function(){this.currency={rate:json_valuta['cambio_applicato'],symbol:json_valuta['simbolo']};},initQuote:function(callback){this.log(_FUNCTION,'ProductClass::initQuote');var self=this;this.connector.getQuoteAlgorithm(function(data){self.loadedQuote=new Function(data);if(typeof(callback)=='function')
callback();});},initPromo:function(callback){var self=this;this.connector.getPromo(function(data){if(data){self.setPromocode(data);}
if(typeof(callback)=='function')
callback();});},cleanShippingPriorities:function(){for(var i in this.data('priorita')){if(this.data('priorita')[i]['abilitata']==0){delete this.data('priorita')[i];}else if(this.data('priorita')[i]['limite_orario']!=null&&this.data('priorita')[i]['limite_orario']<this.data('server_time')&&this.data('server_time')<'18:00'&&(new Date().getDay()%6>0)){this.data('priorita')[i]['abilitata']=0;this.data('priorita')[i]['enabled']=false;}else{this.data('priorita')[i]['enabled']=true;}}
this.changePriority(getFirstKey(this.data('priorita')));this.findFirstEnabledPriority();},initFormatsInfo:function(){this.formats_info={'5,5 cm x 5,5 cm':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'5 cm x 5 cm':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'8,5 cm x 5 cm':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'8,5 cm x 5,5 cm':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'9 cm x 5 cm':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'10 cm x 15 cm':{stampesufoglio:8,resa:8,stampesufoglio_offset:16},'10,5 cm x 14,8 cm (DIN A6)':{stampesufoglio:8,resa:8,stampesufoglio_offset:16},'10 cm x 21 cm':{stampesufoglio:6,resa:6,stampesufoglio_offset:16},'14,8 x 14,8 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'14,8 cm x 21 cm (DIN A5)':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'15 cm x 21 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'15cm x 21cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'A5 (15 cm x 21 cm)':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'A5 (21 cm x 15 cm orizzontale)':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'16.5cm x 24cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'17 cm x 24 cm':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'21 cm x 29,7 cm (DIN A4)':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'21cm x 29.7cm':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'A4 (21 cm x 30 cm)':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'A4 (30 cm x 21 cm orizzontale)':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'A4 (21 cm x 30 cm) Arrotondato':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'A4 (21 cm x 30 cm) Squadrato':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'42 cm x 15 cm':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'29,7 cm x 42 cm (DIN A3)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'41 cm x 15 cm':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'41 cm x 29,7 cm':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'A3 (30 cm x 42 cm)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'31 cm x 43 cm':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'31 cm x 43 cm foglio macchina':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'36 cm x 51 cm':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'41 cm x 41 cm':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'41 cm x 52,5 cm':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'42 cm x 59,4 cm (DIN A2)':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'41 cm x 59,4 cm':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'8,89 cm x 5,08 cm (US 3,5x2)':{stampesufoglio:16,resa:20,stampesufoglio_offset:32},'10,69 cm x 13,89 cm (US)':{stampesufoglio:6,resa:6,stampesufoglio_offset:15},'10,16 cm x 15,24 cm (US)':{stampesufoglio:8,resa:8,stampesufoglio_offset:16},'10,16 cm x 15,24 cm':{stampesufoglio:8,resa:8,stampesufoglio_offset:16},'10,80 cm x 13,97 cm':{stampesufoglio:8,resa:8,stampesufoglio_offset:16},'10,16 cm x 22,86 cm':{stampesufoglio:3,resa:3,stampesufoglio_offset:7},'12,70 cm x 17,78 cm (US)':{stampesufoglio:4,resa:4,stampesufoglio_offset:9},'12,70 cm x 17,78 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:9},'13,9 cm x 21,6 cm (US half page)':{stampesufoglio:3,resa:3,stampesufoglio_offset:7},'15,24 cm x 27,94 cm (US)':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'15,24 cm x 27,94 cm':{stampesufoglio:2,resa:2,stampesufoglio_offset:4},'15,24 cm x 15,24 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'20,32 cm x 20,32 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'21,59 cm x 30,43 cm (US full page)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'9,50 cm x 21,01 cm (US long page)':{stampesufoglio:6,resa:6,stampesufoglio_offset:12},'9,50 cm x 21,01 cm':{stampesufoglio:6,resa:6,stampesufoglio_offset:12},'21,59 cm x 55,88 cm (US size)':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:1},'14 cm x 21,6 cm (US)':{stampesufoglio:3,resa:3,stampesufoglio_offset:6},'27,94 cm x 43,18 cm (US ANSI B)':{stampesufoglio:1,resa:1,stampesufoglio_offset:1},'45,72 cm x 60,96 (US ARCH C)':{stampesufoglio:0.5,resa:0.5,stampesufoglio_offset:0.5},'15,24 cm x 22,86 cm (US)':{stampesufoglio:3,resa:3,stampesufoglio_offset:4},'15,24 cm x 22,86 cm':{stampesufoglio:3,resa:3,stampesufoglio_offset:4},'22,86 cm x 30,48 cm (US ARCH A)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'21,59 cm x 27,94 cm (US Letter)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'21,59 cm x 27,94 cm':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'13,97 cm x 21,59 cm (US memo)':{stampesufoglio:3,resa:3,stampesufoglio_offset:6},'13,97 cm x 21,59 cm':{stampesufoglio:3,resa:3,stampesufoglio_offset:6},'30,48 cm x 30,48 cm (US size)':{stampesufoglio:1,resa:1,stampesufoglio_offset:2},'44x64':{stampesufoglio:0.5,resa:0.5},'50x70':{stampesufoglio:0.5,resa:0.5},'60x80':{stampesufoglio:0.25,resa:0.25},'64x88':{stampesufoglio:0.25,resa:0.25},'59.4x84.1':{stampesufoglio:0.25,resa:0.25},'70x100':{stampesufoglio:0.25,resa:0.25},'100x138':{stampesufoglio:0.25,resa:0.125},'120x160':{stampesufoglio:0,resa:0.08},'120x176':{stampesufoglio:0,resa:1},'48,26 cm x 68,58 cm (US size)':{stampesufoglio:0.5,resa:0.5},'30,48 cm x 45,72 cm (US size)':{stampesufoglio:1,resa:1},'33,02 cm x 48,26 cm (US size)':{stampesufoglio:1,resa:1},'68,58 cm x 99,06 cm (US size)':{stampesufoglio:0.25,resa:0.25},'55,88 cm x 71,12 cm (US size)':{stampesufoglio:0.5,resa:0.5},'16,5 cm x 11,5 cm':{stampesufoglio:4,resa:4,stampesufoglio_offset:8},'15 cm x 10,5 cm':{stampesufoglio:4,resa:8,stampesufoglio_offset:16},'64cm x 45cm':{stampesufoglio:1,area_stampabile:0.288},'87cm x 63cm':{stampesufoglio:1,area_stampabile:0.5481},'88cm x 64cm':{stampesufoglio:1,area_stampabile:0.5632},'100cm x 70cm':{stampesufoglio:1,area_stampabile:0.7},'21 cm x 28,5cm':{resa:2},'9,8 cm x 9,8 cm':{stampesufoglio:10},'14,8 cm x 14,8 cm':{stampesufoglio:3.75},'14,8 cm x 29,6 cm':{stampesufoglio:1.5},'14,8 cm x 44,4 cm':{stampesufoglio:1},'14,8 cm x 44,1 cm':{stampesufoglio:1},'21 cm x 9,8 cm':{stampesufoglio:3.75},'21 cm x 21 cm':{stampesufoglio:1.5,resa:3},'21 cm x 42 cm':{stampesufoglio:0.75},'21 cm x 63 cm':{stampesufoglio:0.5},'21 cm x 62,7 cm':{stampesufoglio:0.5},'9,8 cm x 21 cm':{stampesufoglio:3.75},'21 cm x 19,6 cm':{stampesufoglio:1.5},'21 cm x 29,4 cm':{stampesufoglio:1},'21 cm x 29,1 cm':{stampesufoglio:1},'29,7 cm x 21 cm':{stampesufoglio:1},'29,7 cm x 42 cm':{stampesufoglio:1},'29,7 cm x 63 cm':{stampesufoglio:0.25},'29,7 cm x 62,7 cm':{stampesufoglio:0.25},'29,7 cm x 10,5 cm':{stampesufoglio:2.5},'29,7 cm x 31,5 cm':{stampesufoglio:0.5},'29,7 cm x 31,2 cm':{stampesufoglio:0.5},};},initProductsInfo:function(){var pi={};pi[198]=pi[199]={resa:1,formatofogli:"A2"};pi[26]=pi[29]=pi[30]=pi[31]=pi[34]=pi[35]=pi[36]=pi[40]=pi[45]=pi[46]=pi[47]=pi[48]=pi[49]=pi[50]=pi[51]=pi[62]=pi[68]=pi[70]=pi[71]=pi[72]=pi[73]=pi[201]=pi[202]=pi[203]=pi[204]=pi[205]=pi[206]=pi[208]=pi[209]=pi[210]=pi[211]=pi[212]=pi[218]={resa:1,formatofogli:"A3"};pi[13]=pi[16]=pi[17]=pi[18]=pi[19]=pi[20]=pi[21]=pi[22]=pi[23]=pi[24]=pi[25]=pi[32]=pi[37]=pi[39]=pi[41]=pi[42]=pi[64]=pi[65]=pi[67]=pi[200]=pi[307]={resa:2,formatofogli:"A3"};pi[15]=pi[38]={resa:3,formatofogli:"A3"};pi[12]=pi[14]=pi[182]={resa:4,formatofogli:"A3"};pi[74]={resa:6,formatofogli:"A3"};pi[354]=pi[390]=pi[474]={carte_speciali:["Avorio (Symbol Ivory)","Extraprint (Biancoflash) ex Splendorgel","Rembrandt (Twill) ex Acquerello","Turner (Prisma) ex Tintoretto","Underwood (Woodstock betulla)","Ice white (Constellation)","Laguna (Shiro)"],grammature_speciali:["90gr","115gr","085gr","100gr","110gr","140gr","150gr"]};pi[193]={array_carte:{'Classic gloss (Patinata lucida)':0.17,'Classic demimatt (Patinata opaca)':0.17,'Avorio (Symbol Ivory)':0.15,'Extraprint (Biancoflash) ex Splendorgel':0.25},array_carte_coper:{'Stessa grammatura interno':1,'Classic gloss (Patinata lucida) 250gr plastificata':1,'Classic gloss (Patinata lucida) 300gr plastificata':1,'Classic demimatt (Patinata opaca) 250gr plastificata':1,'Classic demimatt (Patinata opaca) 300gr plastificata':1,'Avorio (Symbol Ivory)':1,'Extraprint (Biancoflash) ex Splendorgel':1},grammature_no_fr:[85,100,110,115,130,140,150]};pi[452]={formati:{"50 x 70 cm":[50,70],"50 x 50 cm":[50,50],"70 x 100 cm":[70,100],"100 x 100 cm":[100,100],"30 x 100 cm":[30,100],"2pz 30x100":[100,64],"2pz 30x100 v2":[133,64],"3pz 30x100":[98,100],"4pz 30x100":[132,100],"5pz 30x100":[166,100],"3pz 70x100":[218,100],"2pz 100x100":[204,100],"2pz 1_70x100+1_100x100":[174,100],"4pz 50x50":[104,104]}};this.products_info=pi;},initFoldsInfo:function(){var fi={'format_letter':{'#199':'A','#200':'B','#290':'B','#201':'C','#235':'D','#202':'D','#203':'E','#236':'F','#205':'G','#237':'H','#238':'I','#8756':'L','#8757':'M','#8772':'R','#8758':'N','#8978':'O','#8979':'U','#8137':'P','#8139':'Q','#8138':'S','#8141':'T','#750':'Z',},'paper_folds':{'#230':{'combinazioni':{'#139':{'100':'ABCDEFGHIPQSTZ','160':'ABCDEFGHIPQSTZ','300':'ABCDEFGHIPQSTZ'},'#140':{'120':'ABCDEFGHIPQSTZ','300':'ABCDEFGHIPQSTZ'},'#141':{'300':'ABCDEFGHIPQSTZ'},'#142':{'110':'ABCDEFGHIPQSTZ','170':'ABCDEFGHIPQSTZ','260':'ABCDEFGHIPQSTZ'},'#143':{'280':'ABCDEFGHIPQSTZ'},'#759':{'120':'ABCDEFGHIPQSTZ','300':'ABCDEFGHIPQSTZ'},'#123':{'100':'ABCDEFGHIPQSTZ','130':'ABCDEFGHIPQSTZ','170':'ABCDEFGHIPQSTZ','250':'ABCDEFGHIPQSTZ','300':'ABCDEFGHIPQSTZ','350':'ABCDEFGHIPQSTZ'},'#122':{'100':'ABCDEFGHIPQSTZ','130':'ABCDEFGHIPQSTZ','170':'ABCDEFGHIPQSTZ','250':'ABCDEFGHIPQSTZ','300':'ABCDEFGHIPQSTZ','350':'ABCDEFGHIPQSTZ'},'#298':{'90':'BCDEFGHIPQSTZ'}},},'#714':{'combinazioni':{'#139':{'100':'DEFGHIPQSTZ','160':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#140':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#141':{'300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#142':{'110':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','260':'BCDEFGHIPQSTZ','quantitaMax':1000},'#143':{'280':'BCDEFGHIPQSTZ','quantitaMax':1000},'#759':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#123':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#122':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#298':{'90':'DEFGHIPQSTZ'}},},'#715':{'combinazioni':{'#139':{'100':'DEFGHIPQSTZ','160':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#140':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#141':{'300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#142':{'110':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','260':'BCDEFGHIPQSTZ','quantitaMax':1000},'#143':{'280':'BCDEFGHIPQSTZ','quantitaMax':1000},'#759':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#123':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#122':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#298':{'90':'DEFGHIPQSTZ'}},},'#8920':{'combinazioni':{'#139':{'100':'DEFGHIPQSTZ','160':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#140':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#141':{'300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#142':{'110':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','260':'BCDEFGHIPQSTZ','quantitaMax':1000},'#143':{'280':'BCDEFGHIPQSTZ','quantitaMax':1000},'#759':{'120':'DEFGHIPQSTZ','300':'BCDEFGHIPQSTZ','quantitaMax':1000},'#123':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#122':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'BCDEFGHIPQSTZ','300':'BCDEFGHIPQSTZ'},'#298':{'90':'DEFGHIPQSTZ'}},},'#716':{'combinazioni':{'#139':{'100':'DEFGHIPQSTZ','160':'DEFGHIPQSTZ','300':'DEFGHIPQSTZ','quantitaMax':1000},'#140':{'120':'DEFGHIPQSTZ','300':'DEFGHIPQSTZ','quantitaMax':1000},'#141':{'300':'DEFGHIPQSTZ','quantitaMax':1000},'#142':{'110':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','260':'DEFGHIPQSTZ','quantitaMax':1000},'#143':{'280':'DEFGHIPQSTZ','quantitaMax':1000},'#759':{'120':'DEFGHIPQSTZ','300':'DEFGHIPQSTZ','quantitaMax':1000},'#123':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'DEFGHIPQSTZ','300':'DEFGHIPQSTZ'},'#122':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ','250':'DEFGHIPQSTZ','300':'DEFGHIPQSTZ'},'#298':{'90':'DEFGHIPQSTZ'}},},'#717':{'combinazioni':{'#139':{'100':'DEFHOIPQSTZ','160':'DEFHOIPQSTZ','300':'DEFHOIPQSTZ','quantitaMax':1000},'#140':{'120':'DEFHOIPQSTZ','300':'DEFHOIPQSTZ','quantitaMax':1000},'#141':{'300':'DEFHOIPQSTZ','quantitaMax':1000},'#142':{'110':'DEFHOIPQSTZ','170':'DEFHOIPQSTZ','260':'DEFHOIPQSTZ','quantitaMax':1000},'#143':{'280':'DEFHOIPQSTZ','quantitaMax':1000},'#759':{'120':'DEFHOIPQSTZ','300':'DEFHOIPQSTZ','quantitaMax':1000},'#123':{'100':'DEFHOIPQSTZ','130':'DEFHOIPQSTZ','170':'DEFHOIPQSZ','250':'DEFHOIPQSTZ','300':'DEFHOIPQSTZ'},'#122':{'100':'DEFHOIPQSTZ','130':'DEFHOIPQSTZ','170':'DEFHOIPQSTZ','250':'DEFHOIPQSTZ','300':'DEFHOIPQSTZ'},'#298':{'90':'DEFHOIPQSTZ'}},},'#718':{'combinazioni':{'#139':{'160':'EFGHPQ','300':'EFGHPQ','quantitaMax':1000},'#140':{'300':'EFGHPQ','quantitaMax':1000},'#141':{'300':'EFGHPQ','quantitaMax':1000},'#142':{'170':'EFGHPQ','260':'EFGHPQ','quantitaMax':1000},'#143':{'280':'EFGHPQ','quantitaMax':1000},'#759':{'300':'EFGHPQ','quantitaMax':1000},'#123':{'130':'EFGHPQ','170':'EFGHPQ','250':'EFGHPQ','300':'EFGHPQ'},'#122':{'130':'EFGHPQ','170':'EFGHPQ','250':'EFGHPQ','300':'EFGHPQ'},},},'#722':{'combinazioni':{'#139':{'160':'EFGHPQZ','quantitaMax':1000},'#142':{'170':'EFGHPQZ','260':'EFGHPQZ','quantitaMax':1000},'#123':{'130':'EFGHPQZ','170':'EFGHPQZ','250':'EFGHPQZ'},'#122':{'130':'EFGHPQZ','170':'EFGHPQZ','250':'EFGHPQZ'},},},'#721':{'combinazioni':{'#139':{'100':'FGHIPQSTZ','160':'FGHIPQSTZ','quantitaMax':1000},'#140':{'120':'FGHIPQSTZ','quantitaMax':1000},'#142':{'110':'FGHIPQSTZ','170':'FGHIPQSTZ','quantitaMax':1000},'#759':{'120':'FGHIPQSTZ','quantitaMax':1000},'#123':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ'},'#122':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ'},'#298':{'90':'FGHIPQSTZ'}},},'#719':{'combinazioni':{'#139':{'100':'DEFGHIPQSTZ','160':'DEFGHIPQSTZ'},'#140':{'120':'DEFGHIPQSTZ'},'#142':{'110':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ'},'#759':{'120':'DEFGHIPQSTZ'},'#123':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ'},'#122':{'100':'DEFGHIPQSTZ','130':'DEFGHIPQSTZ','170':'DEFGHIPQSTZ'},'#298':{'90':'DEFGHIPQSTZ'}},},'#720':{'combinazioni':{'#139':{'100':'FGHIPQSTZ','160':'FGHIPQSTZ','quantitaMax':1000},'#140':{'120':'FGHIPQSTZ','quantitaMax':1000},'#142':{'110':'FGHIPQSTZ','170':'FGHIPQSTZ','quantitaMax':1000},'#759':{'120':'FGHIPQSTZ','quantitaMax':1000},'#123':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ','250':'FGHIPQSTZ'},'#122':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ','250':'FGHIPQSTZ'},'#298':{'90':'FGHIPQSTZ'}},},'#723':{'combinazioni':{'#139':{'100':'FGHIPQSTZ','160':'FGHIPQSTZ','quantitaMax':1000},'#140':{'120':'FGHIPQSTZ','quantitaMax':1000},'#142':{'110':'FGHIPQSTZ','170':'FGHIPQSTZ','quantitaMax':1000},'#759':{'120':'FGHIPQSTZ','quantitaMax':1000},'#123':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ','250':'FGHIPQSTZ'},'#122':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ','250':'FGHIPQSTZ'},'#298':{'90':'FGHIPQSTZ'}},},'#726':{'combinazioni':{'#139':{'100':'FGHLPQ'},'#140':{'120':'FGHLPQ'},'#142':{'110':'FGHLPQ'},'#759':{'120':'FGHLPQ'},'#123':{'100':'FGHLPQ','130':'FGHLPQ'},'#122':{'100':'FGHLPQ','130':'FGHLPQ'},'#298':{'90':'FGHLPQ'}},},'#727':{'combinazioni':{'#139':{'100':'ULQ'},'#140':{'120':'ULQ'},'#142':{'110':'ULQ'},'#759':{'120':'ULQ'},'#123':{'100':'ULQ','130':'ULQ'},'#122':{'100':'ULQ','130':'ULQ'},'#298':{'90':'ULQ'}},},'#725':{'combinazioni':{'#139':{'100':'HIST'},'#140':{'120':'HIST'},'#142':{'110':'HIST'},'#759':{'120':'HIST'},'#123':{'100':'HIST','130':'HIST'},'#122':{'100':'HIST','130':'HIST'},'#298':{'90':'HIST'}},},'#724':{'combinazioni':{'#139':{'100':'FGHIPQSTZ','160':'FGHIPQSTZ','quantitaMax':1000},'#140':{'120':'FGHIPQSTZ','quantitaMax':1000},'#142':{'110':'FGHIPQSTZ','170':'FGHIPQSTZ','quantitaMax':1000},'#759':{'120':'FGHIPQSTZ','quantitaMax':1000},'#123':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ'},'#122':{'100':'FGHIPQSTZ','130':'FGHIPQSTZ','170':'FGHIPQSTZ'},'#298':{'90':'FGHIPQSTZ'}},},'#8328':{'combinazioni':{'#139':{'100':'IT'},'#123':{'100':'IT'},'#122':{'100':'IT'},'#298':{'90':'IT'}},},'#8785':{'combinazioni':{'#139':{'100':'ML'},'#140':{'120':'ML'},'#142':{'110':'ML'},'#759':{'120':'ML'},'#123':{'100':'ML','130':'ML'},'#122':{'100':'ML','130':'ML'},'#298':{'90':'ML'}},},'#8784':{'combinazioni':{'#139':{'100':'HL'},'#123':{'100':'HL'},'#122':{'100':'HL'},'#298':{'90':'HL'}},},'#8783':{'combinazioni':{'#139':{'100':'H'},'#140':{'120':'HL'},'#142':{'110':'HL'},'#759':{'120':'HL'},'#123':{'100':'HNL','130':'HNL'},'#122':{'100':'HNL','130':'HNL'},'#298':{'90':'HNL'}},},'#8782':{'combinazioni':{'#123':{'100':'I','130':'I'},'#122':{'100':'I','130':'I'},'#298':{'90':'I'}},},'#8781':{'combinazioni':{'#123':{'100':'M','130':'M'},'#122':{'100':'M','130':'M'},'#298':{'90':'M'}},},'#8780':{'combinazioni':{'#139':{'100':'HL'},'#142':{'110':'HL'},'#123':{'100':'HL','130':'HL'},'#122':{'100':'HL','130':'HL'},'#298':{'90':'HL'}},},'#8779':{'combinazioni':{'#123':{'100':'R'},'#122':{'100':'R'},'#298':{'90':'R'}},},'#8778':{'combinazioni':{'#139':{'100':'M'},'#123':{'100':'M'},'#122':{'100':'M'},'#298':{'90':'M'}},},'#8777':{'combinazioni':{'#139':{'100':'L'},'#123':{'100':'L','130':'L'},'#122':{'100':'L','130':'L'},'#298':{'90':'L'}},},'#8776':{'combinazioni':{'#139':{'100':'HN'},'#142':{'110':'H'},'#759':{'120':'H'},'#123':{'100':'HN','130':'H'},'#122':{'100':'HN','130':'H'},'#298':{'90':'HN'}},}}};this.folds_info=fi;},addDataMethod:function(target,data){this.log(_FUNCTION,'ProductClass::addDataMethod');target.data=function(key,value){if(typeof(value)!='undefined'){data[key]=value;}else if(typeof(key)!='undefined'){if(typeof(key)=='string')
return data[key];else
data=key;}else{return data;}
return target;}
target.removeData=function(key){if(typeof(key)!='undefined'){delete data[key];}else{data={};}
return target;}},setDefaultAttrs:function(){this.data('id_active_promocode',[]);this.set('id_nazione',this.data('id_nazione'));this.set('sabbrix_code',this.data('sabbrix_code'));var jsonKeys=['nazioni_intrastat'];for(var i in jsonKeys)
this.data(jsonKeys[i],JSON.parse(this.data(jsonKeys[i])));this.initFormatsInfo();this.initProductsInfo();this.initFoldsInfo();this.initCurrency();this.set('verifica_prestampa','Non verificare');this.data('incompatibility',{});if(this.data('nazioni_intrastat')[this.get('id_nazione')]=='1'&&this.data('vantaggi_pf')[this.get('id_nazione')]!='1')
this.data('apply_mod_netto',true);else
this.data('apply_mod_netto',false);this.data('mod_netto_int',1.1);if(isUndefined(this.data('offset_limit'))||this.data('offset_limit')===null){this.data('offset_limit',{});}
this.set('_FR',this.data('FR'));this.set('_IF','');this.set('_P','');this.set('_ritardo',this.data('ritardo'));this.set('_TEMPLATE','');this.set('_TYPE','custom');this.set('altezza_collo','0');this.set('ciclo_produttivo','');this.set('complessita','0');this.set('domidlav','');this.set('file_ok','0');this.set('fogli','');this.set('fogli_copertina','');this.set('formato_fogli','');this.set('formato_fogli_copertina','');this.set('giri','');this.set('id_bestprice','');this.set('id_fornitore','0');this.set('id_prodotto',this.id);this.set('id_categoria',this.data('id_categoria'));this.set('id_proprietario',this.data('id_proprietario'));this.set('id_rel',this.data('id_rel'));this.set('id_reparto',this.data('id_reparto'));this.set('lavorazioni_preventivi',null);this.set('lunghezza_collo','0');this.set('netto_fornitore','');this.set('nome',this.data('nome'));this.set('num_colli','');this.set('offset','0');this.set('p_mq','');this.set('pagamento_anticipato','0');this.set('pannello',this.data('pannello'));this.set('parametri_configuratore','');this.set('parametri_edocbuilder','');this.set('peso',this.data('peso'));this.set('peso_spedizione','');this.set('profondita_collo','0');this.set('promo','');this.set('resa','');this.set('sconto_partner','');this.set('spedizione_partner','');this.set('template_pixart','0');},setInArray:function(){this.in_array=this.data('in_array')['caratteristiche'];var features=this.in_array;for(var f in features){var feature=features[f];this.addDataMethod(feature,this.data('caratteristiche')['c'+feature.id]);var options=feature['opzioni'];for(var o in options){var option=options[o];this.addDataMethod(option,this.data('caratteristiche')['c'+feature['id']]['opzioni']['r'+option['id']]);}}},setIdPromocode:function(id){this.set('id_promocode',id);},setIdRels:function(){var in_array=this.in_array;for(var car in in_array){this.id_rels[in_array[car]['id_rel']]=in_array[car];var opzioni=in_array[car]["opzioni"];for(var opz in opzioni){this.id_rels[opzioni[opz]['id_rel']]=opzioni[opz];}}},setPaths:function(){var in_array=this.in_array;for(var car in in_array){this.paths[car]=in_array[car];var opzioni=in_array[car]["opzioni"];for(var opz in opzioni){this.paths[car+"/"+opz]=opzioni[opz];}}},setFirstOption:function(f){var options=this.getOptionsList(f);var in_array=this.in_array;if(in_array[f]["numero_opzioni"]>0){for(var opz in options){if(this.optionCheck(options[opz])){this.setOption(f,opz);return true;}}}
return false;},setFirstOptions:function(){var features=this.in_array;for(var f in features){var feature=features[f];if(feature['numero_opzioni']>0){this.setFirstOption(f);this.applyIncompatibility();}else
this.val(f,'');}},tag:function(key,value){if(typeof(value)=='undefined')
return this.tags[key];else if(typeof(value)!='function'&&key!='self')
this.tags[key]=value;},set:function(key,value){this.attrs[key]=value;},get:function(key){return this.attrs[key];},getFeaturesName:function(){return Object.keys(this.in_array);},getOptionsName:function(f){if(this.hasOptions(f))
return Object.keys(this.getOptionsList(f));else
return[];},getOptionsList:function(f){if(this.hasOptions(f))
return this.feature(f)['opzioni'];else
return[];},getConfiguration:function(asRels){var in_array=this.in_array;var configuration={};if(isUndefined(asRels)){for(var c in in_array){configuration[c]=this.name(c)||this.val(c);}
configuration['__priority']=this.get('id_priorita');}else{for(var c in in_array){if(this.feature(c).data('hidden')==='0'){var k=''+this.feature(c).id_rel;var v=this.name(c)?this.selected(c).id_rel:this.val(c);configuration[k]=v;}}
configuration['p']=this.get('id_priorita');}
return configuration;},getConfigurationUrl:function(){return document.location.origin+document.location.pathname+'#'+btoa(JSON.stringify(this.getConfiguration()));},setConfigurationByUrl:function(configurationHash){if(isUndefined(configurationHash)){configurationHash=document.location.hash;}
if(configurationHash!=''){try{this.quote();var configurationUrl=configurationHash.substr(1);var configuration={};if(/^(\d+\=[0-9.]+\&?)+(p=\d{1,2})?$/.test(configurationUrl)){configuration=JSON.parse('{"'+decodeURI(configurationUrl.replace(/&/g,"\",\"").replace(/=/g,"\":\""))+'"}');configuration['__priority']=configuration['p'];}else{configuration=JSON.parse(atob(configurationUrl));}
this.eachFeature(function(feature){var f=feature['nome'];var o=configuration[f]||configuration[feature['id_rel']];if(o){if(parseInt(o,10)==o&&isDefined(this.id_rels[o]))
o=this.id_rels[o]['nome'];this.change(f,o,true);}});this.eachFeature(function(feature){var f=feature['nome'];var o=configuration[f]||configuration[feature['id_rel']];if(o){if(parseInt(o,10)==o&&isDefined(this.id_rels[o]))
o=this.id_rels[o]['nome'];if(this.name(f)!=o&&this.val(f)!=o){this.log(_CONFIGURATION_URL,'La configurazione richiesta non è disponibile (coppia "'+f+'"/"'+o+'" non disponibile)');return false;}else{this.log(_CONFIGURATION_URL,'Impostata opzione "'+o+'" per la caratteristica "'+f+'"');}}});if(isDefined(configuration['Numero accessori']))
this.val('Numero accessori',configuration['Numero accessori']);if(isDefined(configuration['__priority']))
this.changePriority(configuration['__priority']);this.data('configurationUrl',configuration);}catch(e){this.log(_CONFIGURATION_URL,'La configurazione richiesta non è disponibile',e.stack);}}},loadedQuote:function(){},quote:function(callback){this.removeData('netti_priorita');this.removeData('netto_base');this.loadedQuote();if(!this.data('netto_base'))
this.data('netto_base',this.net());if(typeof(callback)=='function')
callback();},doQuote:function(doQuote){var t=new Date().getTime();if(typeof(doQuote)=='undefined'||doQuote){this.resetQuotesList(true);this.applyIncompatibility();this.resetFeaturesStatus();this.quotesList();this.quoteDependency();if(!this.featuresCheck()){this.resetQuotesList(false);}}else{this.quote();this.quoteDependency();}
var cl=new Date().getTime();if(this.view)
this.view.refresh();var end=new Date().getTime();this.log(_TIMING,(end-t)+" millisecondi"+"\n- class: "+(cl-t)+"\n- dom: "+(end-cl));},quoteDependency:function(){this.setVendor();this.setWidthHeight();this.setPressCheck();this.checkOffset(this.get('id_priorita'));},summary:function(){var qtyFeatureName=this.data('caratteristica_qta');var qty=this.val(qtyFeatureName);var priorities=this.data('priorita');var priority=this.get('id_priorita');var departureDate=priorities[priority]['data_partenza'];var deliveryDate=priorities[priority]['data_consegna'];var price=this.priceList[(this.data('qta_libera')?'1':qty)][priority];var modifier=keyMinNotZero(price,['net','bestprice','discount','promo']);var originalNet=price[modifier];var insurance=this.insuranceModifier(originalNet);var prepressCheck=this.prepressCheckModifier(originalNet);var net=originalNet+insurance+prepressCheck;var vat=net*pixartParseFloat(this.data('aliquota'))/100;var gross=net+vat;if(this.data('implicitShippingCosts')===true){var S=this.extractShippingCosts(originalNet,this.data('peso'),qty);this.itemCostsBreakdown({costo_base_spedizione:S.costo_spedizione,percentuale_in_piu:S.margine_spedizione*100-100,costo_spedizione:S.netto_spedizione,netto:originalNet});}
return{qty:qty,originalNet:originalNet,insurance:insurance,prepressCheck:prepressCheck,net:net,vat:vat,gross:gross,modifier:modifier,departureDate:departureDate,deliveryDate:deliveryDate}},quotesList:function(){var qtyFeatureName=this.data('caratteristica_qta');var qtyList=this.getOptionsList(qtyFeatureName);var priorities=this.data('priorita');if(this.checkFoldIncompatibilityAvailable()){this.applyFoldIncompatibility();}
if(count(qtyList)==0){this.fillPriceList(qtyFeatureName,priorities,1,this.val(qtyFeatureName),this.val(qtyFeatureName));this.findFirstEnabledPriority();}else{var qtyBackup=this.val(qtyFeatureName);var priorityBackup=this.get('id_priorita');this.disableFeaturesChange();for(var qty in qtyList){this.fillPriceList(qtyFeatureName,priorities,qty,qty,qtyBackup);if(!this.optionCheck(qtyList[qty])){this.resetQtyPriority(qty,priorities);}}
this.feature(qtyFeatureName).selected=null;this.enableFeaturesChange();this.changePriority(priorityBackup);if((this.val(qtyFeatureName)!=qtyBackup&&!this.val(qtyFeatureName,qtyBackup))||!this.optionCheck(this.selected(qtyFeatureName)))
this.setFirstOption(qtyFeatureName);this.findFirstEnabledPriority();this.quote();}},resetQuotesList:function(hardReset){if(isUndefined(hardReset))
hardReset=false;for(var qtyKey in this.priceList){for(var p in this.priceList[qtyKey]){this.resetQtyPriority(qtyKey,p,hardReset);}}},resetQtyPriority:function(qtyKey,p,hardReset){if(typeof(p)=='object'){for(var i in p)
this.resetQtyPriority(qtyKey,i,hardReset);}else{this.priceList[qtyKey][p]['net']=0;this.priceList[qtyKey][p]['promo']='';this.priceList[qtyKey][p]['discount']='';this.priceList[qtyKey][p]['bestprice']='';this.priceList[qtyKey][p]['tooltip']='';if(hardReset||isUndefined(this.priceList[qtyKey][p]['enabled']))
this.priceList[qtyKey][p]['enabled']=this.data('priorita')[p]['abilitata']=='1';}},net:function(p){if(isUndefined(p))
p=this.get('id_priorita');var net=0;if(isDefined(this.data('netti_priorita'))&&isDefined(this.data('netti_priorita')[p])){net=this.data('netti_priorita')[p];var percentage=this.data('priorita')[p]['percentuale']/100;if(this.id==194&&(percentage<1))
net/=percentage;}else
net=this.data('netto');return pixartParseFloat(normalizeNumber(net));},fillPriceList:function(qtyFeatureName,priorities,qtyKey,qty,currentQty){this.val(qtyFeatureName,qty);this.quote();qty=this.val(qtyFeatureName);this.setVendor();var bestprice=this.data('netto_bp')||{};var customerDiscount=this.data('sconto_cliente')||{};if(typeof(this.priceList[qtyKey])=='undefined'){this.priceList[qtyKey]={};}
for(var p in priorities){var net=(this.net(p)+this.oneMoreEuro(this.net(p)))*this.netModifier();var royalty=this.royalty(net);var priority=priorities[p];var priorityFactor=pixartParseFloat(priority['percentuale'])/100;var priorityNet=net*priorityFactor+royalty;this.setPromoByPriority(p);var promo=this.getPromoNet(qty,p,priorityFactor);var promoPriorities=this.getPromoPriorities();if(typeof(this.priceList[qtyKey][p])=='undefined')
this.priceList[qtyKey][p]={};this.checkOffset(p);this.priceList[qtyKey][p]['prioritynet']=priorityNet;this.priceList[qtyKey][p]['net']=priorityNet;this.priceList[qtyKey][p]['promo']=promo&&indexOf(promoPriorities,p)!==-1?promo+royalty:'';this.priceList[qtyKey][p]['discount']=customerDiscount[p]?(priorityNet)*((100-customerDiscount[p])/100):'';this.priceList[qtyKey][p]['bestprice']=bestprice[p]?bestprice[p][qty]:'';this.priceList[qtyKey][p]['enabled']=!this.runsLimit(p)&&this.checkPriority(p)&&(this.priceList[qtyKey][p]['enabled']!==false);if(this.data('implicitShippingCosts')===true){var priceItems=['net','promo','discount','bestprice'];var promocode=this.activePromo();for(var i in priceItems){if(this.priceList[qtyKey][p][priceItems[i]]>0){var S={};var apply_default=true;if(priceItems[i]=="promo"&&promocode!==false){S=this.shippingCosts(priorityNet,this.data('peso'),qty);var sconto_netto_min=promocode['sconto_netto_min'];var sconto_netto_max=promocode['sconto_netto_max'];var priorityNet_check=priorityNet+S.netto_spedizione;var minMaxOk=(priorityNet_check>=sconto_netto_min||!sconto_netto_min||parseInt(sconto_netto_min)===0)&&(priorityNet_check<=sconto_netto_max||!sconto_netto_max||parseInt(sconto_netto_max)===0);if(minMaxOk){switch(promocode['sconto_tipo']){case'valore':if(promocode['sconto_valore']>priorityNet+1){S.netto_spedizione=Math.max(0,(priorityNet+S.netto_spedizione)-promocode['sconto_valore']-1);apply_default=false;}
break;case'percentuale':if(S.applicato_a=='peso'){S.netto_spedizione-=S.netto_spedizione*(pixartParseFloat(promocode['sconto_valore'])/100);apply_default=false;}
break;}}}
if(apply_default){S=this.shippingCosts(this.priceList[qtyKey][p][priceItems[i]],this.data('peso'),qty);}
this.priceList[qtyKey][p][priceItems[i]]+=S.netto_spedizione;}}}}},oneMoreEuro:function(net){this.data('modificatore_euro_in_piu',0);return 0;var oneMoreEuro=0;var categories=['1','7','346'];var countries=['107','79','194','31'];var id_category=this.data('id_categoria').toString();var id_country=this.data('id_nazione').toString();if(!this.data('apply_mod_netto')&&indexOf(categories,id_category)!=-1&&indexOf(countries,id_country)!=-1){if(net<=200)
oneMoreEuro=1;else
oneMoreEuro=2;}
this.data('modificatore_euro_in_piu',oneMoreEuro);return oneMoreEuro;},netModifier:function(){var netModifier=1
if(this.data('no_spedizione')!="1"&&this.data('apply_mod_netto'))
netModifier=pixartParseFloat(this.data('mod_netto_int'));this.set('perc_netto_spedizione',netModifier);return netModifier;},insuranceModifier:function(net,skip){if(net<8){this.set('assicurazione',0);}else if(this.get('assicurazione')=='1'||skip===true){if(net<=80)
return 8;else
return Math.ceil(net/10);}
return 0;},prepressCheckModifier:function(net){return(net>0&&this.get('verifica_prestampa')=="Da verificare"?pixartParseFloat(this.data('verifica_prestampa')):0);},vendorNet:function(){var country=this.get('id_nazione');var p=this.get('id_priorita');var qty=this.get('_QTA');var externalNet=this.externalNet();var priority=this.data('priorita')[p];var vendorNet='';if(this.isBestPrice()&&isUndefined(this.data('nazioni_intrastat')[country])&&isDefined(this.data('netto_bp_forn'))&&isDefined(this.data('netto_bp_forn')[p])&&isDefined(this.data('netto_bp_forn')[p][qty])){vendorNet=this.data('netto_bp_forn')[p][qty];}else if(isDefined(externalNet)&&isDefined(externalNet[p])){var no_priority_perc={194:1,683:1,684:1,647:1,535:1,563:1,562:1,578:1,533:1,579:1,534:1,551:1,653:1,655:1,656:1,638:1,639:1,706:1,707:1,620:1,619:1,688:1,687:1,689:1,621:1,622:1,640:1,712:1,651:1,658:1,664:1,657:1,665:1,472:1,645:1,643:1,644:1,487:1,486:1,506:1,519:1,696:1,705:1,446:1,452:1,449:1,559:1,556:1,560:1,715:1,716:1,717:1,445:1,541:1,543:1,558:1,564:1,566:1,567:1,568:1,569:1,571:1,652:1,713:1,714:1,721:1,540:1,539:1,490:1,458:1,459:1,460:1,461:1,462:1,463:1,464:1,465:1,466:1,467:1,468:1,469:1,470:1,727:1,732:1,743:1,744:1,745:1,746:1};if(no_priority_perc[this.id]==1)
vendorNet=externalNet[p]*1;else
vendorNet=externalNet[p]*(priority["percentuale"]/100);if(externalNet['mod_netto_esterno'])
vendorNet*=externalNet['mod_netto_esterno'];}else if(count(this.data('percentuale_netto_fornitore'))&&this.data('percentuale_netto_fornitore')[p]){vendorNet=0;if(count(this.data('percentuale_netto_fornitore'))==1){if(this.data('netto_con_lav'))
vendorNet=this.data('netto_con_lav')*this.data('percentuale_netto_fornitore')[0];else
vendorNet=pixartParseFloat(this.priceList[qty][p]["net"])*this.data('percentuale_netto_fornitore')[0];}else{if(this.data('netto_con_lav'))
vendorNet=this.data('netto_con_lav')*this.data('percentuale_netto_fornitore')[p];else
vendorNet=pixartParseFloat(this.priceList[qty][p]["net"])*this.data('percentuale_netto_fornitore')[p];}}
this.set('netto_fornitore',vendorNet===''?'':vendorNet.toFixed(2));},addExternalNet:function(p,net,qty,modifier){var externalNet={}
externalNet[p]=net;if(isDefined(modifier))
externalNet['mod_netto_esterno']=modifier;if(isDefined(qty))
this.data('netti_esterno_'+qty,externalNet);else
this.data('netti_esterno',externalNet);},externalNet:function(){var qty=this.get('_QTA');var externalNet=this.data('qta_libera')?this.data('netti_esterno'):this.data('netti_esterno_'+qty);return externalNet;},quoteVariation:function(summary){var priority=this.get('percentuale_priorita')/100;var id_priority=this.get('id_priorita');var discount=0;var customerDiscount=this.data('sconto_cliente');if(summary["modifier"]=="discount"&&isDefined(customerDiscount[summary["qty"]]))
discount=customerDiscount[summary["qty"]];var net=this.net();var baseNet=net;var cost=0;if(this.get('lavorazioni_preventivi')!=null&&this.get('lavorazioni_preventivi')!='')
{var processingQuote=(this.get('lavorazioni_preventivi'));if(discount==0)
discount=1;baseNet=(processingQuote["netto"]).toFixed(2)
cost=processingQuote["costo_spedizione"]*priority*discount;}
else
{if(net!=this.data('netto_base'))
baseNet=this.data('netto_base');discount=(100-discount)/100;}
var priorityNet=(baseNet*priority*discount).toFixed(2);cost=(summary["originalNet"]-priorityNet).toFixed(2);if(cost>0)
{this.set("lavorazioni_variazioni",JSON.stringify({netto_base:baseNet,netto_priorita:priorityNet,costo:cost}));}},resetItemCostsBreakdown:function(){this.get('lavorazioni_preventivi',null);},itemCostsBreakdown:function(key,value){var costs=this.get('lavorazioni_preventivi')||{};if(typeof(costs)!=='object')
costs={};if(typeof(key)==='object'&&isUndefined(value)){for(var i in key){costs[i]=key[i];}}else if(typeof(key)==='string'&&isDefined(value)){costs[key]=value;}
this.set('lavorazioni_preventivi',costs);},normalizeProcessingQuote:function(){if(this.get('lavorazioni_preventivi')!=null&&this.get('lavorazioni_preventivi')!='')
{var processingQuote=(this.get('lavorazioni_preventivi'));var priority=this.get('percentuale_priorita')/100;var keys=['costo_spedizione','netto','netto_con_lav','netto_senza_lav'];if(this.data('implicitShippingCosts')!==true)
for(var i in keys)
processingQuote[keys[i]]*=priority;this.set('lavorazioni_preventivi',JSON.stringify(processingQuote));}
else
{this.set('lavorazioni_preventivi','');}},netIntrastat:function(formato,fogli){this.log(_INTRASTAT,'netIntrastat',formato,fogli);var qta=this.val(this.data('caratteristica_qta'));var grammatura=parseInt(this.name('Grammatura').substring(0,3),10)/1000;var carta_val=this.val('Carta');var base=0;var altezza=0;if(formato=='Formato Contenitore')
{base=this.selected('Formato Contenitore').data('base');altezza=this.selected('Formato Contenitore').data('larghezza');}
else
{base=this.width(formato);altezza=this.height(formato);}
formato=this.name(formato);if(grammatura==0.1)grammatura=0.11;this.data('apply_mod_netto',false);var ammortamento=500;var costo_spedizione=0;var peso_effettivo=0;var percentuale_in_piu=0;var netto_senza_lav=0;var prezzo_carta=0.9;var costo_base_spedizione=8;var netto_con_lav=0;var netto=0;var stampesufoglio=0;var naz_new_alg={"72":"1","167":"1","79":"1","31":"1","194":"1","107":"1","74":"1"};var apply_new_alg=false;if(naz_new_alg[this.get('id_nazione')]=="1")
apply_new_alg=true;if(formato=='5,5 cm x 5,5 cm'){stampesufoglio=90}
else if(formato=='9 cm x 5 cm'){stampesufoglio=90;}
else if(formato=='8,5 cm x 5,5 cm'){stampesufoglio=90;}
else if(formato=='8,5 cm x 5 cm'){stampesufoglio=90;}
else if(formato=='10 cm x 15 cm'){stampesufoglio=32;}
else if(formato=='10,5 cm x 14,8 cm (DIN A6)'){stampesufoglio=32;}
else if(formato=='10 cm x 21 cm'){stampesufoglio=24;}
else if(formato=='14,8 x 14,8 cm'){stampesufoglio=16;}
else if(formato=='14,8 cm x 21 cm (DIN A5)'){stampesufoglio=16;}
else if(formato=='15 cm x 21 cm'){stampesufoglio=16;}
else if(formato=='17 cm x 24 cm'){stampesufoglio=8;}
else if(formato=='21 cm x 29,7 cm (DIN A4)'){stampesufoglio=8;}
else if(formato=='29,7 cm x 42 cm (DIN A3)'){stampesufoglio=4;}
else if(formato=='41 cm x 15 cm'){stampesufoglio=8;}
else if(formato=='41 cm x 29,7 cm'){stampesufoglio=4;}
else if(formato=='31 cm x 43 cm'){stampesufoglio=2;}
else if(formato=='31 cm x 43 cm foglio macchina'){stampesufoglio=2;}
else if(formato=='36 cm x 51 cm'){stampesufoglio=2;}
else if(formato=='41 cm x 41 cm'){stampesufoglio=2;}
else if(formato=='42 cm x 52,5 cm'){stampesufoglio=2;}
else if(formato=='42 cm x 15 cm'){stampesufoglio=8;}
else if(formato=='42 cm x 59,4 cm (DIN A2)'){stampesufoglio=2;}
else if(formato=='41 cm x 59,4 cm'){stampesufoglio=2;}
else if(formato=='41 cm x 52,5 cm'){stampesufoglio=2;}
else if(formato=='9,8 cm x 9,8 cm'){stampesufoglio=40;}
else if(formato=='14,8 cm x 14,8 cm'){stampesufoglio=15;}
else if(formato=='14,8 cm x 29,6 cm'){stampesufoglio=6;}
else if(formato=='14,8 cm x 44,4 cm'){stampesufoglio=4;}
else if(formato=='14,8 cm x 44,1 cm'){stampesufoglio=4;}
else if(formato=='21 cm x 9,8 cm'){stampesufoglio=15;}
else if(formato=='21 cm x 21 cm'){stampesufoglio=6;}
else if(formato=='21 cm x 42 cm'){stampesufoglio=3;}
else if(formato=='21 cm x 63 cm'){stampesufoglio=2;}
else if(formato=='21 cm x 62,7 cm'){stampesufoglio=2;}
else if(formato=='9,8 cm x 21 cm'){stampesufoglio=15;}
else if(formato=='21 cm x 19,6 cm'){stampesufoglio=6;}
else if(formato=='21 cm x 29,4 cm'){stampesufoglio=4;}
else if(formato=='21 cm x 29,1 cm'){stampesufoglio=4;}
else if(formato=='29,7 cm x 21 cm'){stampesufoglio=4;}
else if(formato=='29,7 cm x 42 cm'){stampesufoglio=4;}
else if(formato=='29,7 cm x 63 cm'){stampesufoglio=1;}
else if(formato=='29,7 cm x 62,7 cm'){stampesufoglio=1;}
else if(formato=='29,7 cm x 10,5 cm'){stampesufoglio=10;}
else if(formato=='29,7 cm x 31,5 cm'){stampesufoglio=2;}
else if(formato=='29,7 cm x 31,2 cm'){stampesufoglio=2;}
else if(formato=='8,89 cm x 5,08 cm (US 3,5x2)'){stampesufoglio=90;}
else if(formato=='10.69 cm x 13,89 cm (US)'){stampesufoglio=28;}
else if(formato=='10,16 cm x 15,24 cm (US)'){stampesufoglio=32;}
else if(formato=='12,70 cm x 17,78 cm (US)'){stampesufoglio=16;}
else if(formato=='13,9 cm x 21,6 cm (US half page)'){stampesufoglio=15;}
else if(formato=='15,24 cm x 27,94 cm (US)'){stampesufoglio=9;}
else if(formato=='21,59 cm x 30,43 cm (US full page)'){stampesufoglio=6;}
else if(formato=='9,50 cm x 21,01 cm (US long page)'){stampesufoglio=24;}
else if(formato=='21,59 cm x 55,88 cm (US size)'){stampesufoglio=4;}
else if(formato=='14 cm x 21,6 cm (US)'){stampesufoglio=15;}
else if(formato=='27,94 cm x 43,18 cm (US ANSI B)'){stampesufoglio=4;}
else if(formato=='45,72 cm x 60,96 (US ARCH C)'){stampesufoglio=1.5;}
else if(formato=='15,24 cm x 22,86 cm (US)'){stampesufoglio=10;}
else if(formato=='22,86 cm x 30,48 cm (US ARCH A)'){stampesufoglio=6;}
else if(formato=='21,59 cm x 27,94 cm (US Letter)'){stampesufoglio=6;}
else if(formato=='13,97 cm x 21,59 cm (US memo)'){stampesufoglio=13;}
else if(formato=='30,48 cm x 30,48 cm (US size)'){stampesufoglio=4;}
else if(formato=='10,16 cm x 22,86 cm (US)'){stampesufoglio=22;}
else if(formato=='10,80 cm x 13,97 cm (US)'){stampesufoglio=26;}
else if(formato=='15,24 cm x 15,24 cm (US)'){stampesufoglio=15;}
var mol_amm=0.04;if((qta/stampesufoglio)<ammortamento){ammortamento=(qta/stampesufoglio)*mol_amm;}else{ammortamento=ammortamento*mol_amm;}
var mod_prezzo_carta=0;if(grammatura>=0.25&&grammatura<0.30){mod_prezzo_carta=0.05;}
if(grammatura>=0.30&&grammatura<0.35){mod_prezzo_carta=0.07;}
if(grammatura>=0.35){mod_prezzo_carta=0.10;}
prezzo_carta=prezzo_carta+mod_prezzo_carta;if(carta_val!='#122'&&carta_val!='#123'&&carta_val!='#298'&&carta_val!='#9231'&&carta_val!='#9232'){prezzo_carta=prezzo_carta+3.1;}
if(this.get('id_nazione')=='12'||this.get('id_nazione')=='25'){if(qta<=1000){percentuale_in_piu=20;}else if(qta==2500||qta>30000){percentuale_in_piu=10;}else{percentuale_in_piu=0;}}else{costo_base_spedizione=10;if(this.get('id_nazione')=='194')costo_base_spedizione=17;if(qta<=5000){percentuale_in_piu=50;}else{percentuale_in_piu=40;}
if(apply_new_alg){if(qta<5000){percentuale_in_piu=40;}else{percentuale_in_piu=20;}}}
peso_effettivo=(((base*altezza)/10000)*qta)*grammatura;costo_spedizione=(Math.ceil(peso_effettivo/20))*costo_base_spedizione;var costo_extra_10kg=5;if(this.get('id_nazione')=='194')costo_extra_10kg=8.5;if(apply_new_alg){if(peso_effettivo>10){var mol=Math.ceil(peso_effettivo/10)-1;costo_base_spedizione+=mol*costo_extra_10kg;}
costo_spedizione=costo_base_spedizione;}
var netto_pose=0;var netto_plast=0;var netto_piega=0;if(this.feature('Pose multiple rifilate in formato')){netto_pose=this.price('Pose multiple rifilate in formato',qta);}
if(this.feature('Plastificazione')){netto_plast=this.price('Plastificazione',fogli);}
if(this.feature('Piegatura')){var formato_b=this.selected('Formato').data('base');var formato_h=this.selected('Formato').data('larghezza');if(this.name('Piegatura')!='--------------'){netto_piega=(0.01*qta)+(this.startPrice('Piegatura'));if(this.data('user_test')===true){netto_piega=(this.price('Piegatura')*qta)+(this.startPrice('Piegatura'));}}
netto_piega/=((100+percentuale_in_piu)/100);}
var avviamento=20/stampesufoglio;if(apply_new_alg){avviamento=7;if(stampesufoglio<=4){avviamento+=5;}
if(stampesufoglio===90){avviamento=3;}}
if(this.data('enable-promo')&&this.selected('Carta').data('id_promocode')&&this.get('id_promocode')!=''){var promocode=this.activePromo();var prezzo_carta_in_promo=prezzo_carta*(1-(parseFloat(promocode['sconto_valore'])/100));var sconto_da_applicare=(prezzo_carta-prezzo_carta_in_promo)*(((0.5481*grammatura)/stampesufoglio)*qta)*(100+percentuale_in_piu)/100;this.data('discount-to-be-applied',sconto_da_applicare);}
netto_senza_lav=avviamento
+((((0.5481*grammatura)/stampesufoglio)*qta)*prezzo_carta)
+ammortamento;netto_con_lav=netto_senza_lav
+netto_pose
+netto_plast
+netto_piega;netto_con_lav*=(100+percentuale_in_piu)/100;if(!apply_new_alg){costo_spedizione*=(100+percentuale_in_piu)/100;}
var prod_formati_sconvenienti={"346":"Biglietti da visita","780":"US_Business Cards"};if(isDefined(prod_formati_sconvenienti[this.id])){var margine_formati_sconvenienti=((this.profitMargin('Formato')<1?1:this.profitMargin('Formato'))-1)*(netto_con_lav+costo_spedizione);netto_con_lav+=margine_formati_sconvenienti}
netto_con_lav*=1.02;costo_spedizione*=1.02;var prod_con_marginalita={"347":"Formato"};if(isDefined(prod_con_marginalita[this.id])){netto_con_lav*=this.fixMargin(this.profitMargin(prod_con_marginalita[this.id],qta));costo_spedizione*=this.fixMargin(this.profitMargin(prod_con_marginalita[this.id],qta));}
netto=netto_con_lav+costo_spedizione;var out={};this.data('netto_con_lav',netto_con_lav);this.set('lavorazioni_preventivi',({ammortamento:ammortamento,prezzo_carta:prezzo_carta,costo_base_spedizione:costo_base_spedizione,percentuale_in_piu:percentuale_in_piu,peso_effettivo:peso_effettivo,costo_spedizione:costo_spedizione,netto_senza_lav:netto_senza_lav,netto_con_lav:netto_con_lav,netto:netto}));out["netto"]=netto;out["stampesufoglio"]=stampesufoglio;return out;},fixMargin:function(margin){if(margin==0)
return 1;return margin;},shippingCosts:function(netto,peso,qta){var S={};S.margine_spedizione=1;if(this.feature('Margine spedizione')){S.margine_spedizione=this.fixMargin(this.profitMargin('Margine spedizione',qta));this.val('Margine spedizione',S.margine_spedizione);}
S.percentuale_corriere=this.percentuale_corriere_default;S.percentuale_corriere_con_margine=S.percentuale_corriere*S.margine_spedizione;switch(this.get('id_nazione')+""){case'107':S.applicato_a="netto";S.netto_spedizione=S.percentuale_corriere_con_margine*netto/(100-S.percentuale_corriere_con_margine);S.costo_spedizione=S.netto_spedizione/S.margine_spedizione;break;case'194':S.applicato_a="peso";S.costo_spedizione=((Math.ceil(peso/10)-1)*8.5)+17;S.netto_spedizione=S.costo_spedizione*S.margine_spedizione;break;default:S.applicato_a="peso";S.costo_spedizione=((Math.ceil(peso/10)-1)*6)+10;S.netto_spedizione=S.costo_spedizione*S.margine_spedizione;break;}
return S;},extractShippingCosts:function(netto_con_spedizione,peso,qta){var S={};S.margine_spedizione=1;if(this.feature('Margine spedizione')){S.margine_spedizione=this.fixMargin(this.profitMargin('Margine spedizione',qta));this.val('Margine spedizione',S.margine_spedizione);}
S.percentuale_corriere=this.percentuale_corriere_default;S.percentuale_corriere_con_margine=S.percentuale_corriere*S.margine_spedizione;var netto=netto_con_spedizione*(100-S.percentuale_corriere_con_margine)/100;return this.shippingCosts(netto,peso,qta);},magazinesNet:function(array_carte_spessore_fogli){this.data('apply_mod_netto',false);var M={};M.rese={'A5 (15 cm x 21 cm)':8,'A5 (21 cm x 15 cm orizzontale)':8,'A4 (21 cm x 30 cm)':4,'A4 (21 cm x 30 cm orizzontale)':4,'42 cm x 15 cm':4,'A3 (30 cm x 42 cm)':2,'29,7 cm x 42 cm (DIN A3)':2,'10 cm x 15 cm':16,'10 cm x 21 cm':12,'16.5cm x 24cm':4,'16.5cm x 24cm orizzontale':4,'21 cm x 21 cm':4,'15,24 cm x 15,24 cm (US)':8,'15,24 cm x 22,86 cm (US)':8,'20,32 cm x 20,32 cm (US)':4,'22,86 cm x 30,48 cm (US ARCH A)':2,'21,59 cm x 27,94 cm (US Letter)':4,'13,97 cm x 21,59 cm (US memo)':8,'30,48 cm x 30,48 cm (US size)':2,'10,5 cm x 14,8 cm (DIN A6)':16};M.superficie_foglio=0.288;function _costo_carta_al_kg(carta,grammatura){var costo_carta_al_kg=0.8;var moltiplicatore=1.15;switch(carta){case"Classic demimatt (Patinata opaca)":case"Classic gloss (Patinata lucida)":case"Classic gloss (Patinata lucida) 250gr plastificata":case"Classic gloss (Patinata lucida) 300gr plastificata":case"Classic demimatt (Patinata opaca) 250gr plastificata":case"Classic demimatt (Patinata opaca) 300gr plastificata":case"US Gloss":case"US Silk":if(grammatura>=250&&grammatura<300){costo_carta_al_kg+=0.025;}else if(grammatura>=300&&grammatura<350){costo_carta_al_kg+=0.050;}else{costo_carta_al_kg+=0.075;}
if(grammatura==0.130){costo_carta_al_kg=0.8;moltiplicatore=1;}
break;case"Avorio (Symbol Ivory)":costo_carta_al_kg=1.91;break;case"Extraprint (Biancoflash) ex Splendorgel":case"US Uncoated":costo_carta_al_kg=1.9;break;case"Rembrandt (Twill) ex Acquerello":costo_carta_al_kg=1.95;break;case"Turner (Prisma) ex Tintoretto":costo_carta_al_kg=1.95;break;case"Underwood (Woodstock betulla)":costo_carta_al_kg=2.3;break;case"Ice white (Constellation)":costo_carta_al_kg=4.7;break;case"Laguna (Shiro)":case"US Recycled":costo_carta_al_kg=1.5;break;}
return costo_carta_al_kg*moltiplicatore;}
M.grammatura_copertina=0;M.plastificazione_copertina=0;M.carta_copertina=0;M.id_carta_copertina=0;M.facciate_preventivo=this.val('Facciate');M.numero_copie=this.val('Numero di copie');M.bianco_e_nero_interno=this.name('Bianco e nero')==='Si';M.bianco_e_nero_copertina=this.name('Copertina in bianco e nero')==='Si';M.divisore_solo_fronte=this.name('Solo fronte')==='Si'?1:2;M.grammatura_interno=this.name('Grammatura').substring(0,3)/1000;M.plastificazione_interno=this.name('Plastificazione')==='Tutto'?1:0;M.carta_interno=this.name('Carta');M.id_carta_interno=this.val('Carta');M.car_formato=(this.feature('Formato Contenitore'))?'Formato Contenitore':'Formato';M.formato=this.name(M.car_formato);if(this.name('Grammatura Copertina'))
M.grammatura_copertina=this.name('Grammatura Copertina')==='No'?M.grammatura_interno:this.name('Grammatura Copertina').substring(0,3)/1000;if(this.name('Plastificazione copertina')){M.plastificazione_copertina=this.name('Plastificazione copertina')==='Fronte e retro'?1:this.name('Plastificazione copertina')=='Solo fronte'?0.5:0;}else if(this.name('Plastificazione')==='Solo copertina'){M.plastificazione_copertina=0.5;}
if(this.name('Copertina'))
M.carta_copertina=this.name('Copertina')==='Stessa grammatura interno'?M.carta_interno:this.name('Copertina');if(this.name('Copertina'))
M.id_carta_copertina=this.val('Copertina')==='Stessa grammatura interno'?M.id_carta_interno:this.val('Copertina');M.resa=M.rese[M.formato];M.click_interno=M.bianco_e_nero_interno?1:3;M.click_copertina=M.bianco_e_nero_copertina?1:3;M.scarto_click_interno=M.bianco_e_nero_interno?1.5:1;M.scarto_click_copertina=M.bianco_e_nero_copertina?1.5:1;M.numero_copie_avviamento=1.05;if(this.name('Copertina'))
M.facciate_copertina=4;else
M.facciate_copertina=0;M.facciate_interno=M.facciate_preventivo-M.facciate_copertina;if(M.bianco_e_nero_interno===M.bianco_e_nero_copertina&&M.grammatura_interno===M.grammatura_copertina&&M.plastificazione_interno===M.plastificazione_copertina&&M.carta_interno===M.carta_copertina){M.facciate_interno=M.facciate_preventivo;M.facciate_copertina=0;}
M.fogli_interno_a_copia=M.facciate_interno/M.divisore_solo_fronte;M.fogli_copertina_a_copia=M.facciate_copertina/M.divisore_solo_fronte;M.spessore_pagine_interno=0;M.spessore_pagine_copertina=0;if(isDefined(array_carte_spessore_fogli)){if(isDefined(array_carte_spessore_fogli[M.id_carta_interno])&&isDefined(array_carte_spessore_fogli[M.id_carta_interno][M.grammatura_interno])){M.spessore_pagine_interno=M.fogli_interno_a_copia*array_carte_spessore_fogli[M.id_carta_interno][M.grammatura_interno];}
if(isDefined(array_carte_spessore_fogli[M.id_carta_copertina])&&isDefined(array_carte_spessore_fogli[M.id_carta_copertina][M.grammatura_copertina])){M.spessore_pagine_copertina=M.fogli_copertina_a_copia*array_carte_spessore_fogli[M.id_carta_copertina][M.grammatura_copertina];}}
M.facciate_foglio_macchina_interno=Math.ceil((M.numero_copie*M.numero_copie_avviamento)*M.facciate_interno/M.resa);M.fogli_macchina_interno=Math.ceil(M.facciate_foglio_macchina_interno/M.divisore_solo_fronte);M.facciate_foglio_macchina_copertina=Math.ceil((M.numero_copie*M.numero_copie_avviamento)*M.facciate_copertina/M.resa);M.fogli_macchina_copertina=Math.ceil(M.facciate_foglio_macchina_copertina/M.divisore_solo_fronte);M.peso_carta_interno=M.fogli_macchina_interno*M.superficie_foglio*M.grammatura_interno;M.peso_carta_copertina=M.fogli_macchina_copertina*M.superficie_foglio*M.grammatura_copertina;M.peso_totale=M.peso_carta_interno+M.peso_carta_copertina;M.costo_hr=3120;M.quantita_hr=17;M.costo_hr_indiretto=28600;M.costo_hr_totale=M.costo_hr*M.quantita_hr+M.costo_hr_indiretto;M.quantita_macchine=4;M.costo_noleggio_macchine=21400;M.costo_energia_macchine=3000;M.costo_noleggio_ultra=9000;M.costo_energia_ultra=1500;M.costo_macchine_totale=M.costo_noleggio_macchine*M.quantita_macchine+M.costo_energia_macchine*M.quantita_macchine+M.costo_noleggio_ultra+M.costo_energia_ultra;M.costo_struttura_diretti=3000;M.costo_struttura_indiretti=30662;M.costo_leasing_ammortamenti=46000;M.costo_struttura_totale=M.costo_struttura_diretti+M.costo_struttura_indiretti+M.costo_leasing_ammortamenti;M.obiettivo=6000000;M.costo_click=0.011;M.obiettivo_totale=M.obiettivo*M.quantita_macchine;M.costo_click_totale=((M.costo_hr_totale+M.costo_macchine_totale+M.costo_struttura_totale)/M.obiettivo_totale)+M.costo_click;M.numero_click_interno=M.facciate_foglio_macchina_interno*M.click_interno;M.numero_click_copertina=M.facciate_foglio_macchina_copertina*M.click_copertina;M.numero_click_totale=M.numero_click_interno+M.numero_click_copertina;M.costo_click_interno=M.numero_click_interno*M.costo_click_totale*M.scarto_click_interno;M.costo_click_copertina=M.numero_click_copertina*M.costo_click_totale*M.scarto_click_copertina;M.costo_click=M.costo_click_interno+M.costo_click_copertina;M.costo_avviamento_rilegatura=0;M.costo_rilegatura_a_copia=0;switch(this.name('Rilegatura')){case'Spirale per calendari':case'Spirale metallica':M.costo_avviamento_rilegatura=20;M.costo_rilegatura_a_copia=0.2;break;case'Brossura grecata e fresata':M.costo_avviamento_rilegatura=10;M.costo_rilegatura_a_copia=0.42;break;case'Punto metallico':M.costo_avviamento_rilegatura=10;M.costo_rilegatura_a_copia=0.15;break;}
M.costo_rilegatura=M.costo_avviamento_rilegatura+M.costo_rilegatura_a_copia*M.numero_copie;M.costo_plastificazione_unitario=0.06;M.costo_avviamento_plastificazione=0;switch(this.name('Finitura')){case'Soft Touch':case'Anti Scratch':M.costo_plastificazione_unitario=0.16;M.costo_avviamento_plastificazione=25;break;}
M.costo_plastificazione_interno=M.facciate_foglio_macchina_interno*M.costo_plastificazione_unitario*M.plastificazione_interno;M.costo_plastificazione_copertina=M.facciate_foglio_macchina_copertina*M.costo_plastificazione_unitario*M.plastificazione_copertina;M.costo_plastificazione=M.costo_plastificazione_interno+M.costo_plastificazione_copertina+M.costo_avviamento_plastificazione;M.costo_taglio_unitario=0.004;M.costo_taglio=(M.facciate_foglio_macchina_interno+M.facciate_foglio_macchina_copertina)*M.costo_taglio_unitario;M.costo_inscatolamento_unitario=0.0067;M.costo_inscatolamento=M.numero_copie*M.costo_inscatolamento_unitario;M.scarto_copertina_brossura=1;if(this.name('Rilegatura')=='Brossura grecata e fresata'&&(M.spessore_pagine_interno+M.spessore_pagine_copertina)>10)
M.scarto_copertina_brossura=1.23;M.costo_carta_al_kg_interno=_costo_carta_al_kg(M.carta_interno,M.grammatura_interno);M.costo_carta_al_kg_copertina=_costo_carta_al_kg(M.carta_copertina,M.grammatura_copertina);M.costo_carta_interno=M.costo_carta_al_kg_interno*M.peso_carta_interno;M.costo_carta_copertina=M.costo_carta_al_kg_copertina*M.peso_carta_copertina*M.scarto_copertina_brossura;M.costo_carta=M.costo_carta_interno+M.costo_carta_copertina;M.costo_formato_personalizzato=0;if(this.name("Formato")=="Formato personalizzato"){M.costo_formato_personalizzato=this.startPrice("Formato");}
M.costo_produzione=M.costo_carta+
M.costo_click+
M.costo_plastificazione+
M.costo_rilegatura+
M.costo_taglio+
M.costo_inscatolamento;M.margine_netto=1;if(this.feature('Margine click')){M.margine_netto=this.fixMargin(this.profitMargin('Margine click',M.numero_click_totale));this.val('Margine click',M.margine_netto);}
M.margine_aggiuntivo=1.065;M.netto_con_margine=M.costo_produzione*M.margine_netto*M.margine_aggiuntivo;M.netto_con_margine+=M.costo_formato_personalizzato;M.margine_formato_personalizzato=1;if(this.name("Formato")=="Formato personalizzato"){M.margine_formato_personalizzato=this.fixMargin(this.profitMargin("Formato",M.numero_copie));M.netto_con_margine*=M.margine_formato_personalizzato;}
var special_cases={'189':[{'configuration':{'Bianco e nero':"No",'Carta':"Classic demimatt (Patinata opaca)",'Copertina':"Classic demimatt (Patinata opaca) 250gr plastificata",'Copertina in bianco e nero':"No",'Facciate':68,'Finitura':"Opaca",'Formato':"A4 (21 cm x 30 cm)",'Grammatura':"130gr",'Grammatura Copertina':"250gr",'Indicazioni di stampa':"Con copertina",'Numero di copie':100,'Plastificazione':"Solo copertina",'Plastificazione copertina':"Solo fronte",},'net':252.20925589999996}],'194':[{'configuration':{'Bianco e nero':"No",'Carta':"Classic demimatt (Patinata opaca)",'Copertina':"Classic demimatt (Patinata opaca) 250gr plastificata",'Copertina in bianco e nero':"No",'Facciate':68,'Finitura':"Opaca",'Formato':"A4 (21 cm x 30 cm)",'Grammatura':"130gr",'Grammatura Copertina':"250gr",'Indicazioni di stampa':"Con copertina sempre separati",'Numero di copie':100,'Plastificazione':"Solo copertina",},'net':287.7832559}],'193':[{'configuration':{'Bianco e nero':"No",'Carta':"Classic demimatt (Patinata opaca)",'Copertina':"Classic demimatt (Patinata opaca) 250gr plastificata",'Copertina in bianco e nero':"No",'Facciate':68,'Finitura':"Opaca",'Formato':"A4 (21 cm x 30 cm)",'Grammatura':"130gr",'Grammatura Copertina':"250gr",'Indicazioni di stampa':"Con copertina",'Numero di copie':100,'Plastificazione':"Solo copertina",'Plastificazione copertina':"Solo fronte",'Solo fronte':"No"},'net':273.20925589999996}]}
var formato_val="";for(var special_case in special_cases){for(var configuration in special_cases[special_case]){formato_val=special_cases[special_case][configuration]['configuration']['Formato'];delete(special_cases[special_case][configuration]['configuration']['Formato']);special_cases[special_case][configuration]['configuration'][M.car_formato]=formato_val;}}
if(isDefined(special_cases[this.id])){var alternative_net=function(cases,configuration){for(var i in cases){var configuration_to_match=cases[i].configuration;var match=true;for(var j in configuration_to_match){if(configuration_to_match[j]!=configuration[j]){match=false;}}
if(match){return cases[i].net;}}
return 0;}(special_cases[this.id],this.getConfiguration());if(alternative_net!=0){M.netto_con_margine=alternative_net;}}
M.netto=M.netto_con_margine;M.passate=M.facciate_foglio_macchina_interno+M.facciate_foglio_macchina_copertina;M.giri=M.numero_click_totale;M.peso=M.peso_totale;this.magazineCostsBreakdown(M);this.data('magazinesNet',M);return M;},magazineCostsBreakdown:function(M){this.itemCostsBreakdown({ammortamento:((M.costo_macchine_totale+M.costo_struttura_totale)/M.obiettivo_totale)*(M.numero_click_interno+M.numero_click_copertina),prezzo_carta:M.costo_carta,peso_effettivo:M.peso_totale,netto_senza_lav:M.costo_carta+M.costo_click,netto_con_lav:M.costo_produzione});},isBestPrice:function(){return this.data('bestprice')!=null;},netBestPrice:function(passate,passa_in_offset,stampesufoglio_offset,fogli,costo_formato_personalizzato,costo_aggiuntivo_piega){this.log(_BESTPRICE,'netBestPrice',passate,passa_in_offset,stampesufoglio_offset,fogli,costo_formato_personalizzato,costo_aggiuntivo_piega);var qta=this.val(this.data('caratteristica_qta'));var carta_val=this.val('Carta');var formato=this.name('Formato');if(typeof(costo_formato_personalizzato)=="undefined")
costo_formato_personalizzato=0;if(typeof(costo_aggiuntivo_piega)=="undefined")
costo_aggiuntivo_piega=0;var gr=this.name('Grammatura');var grammature_bp=this.data('bestprice')['grammatura'];var carte_bp=this.data('bestprice')['carta'];var carta_val_cf=(carta_val.replace('#',''));var netto_bp,nettobp;var netto_bp_forn,nettobp_forn;if(hasKey(carte_bp,carta_val_cf)){var calcolo_bp=false;if(count(grammature_bp[this.name('Grammatura')])>0){calcolo_bp=true;}else{this.removeData('netto_bp');}
if(gr!="100gr"){var gr_m=(parseFloat(gr.replace('gr',''))/1000);grammature_bp={"costo_carta":0.875,"real_gr":gr_m};}else{grammature_bp={"costo_carta":0.82,"real_gr":0.11};}
var mod_bp_72=1.20;if(qta>1000)mod_bp_72=1.15;if(calcolo_bp){var i_valid_ids=this.data('bestprice')['id_priorita'];}
var bestprice;var bp_costo_avv=80/stampesufoglio_offset;var amm_macchina=0;var costo_struttura=0;var costo_aggiuntivo=1;var qta_progressivo=0;var ricavo=1;var piega_bestprice=0;if(stampesufoglio_offset==2){qta_progressivo=250;}else{qta_progressivo=10000;}
if(stampesufoglio_offset>=16)bp_costo_avv=20;if(stampesufoglio_offset==8)bp_costo_avv=30;if(stampesufoglio_offset==4)bp_costo_avv=40;if(stampesufoglio_offset==2)bp_costo_avv=50;if(stampesufoglio_offset<=32&&qta>qta_progressivo)costo_aggiuntivo=1.15;amm_macchina=0.0137*(qta/stampesufoglio_offset);costo_struttura=0.01654*(qta/stampesufoglio_offset);bestprice=((((0.288*(qta/stampesufoglio_offset))*grammature_bp['real_gr'])*grammature_bp['costo_carta']
+amm_macchina
+costo_struttura)*costo_aggiuntivo)*ricavo
+bp_costo_avv;if(this.feature('Pose multiple rifilate in formato'))
bestprice+=this.price('Pose multiple rifilate in formato',qta);if(this.feature('Piegatura')&&this.price('Piegatura',qta)>0){piega_bestprice=(0.004*fogli)+(this.startPrice('Piegatura')*0.5);}
var piega_plastificazione=this.price('Plastificazione',fogli)+piega_bestprice;var p=this.data('netto_bp');if(typeof(p)=="undefined"){netto_bp={};}else{netto_bp=p;}
var p_forn=this.data('netto_bp_forn');if(typeof(p_forn)=="undefined"){netto_bp_forn={};}else{netto_bp_forn=p_forn;}
for(var priorita in this.data('priorita')){if(this.data('priorita')[priorita]['abilitata']=='1'){switch(parseInt(priorita,10)){case 4:nettobp=bestprice+piega_plastificazione+costo_formato_personalizzato+costo_aggiuntivo_piega;nettobp_forn=(bestprice+piega_plastificazione)*0.85;break;default:nettobp=bestprice*mod_bp_72+piega_plastificazione+costo_formato_personalizzato+costo_aggiuntivo_piega;nettobp_forn=(bestprice*mod_bp_72+piega_plastificazione)*0.85;break;}
if(calcolo_bp){if(!netto_bp_forn[priorita]){netto_bp_forn[priorita]={};}
if(!netto_bp_forn[priorita][qta]){netto_bp_forn[priorita][qta]={};}
netto_bp_forn[priorita][qta]=nettobp_forn;this.data('netto_bp_forn',netto_bp_forn);if(find(i_valid_ids,priorita)){if(!netto_bp[priorita]){netto_bp[priorita]={};}
if(!netto_bp[priorita][qta]){netto_bp[priorita][qta]={};}
if(!this.data('apply_mod_netto')&&(this.data('id_categoria')=="1"||this.data('id_categoria')=="7"||this.data('id_categoria')=="346")&&(this.get('id_nazione')==107||this.get('id_nazione')==79||this.get('id_nazione')==194||this.get('id_nazione')==31)){if(nettobp<=200)
nettobp+=1;else
nettobp+=2;}
netto_bp[priorita][qta]=nettobp;this.data('netto_bp',netto_bp);}}else{if(!netto_bp_forn[priorita]){netto_bp_forn[priorita]={};}
if(!netto_bp_forn[priorita][qta]){netto_bp_forn[priorita][qta]={};}
netto_bp_forn[priorita][qta]=nettobp_forn;this.data('netto_bp_forn',netto_bp_forn);}}}}else{this.removeData('netto_bp');this.removeData('netto_bp_forn');}},setOption:function(f,o){var feature=this.feature(f);var newOption='';if(hasKey(feature['opzioni'],o))
newOption=o;else if(typeof(o)=='number')
newOption=getKey(feature['opzioni'],o);if(typeof(newOption)!='undefined'&&newOption!='')
if(this.optionCheck(feature['opzioni'][o]))
if(feature['selected']!=newOption){if(this.featureChange){if(this.selected(f))
this.selected(f)['changed']=true;feature['selected']=newOption;this.selected(f)['changed']=true;feature['changed']=true;this.setPromo(f);}else{feature['selected']=newOption;}
return true;}
return false},setPromo:function(f){var rel_prodotto_promocode=this.data('rel_prodotto_promocode')||{};for(var p in this.promocode){var promocode=this.promocode[p];if(promocode['codice_richiesto']==0){var feature=this.feature(f);if(indexOf(promocode['features'],feature['id_rel'])!==-1){var option=this.selected(f);if(indexOf(promocode['rel_prodotto'],option['id_rel'])!==-1){this.setIdPromocode(p);rel_prodotto_promocode[p]=option['id_rel'];this.data('rel_prodotto_promocode',rel_prodotto_promocode);return true;}else{this.setIdPromocode('');rel_prodotto_promocode[p]=false;this.data('rel_prodotto_promocode',rel_prodotto_promocode);}}}}
return false;},setPromocode:function(data){this.promocode={};if(data['promocode']!=undefined){var promocode=data['promocode'];var idPromocode=data['id_promocode'];this.selPromocode=idPromocode;var id_active_promocode=[];for(var p in promocode){var features=[];for(var id_rel in promocode[p]['rel_prodotto']){var id_rel=promocode[p]['rel_prodotto'][id_rel];if(isDefined(this.id_rels[id_rel])){var id_rel_feature=this.id_rels[id_rel]['id_rel_padre'];if(indexOf(features,id_rel_feature)==-1)
features.push(id_rel_feature);}}
promocode[p]['features']=features;if(promocode[p]['codice_richiesto']=='0'){id_active_promocode.push(p);}}
this.data('id_active_promocode',id_active_promocode);if(promocode[this.get('id_promocode')]==undefined){this.setIdPromocode((isDefined(idPromocode)&&idPromocode!='')?idPromocode:'');}else{}
this.promocode=promocode;}},setPromoByPriority:function(p){var rel_prodotto_promocode=this.data('rel_prodotto_promocode')||{};for(var i in this.promocode){var promocode=this.promocode[i];if(promocode['codice_richiesto']==0){if((isUndefined(rel_prodotto_promocode[i])||rel_prodotto_promocode[i]!==false)&&indexOf(promocode['priorita'],p+'')!==-1){this.setIdPromocode(i);return true;}else{this.setIdPromocode('');}}}
return false;},checkPriority:function(p){return this.data('priorita')[p]['enabled']===true&&this.data('priorita')[p]['abilitata']=='1';},modifyPriority:function(priority,status){if(typeof(this.data('priorita')[priority])!='undefined'){if(this.data('priorita')[priority]['enabled']!==status){this.data('priorita')[priority]['enabled']=(status===true);this.findFirstEnabledPriority();return true;}}
return false;},logPrioritiesDates:function(){for(var i in this.data('priorita')){var priorita=this.data('priorita')[i];console.log('n:'+priorita['nome']+' p:'+priorita['data_partenza']+' c:'+priorita['data_consegna']);}},modifyQtyByPriority:function(qty,priority,status){if(typeof(this.priceList[qty])=='undefined'){this.priceList[qty]={};}
if(isUndefined(this.data('priorita')[priority]))
return false;if(typeof(this.priceList[qty][priority])=='undefined'){this.priceList[qty][priority]={};}
this.priceList[qty][priority]['enabled']=(status===true);if(qty==this.get('_QTA'))
this.findFirstEnabledPriority();},findFirstEnabledPriority:function(){var qty=this.data('qta_libera')?1:this.val(this.data('caratteristica_qta'));var p=this.get('id_priorita');if(!this.checkPriority(this.get('id_priorita'))||(isDefined(this.priceList[qty])&&isDefined(this.priceList[qty][p])&&this.priceList[qty][p]['enabled']===false))
for(var p in this.data('priorita'))
if(this.checkPriority(p)&&(isUndefined(this.priceList[qty])||isUndefined(this.priceList[qty][p])||this.priceList[qty][p]['enabled'])){this.changePriority(p);this.setPromoByPriority(p);return true;}
this.setPromoByPriority(this.get('id_priorita'));return false;},startPrice:function(f){var prices=(this.selected(f)||this.feature(f)).data('prezzi');if(prices)
return pixartParseFloat(prices[0]['avviamento']);else
return 0;},price:function(f,qty,forceBrackets){if(this.val(f)===false){return 0;}
this.log(_PRICE,'Getting price for feature '+f+', qty: '+qty);var prices=(this.selected(f)||this.feature(f)).data('prezzi');if(prices){var algorithm='';switch(true){case this.inPromo(f)!==false:algorithm='priceByPromo';break;case forceBrackets===true:algorithm='priceByBrackets';break;default:algorithm='priceByThresholds';break;}
qty=pixartParseFloat(qty);return this[algorithm](qty,prices);}
return 0;},profitMargin:function(f,qty){var target=(this.selected(f)||this.feature(f));if(target!==false){var prices=target.data('prezzi');if(prices){if(typeof(qty)=='undefined'||qty==0)
return pixartParseFloat(prices[0]['margine']);var i=0;for(;i<prices.length&&qty>prices[i]['soglia'];i++){}
if(i>=prices.length)
i=prices.length-1;return pixartParseFloat(prices[i]['margine']);}}
return 1;},royalty:function(net){if(this.feature('Grafica')){}
return 0;},promoQty:function(qty){var promocode=this.activePromo();var quantities=[qty||1];if(pixartParseFloat(promocode['qta_totale'])>0){quantities.push(pixartParseFloat(promocode['qta_totale'])-pixartParseFloat(promocode['qta_attuale']));}
if(pixartParseFloat(promocode['qta_cliente'])>0){quantities.push(pixartParseFloat(promocode['qta_cliente'])-pixartParseFloat(promocode['qta_cliente_utilizzata']));}
return Math.min.apply(Math,quantities);},activatedPromo:function(){var idPromoActivated=this.data('id_active_promocode');var active_promo=[];for(var i in idPromoActivated){active_promo.push(idPromoActivated[i]+':'+this.promocode[idPromoActivated[i]]['nome']);}
return active_promo.join(', ');},activePromo:function(){var idpromo=this.get('id_promocode');var promocode=this.promocode[idpromo]||false;var fbcookie=this.data('cookie_fb')||{};return((promocode)?promocode:false);},minimumPromoNet:function(net){return net<1?1:net;},getPromoNet:function(qty,p,priorityFactor){var promocode=this.activePromo();var total_price=0;var net_return=0;if(promocode){this.data('discount-to-be-applied',0);var price=pixartParseFloat(promocode['prezzo']);if(price>0){return pixartParseFloat((promocode['id']=='1'?json_valuta['cambio_applicato']:price));}
else{this.weightedPromoPrice(qty,this.net(p));total_price=(this.net(p)+pixartParseFloat(this.oneMoreEuro(this.net(p))))*this.netModifier()*priorityFactor;}
switch(promocode['sconto_tipo']){case'valore':net_return=total_price-this.data('discount-to-be-applied');break;case'prezzo':net_return=0;var net=this.data('netto');this.data('enable-promo',true);this.quote();this.data('enable-promo',false);net_return=(pixartParseFloat(this.net(p))+pixartParseFloat(this.oneMoreEuro(this.net(p))))*this.netModifier()*priorityFactor;this.data('netto',net);break;case'percentuale':default:net_return=total_price-this.data('discount-to-be-applied')*this.netModifier()*priorityFactor;break;}
return this.minimumPromoNet(net_return);}
return 0;},getPromoPriorities:function(){var promocode=this.activePromo();return promocode?promocode['priorita']:[];},inPromo:function(f){var promocode=this.activePromo();if(this.data('enable-promo')&&promocode)
return indexOf(promocode["rel_prodotto"],this.selected(f)['id_rel'])!=-1
return false;},priceByBrackets:function(qty,prices){if(typeof(qty)=='undefined'||qty==0)
return pixartParseFloat(prices[0]['cad']);var startPrice=pixartParseFloat(prices[0]['avviamento']);var i=0;for(;i<prices.length&&qty>prices[i]['soglia'];i++){}
if(i>=prices.length)
i=prices.length-1;return startPrice+pixartParseFloat(prices[i]['cad'])*qty;},priceByThresholds:function(qty,prices){if(typeof(qty)=='undefined'||qty==0)
return pixartParseFloat(prices[0]['cad']);var total=pixartParseFloat(prices[0]['avviamento']);var prevThreshold=0;for(var i=0;i<prices.length&&qty>0;i++){var price=prices[i];price['soglia']=pixartParseFloat(price['soglia']);if(price['soglia']==''||(price['soglia']-prevThreshold)>qty)
total+=qty*price['cad'];else
total+=(price['soglia']-prevThreshold)*price['cad'];qty-=(price['soglia']-prevThreshold);prevThreshold=price['soglia'];}
if(qty>0&&price['soglia']>0)
total+=(qty*price['cad']);return total;},priceByPromo:function(qty,prices){var total=this.priceByThresholds(qty,prices);this.weightedPromoPrice(qty,total);return total;},weightedPromoPrice:function(qty,total){var promocode=this.activePromo();var promo_qty=this.promoQty(qty);var total_price=(pixartParseFloat(total)+pixartParseFloat(this.oneMoreEuro(total)));var sconto_netto_min=promocode['sconto_netto_min'];var sconto_netto_max=promocode['sconto_netto_max'];var sconto_da_applicare=0;var minMaxOk=(total_price>=sconto_netto_min||!sconto_netto_min||parseInt(sconto_netto_min)===0)&&(total_price<=sconto_netto_max||!sconto_netto_max||parseInt(sconto_netto_max)===0);if(promocode!==false&&promocode['id']=="19346"){var S=this.shippingCosts(total_price,this.data('peso'),qty);var total_price_check=total_price+S.netto_spedizione;minMaxOk=(total_price_check>=sconto_netto_min||!sconto_netto_min||parseInt(sconto_netto_min)===0)&&(total_price_check<=sconto_netto_max||!sconto_netto_max||parseInt(sconto_netto_max)===0);}
switch(promocode['sconto_tipo']){case'percentuale':if(minMaxOk){sconto_da_applicare=promo_qty*total_price/qty*pixartParseFloat(promocode["sconto_valore"])/100;}
break;case'valore':if(minMaxOk){sconto_da_applicare=(qty<=promo_qty)?pixartParseFloat(promocode["sconto_valore"]):0;}
break;}
this.data('discount-to-be-applied',sconto_da_applicare);},feature:function(f){if(hasKey(this.in_array,f))
return this.in_array[f];else
return false;},hasOptions:function(f){var feature=this.feature(f);if(feature)
return feature['numero_opzioni']>0&&feature['tipo']!='input';return false;},applyToOptions:function(f,fn){if(typeof(fn)=='function'){var options=this.getOptionsList(f);for(var o in options){var opt=options[o];fn.call(opt);}
return true;}
return false;},selected:function(f){var feature=this.feature(f);if(feature){var selected=feature['selected'];if(selected!='')
return feature.opzioni[selected];return false;}else{return false;}},val:function(f,o){var feature=this.feature(f);if(feature){if(typeof(o)=='undefined'){if(this.hasOptions(f)){if(feature.data('label')=='quantita'){return pixartParseFloat(this.name(f));}else{return'#'+this.selected(f)['id'];}}else{switch(feature.data('tipo')){case'TEXT':return feature['value'].toString();default:return pixartParseFloat(feature['value'].toString().replace(',','.'));}}}else{if(this.hasOptions(f)){return this.setOption(f,o);}else{if(feature['value']!==o){feature['value']=o;feature['changed']=true;}else{return false;}}}
return true;}
return false;},changePriority:function(p){this.set('id_priorita',p);this.setVendor();},change:function(f,o,opt){var allowSame,doQuote;if(typeof(opt)=='undefined'){allowSame=false;doQuote=true;}else
allowSame=doQuote=opt;var change=this.val(f,o);if(change){this.doQuote(doQuote);return true;}
return allowSame===true;},name:function(f){return this.selected(f)?this.selected(f)['nome']:false;},nameInLang:function(f){return this.selected(f).data('nome');},refreshAvailableOptions:function(){var features=this.getFeaturesName();for(var f in features){var available=0;var feature=features[f];if(this.hasOptions(feature)){var options=this.getOptionsList(feature);for(var o in options)
if(this.optionCheck(options[o]))
available++;}
this.feature(feature)['available']=available;}},width:function(f){return pixartParseFloat((this.selected(f)||this.feature(f)).data('base'));},height:function(f){return pixartParseFloat((this.selected(f)||this.feature(f)).data('larghezza'));},depth:function(f){return pixartParseFloat((this.selected(f)||this.feature(f)).data('spessore'));},weight:function(f){return pixartParseFloat((this.selected(f)||this.feature(f)).data('peso'));},setWidthHeight:function(){var pesi={103:1,367:1,275:1,19:2,132:1,151:4,152:5,35:6,146:7,177:8};var abbondanza=this.data('abbondanza');var base_documento=0;var altezza_documento=0;if(abbondanza){base_documento=abbondanza["des"]+abbondanza["sin"];altezza_documento=abbondanza["sup"]+abbondanza["inf"];var orizzontale=false;var sup,inf,des,sin;sup=inf=des=sin=0;var aggiunte_base,aggiunte_altezza;aggiunte_base=aggiunte_altezza=0;var indice=-1;var skip_car={"Altezza bobina":"1"};var features=this.getFeaturesName();for(var i in features){var f=features[i];var f_name=f.toLowerCase();var f_obj=this.feature(f);var f_val=this.val(f);var f_width=this.width(f);var f_height=this.height(f);if(f_name.contains('trimbox')||skip_car[f_name]=='1')
continue;if(f_name.contains('formato')&&f_obj.data('label')=='dimensioni'&&this.get('pannello')==1&&this.id!=356){var formato=this.name(f).split("x");if(count(formato)==2){this.set('_B',parseFloat((formato[0]).trim()).toFixed(2));this.set('_H',parseFloat((formato[1]).trim()).toFixed(2));}else{if(f_name=='base')
this.set('_B',f_val);if(f_name=='altezza')
this.set('_H',f_val);}}else if(f_name.contains('formato')&&f_obj.data('label')=='dimensioni'){this.set('_B',f_width);this.set('_H',f_height);}else if(f_name.contains('dimensione della stampa')){this.set('_B',f_width);this.set('_H',f_height);}else if(f_name.contains('base')){this.set('_B',f_val);}else if(f_name.contains('altezza')){this.set('_H',f_val);}
if(f_name=='base'&&(base_documento==(abbondanza["des"]+abbondanza["sin"]))){base_documento+=parseFloat(f_val)*10;}
if(f_name=='altezza'&&(altezza_documento==(abbondanza["sup"]+abbondanza["inf"]))){altezza_documento+=parseFloat(f_val)*10;}
if(f_name=='orientamento'&&f_val=='#847'){orizzontale=true;}
if(f_name=='orientamento spirale'&&(f_val=='#1479'||f_val=='#1480')){orizzontale=true;}
if(f_name!=='materiale'&&f_width>0&&(base_documento==(abbondanza["des"]+abbondanza["sin"]))){base_documento+=parseFloat(f_width)*10;}
if(f_name!=='materiale'&&f_height>0&&(altezza_documento==(abbondanza["sup"]+abbondanza["inf"]))){altezza_documento+=parseFloat(f_height)*10;}
var raddoppia=false;var double_products={190:1,573:1,574:1,575:1,576:1};if(isDefined(double_products[this.id])&&this.val('Materiale')=='#67'){raddoppia=true;}
if(this.hasOptions(f)&&count(this.selected(f).data('abbondanza'))>0){var abbondanza_opt=this.selected(f).data('abbondanza');var car_name=parseInt(f_obj.data('id'),10);if(typeof(pesi[car_name])!='undefined'){if(pesi[car_name]>=indice){if(abbondanza_opt["sup"]>0){sup=abbondanza_opt["sup"];if(raddoppia)
sup=sup*2;indice=pesi[car_name];}
if(abbondanza_opt["inf"]>0){indice=pesi[car_name];inf=abbondanza_opt["inf"];if(raddoppia)
inf=inf*2;}
if(abbondanza_opt["sin"]>0){indice=pesi[car_name];sin=abbondanza_opt["sin"];if(raddoppia)
sin=sin*2;}
if(abbondanza_opt["des"]>0){indice=pesi[car_name];des=abbondanza_opt["des"];if(raddoppia)
des=des*2;}}}
aggiunte_base=parseFloat(sin)+parseFloat(des);aggiunte_altezza=parseFloat(sup)+parseFloat(inf);}}
if(orizzontale&&(base_documento<altezza_documento)){var tmp_base=base_documento;base_documento=altezza_documento;altezza_documento=tmp_base;}
base_documento+=parseFloat(aggiunte_base);altezza_documento+=parseFloat(aggiunte_altezza);}
if(this.data('B_file_fisso')){base_documento=this.data('B_file_fisso');}
if(this.data('H_file_fisso')){altezza_documento=this.data('H_file_fisso');}
this.set('_B_file',base_documento);this.set('_H_file',altezza_documento);},fileIndications:function(){var features=this.getFeaturesName();for(var i in features){var f=features[i];var counter_if=0;if(this.hasOptions(f)){var options=this.getOptionsList(f);for(var o in options){var option=options[o];if(option.data('_IF')!=null&&option.data('_IF')!='')
counter_if++;}}
if(counter_if>0)
this.set('_IF',this.selected(f).data('_IF')||'');}},shippingInfo:function(){var priority=this.data('priorita')[this.get('id_priorita')];this.set('data_partenza',priority['data_partenza']);this.set('data_consegna',priority['data_consegna']);this.set('id_spedizione_servizio',priority['id_spedizione']);this.set('percentuale_priorita',priority['percentuale']);this.set('perc_netto_spedizione',this.netModifier());this.set('spedizione_partner','');var sped_promo=false;if(this.activePromo()){var promocode=this.promocode[this.get('id_promocode')];if(count(promocode["costo_spedizione"])&&promocode["costo_spedizione"][priority['id']]!=""&&promocode["costo_spedizione"][priority['id']]!=null&&this.data('extra_cee')==0){sped_promo=true;priority['costo_spedizione']=promocode["costo_spedizione"][priority['id']];}}
if(this.activePromo()&&sped_promo){this.set('fisso_spedizione',priority['costo_spedizione']);}else{this.set('fisso_spedizione',priority['fisso']);}
if(priority["spedizione_partner"]){this.set('spedizione_partner',priority["fisso"]);}},getFormatInfo:function(format,info){var formats_info=this.formats_info;if(typeof(formats_info[format])!='undefined'){if(typeof(info)!='undefined'){if(typeof(formats_info[format][info])!='undefined'){return formats_info[format][info];}else{return false;}}else{return formats_info[format];}}
return false;},getProductInfo:function(info){var products_info=this.products_info;if(typeof(products_info[this.id])!='undefined'){if(typeof(info)!='undefined'){if(typeof(products_info[this.id][info])!='undefined'){return products_info[this.id][info];}else{return false;}}else{return products_info[this.id];}}
return false;},setSheetInfo:function(name,data){var results=[];if(typeof(data['stat_fogli'])=='undefined'&&typeof(data['fogli'])=='undefined')
return false;switch(parseInt(this.get('id_reparto'))){case 1:switch(name){case'Classic demimatt (Patinata opaca)':case'Classic gloss (Patinata lucida)':case'Classic usomano (Usomano 90g)':results=[Math.ceil(data['stat_fogli']/2),Math.ceil(data['fogli']/2),'A2','A2'];break;default:results=[Math.ceil(data['stat_fogli']),Math.ceil(data['fogli']),'A3','A3'];break;}
break;case 2:switch(name){case'Classic demimatt (Patinata opaca)':case'Classic gloss (Patinata lucida)':case'Classic usomano (Usomano 90g)':results=[Math.ceil(data['stat_fogli']/2),Math.ceil(data['fogli']/2),'A2','A2'];break;default:results=[Math.ceil(data['stat_fogli']/4),Math.ceil(data['fogli']/4),'70x100','70x100'];break;}}
if(results){this.set('fogli',results[0]);this.data('fogli',results[1]);this.set('formato_fogli',results[2]);this.data('formato_fogli',results[3]);return true;}
return false;},getFeatureIs:function(params,return_type){if(isUndefined(return_type)||return_type==false)
return_type='boolean';var positiveFeatures={};var featuresName=this.getFeaturesName();for(var f in featuresName){var featureName=featuresName[f];if(this.hasOptions(featureName))
{var parameterCounter=0;var positiveCounter=0;var operators=['and','or'];if(return_type!='all'){for(var o in operators){if(isDefined(params[operators[o]])){var parameters=params[operators[o]];for(var p in parameters){if(this.selected(featureName).data(p))
for(var v in parameters[p])
if(this.selected(featureName).data(p)==parameters[p][v])
positiveCounter++;parameterCounter++;}
if((operators[o]=='and'&&positiveCounter==parameterCounter)||(operators[o]=='or'&&positiveCounter>0)){if(return_type=='boolean')
return true;else if(return_type=='object')
return this.selected(featureName);else if(return_type=='array')
positiveFeatures[featureName]=this.selected(featureName);}}}}
else
positiveFeatures[featureName]=this.selected(featureName);}}
if(return_type=='array'||return_type=='all')
return positiveFeatures;return false;},message:function(f,type){var feature=this.feature(f);var option=this.selected(f);if(option)
return option.data(type)||feature.data(type);else
return feature.data(type);},cleanDictionary:function(){this.data('dictionary',{});},getDictionary:function(label){if(label==''){return'';}
var dictionary=this.data('dictionary');return(isDefined(dictionary[label])?dictionary[label]:'');},prepayment:function(){this.set('pagamento_anticipato',0);if(this.data('pagamento_anticipato')>0){this.set('pagamento_anticipato',1);return true;}
this.eachFeature(function(feature){if(feature.data('pagamento_anticipato')>0||(this.hasOptions(feature['nome'])&&this.selected(feature['nome']).data('pagamento_anticipato')>0)){this.set('pagamento_anticipato',1);return true;}});},pixartTemplate:function(){this.set('template_pixart',0);this.eachFeature(function(feature){if(this.hasOptions(feature['nome'])&&this.selected(feature['nome']).data('template_pixart')>0){this.set('template_pixart',1);return true;}});},eachFeature:function(callback){var featuresName=this.getFeaturesName();for(var f in featuresName){var feature=this.feature(featuresName[f])
var response=callback.call(this,feature);if(isDefined(response))
return response;}},enableFeaturesChange:function(){this.featureChange=true;},disableFeaturesChange:function(){this.featureChange=false;},valid:function(f,opt){this.log(_STATUS,'Set valid '+f);this.feature(f)['valid']=true;if(typeof(opt)=='undefined'||opt.bypassWarnings!==true)
this.feature(f)['warning']=false;},invalid:function(f){this.log(_STATUS,'Set invalid '+f);this.feature(f)['valid']=false;},warning:function(f){this.log(_STATUS,'Set warning '+f);this.feature(f)['warning']=true;},optionCheck:function(o){return!(o['incompatibile']||o['non_disponibile']);},featureStandardCheck:function(f){var feature=this.feature(f);if(feature['incompatibile'])
return true;var val=this.val(f);if(feature.data('obbligatorio')=="1"&&(val==0||val==''))return false;if(this.feature(f).data('id')=="290"&&this.val(f)=="#786")return false;if(feature.data('tipo')=='QTA'||feature.data('tipo')=='B'||feature.data('tipo')=='H'||feature.data('tipo')=='NUM'){if(feature.data('min')!=null&&val<feature.data('min'))return false;if(feature.data('max')!=null&&val>feature.data('max'))return false;val=(val).toFixed(feature.data('decimali'));this.val(f,val);if(typeof(this.get('_'+feature.data('tipo')))!='undefined')
this.set('_'+feature.data('tipo'),val);}
return true;},resetFeaturesStatus:function(){var features=this.getFeaturesName();for(var f in features)
this.valid(features[f]);},featuresCheck:function(){var features=this.getFeaturesName();this.isValid(true);for(var f in features){var featureName=features[f];if(!this.feature(featureName)['valid']||!this.featureStandardCheck(featureName)){this.invalid(featureName);this.isValid(false);}else{this.valid(featureName,{bypassWarnings:true});}}
return this.isValid();},isValid:function(status){if(typeof(status)=='undefined')
return this.status;else
this.status=(status===true);},allFeaturesFilled:function(){var empty=true;var withoutOptions=0;this.eachFeature(function(f){if((this.val(f['nome'])===''||this.val(f['nome'])==0)&&f['incompatibile']===false&&f.data('interno')!='1'){empty=false;}
if(!this.hasOptions(f['nome'])){withoutOptions++;}});return empty!==false&&withoutOptions!=0;},excludedPhases:function(f){return(this.selected(f)||this.feature(f)).data('ciclo_no_fasi');},setVendor:function(){var vendorShipping=this.data('spedizioni_fornitore_esterno');var vendorId=this.data('id_fornitore_esterno');if((vendorShipping&&vendorShipping[vendorId]&&indexOf(vendorShipping[vendorId]['id_spedizione'],this.get('id_priorita'))!=-1)||(isDefined(this.data('netti_priorita'))&&isDefined(this.data('netti_priorita')[this.get('id_priorita')]))){this.set('id_fornitore',vendorId);this.set('ciclo_produttivo',this.data('ciclo_fornitore_esterno'));}else if(this.data('id_fornitore_esterno')&&!vendorShipping){this.set('id_fornitore',vendorId);this.set('ciclo_produttivo',this.data('ciclo_fornitore_esterno'));}else{this.set('id_fornitore',0);var cicle=JSON.stringify(this.data('ciclo_produttivo'));var features=this.getFeaturesName();for(var f in features){var phases=this.excludedPhases(features[f]);for(var i in phases)
cicle=cicle.replace(',"'+phases[i]+'"','');}
this.set('ciclo_produttivo',cicle);}},runsLimit:function(priority){if(!this.tag('passate'))
return false;var limit={};var limitIndex='';var country=this.data('id_nazione');if(find([189,193,194,454],this.id))
limitIndex='limite_passate_riviste';else if(this.get('offset')=='1')
limitIndex='limite_passate_offset';if(limitIndex!=''){if(typeof(this.data(limitIndex)[country])!='undefined')
limit=this.data(limitIndex)[country];else
limit=this.data(limitIndex)['default'];if(typeof(limit[priority])!='undefined'&&normalizeNumber(this.tag('passate'))>=limit[priority])
return true}
return false;},checkOffset:function(priority){if(this.data('checkoffset')==1){var self=this;var cycle=this.get('ciclo_produttivo');var qta=this.val('Numero di copie');var paper=this.val('Carta');var weight=this.val('Grammatura');var plast=this.val('Plastificazione');var format=self.name('Formato');this.set('ciclo_produttivo',(function(){if(format&&paper&&weight){var only_digital_plast=["#8510","#8508","#8511","#8509"];if(plast&&find(only_digital_plast,plast)){self.set('offset',0);self.set('id_reparto',1);if(cycle.contains('"1","2"'))cycle=cycle.replace('"1","2"','"1","23","2"');if(cycle.contains('"1","23","24","2"'))cycle=cycle.replace('"1","23","24","2"','"1","23","2"');return cycle;}
var scripts_excluded=["biglietti_da_visita.js"];var only_digital_formats=['9 cm x 5 cm','8,9 cm x 5,1 cm (US 3,5x2)','8,5 cm x 5 cm','8,5 cm x 5,5 cm','5x5','5 cm x 5 cm','5,5 x 5,5 cm','29,7 cm x 63 cm','29,7 cm x 62,7 cm','21 cm x 63 cm','21 cm x 62,7 cm','45,72 cm x 60,96 (US ARCH C)'];if(!find(scripts_excluded,self.data('script'))&&find(only_digital_formats,format)){self.set('offset',0);self.set('id_reparto',1);if(cycle.contains('"1","2"'))cycle=cycle.replace('"1","2"','"1","23","2"');if(cycle.contains('"1","23","24","2"'))cycle=cycle.replace('"1","23","24","2"','"1","23","2"');return cycle;}
if((qta>100&&self.get('id_priorita')!=1&&(paper=='#122'||paper=='#123'))||paper=='#298'){self.set('offset',1);self.set('id_reparto',2);cycle=cycle.replace('"1","2"','"1","23","24","2"');return cycle;}else{self.set('offset',0);self.set('id_reparto',1);if(cycle.contains('"1","2"'))cycle=cycle.replace('"1","2"','"1","23","2"');if(cycle.contains('"1","23","24","2"'))cycle=cycle.replace('"1","23","24","2"','"1","23","2"');return cycle;}}}()));}},checkWard:function(){var format=this.name('Formato');if(format&&this.get('id_bestprice')==3){if(this.tag('passate')>=this.tag('passa_in_offset')||format.contains('A2')){this.set('offset',1);this.set('id_reparto',2);}else{this.set('offset',0);this.set('id_reparto',1);}}},setPressCheck:function(){if(this.data('checkstampa')){var vendor=this.get('id_fornitore');var runs=this.tag('passate');var coverRuns=this.tag('passate_copertina');if(typeof(coverRuns)!='undefined')
runs+=coverRuns;if((runs>=5000)&&(vendor=="0"||vendor=="")){var cycle=this.get('ciclo_produttivo').replace('"1","2"','"1","18","19","2"').replace('"1","22","2"','"1","18","19","22","2"');this.set('ciclo_produttivo',cycle);}}},complexity:function(){var complessita=parseInt(this.data('complessita'));this.eachFeature(function(feature){if(feature['incompatibile']===false){complessita+=parseInt(feature.data('complessita'));if(this.hasOptions(feature.nome)){var option=this.selected(feature.nome);complessita+=parseInt(option.data('complessita'));}}});this.set('complessita',complessita);},fetchIncompatibility:function(no_reset){this.incompatibility={};var features=this.in_array;for(var f in features){var feature=features[f];if(typeof(feature["opzioni"][feature["selected"]])!='undefined'){var option=feature["opzioni"][feature["selected"]];if(!option["incompatibile"]){var opt_incompatibilities=option["incompatibili"];if(opt_incompatibilities){for(var opz_incompatibility in opt_incompatibilities){this.incompatibility[opt_incompatibilities[opz_incompatibility]]=true;}}}}}
if(no_reset){var quoteIncompatibility=this.data('incompatibility');for(var i in quoteIncompatibility){if(quoteIncompatibility[i])
this.incompatibility[i]=true;else
delete this.incompatibility[i];}}else{this.data('incompatibility',{});}},applyIncompatibility:function(no_reset){if(typeof(no_reset)=='undefined')
no_reset=false;var recursion=false;var features=this.in_array;this.fetchIncompatibility(no_reset);for(var id_rel in this.id_rels){var obj=this.id_rels[id_rel];if(hasKey(this.incompatibility,id_rel)){if(obj['incompatibile']==false){obj["incompatibile"]=true;obj["changed"]=true;if(typeof(obj['id_rel_padre'])!='undefined'){var parent=this.id_rels[obj['id_rel_padre']];parent["changed"]=true;}}}else if(obj['incompatibile']==true){obj["incompatibile"]=false;obj["changed"]=true;}}
for(var f in features){if(features[f]["numero_opzioni"]>0&&(isUndefined(features[f]['opzioni'][features[f]["selected"]])||features[f]['opzioni'][features[f]["selected"]]['incompatibile']==true)){this.setFirstOption(f);recursion=true;}}
if(recursion){this.applyIncompatibility(no_reset);return true;}
this.applyNotAvailable(no_reset);this.refreshAvailableOptions();return true;},fetchNotAvailable:function(){this.not_available={};var features=this.in_array;for(var f in features){var feature=features[f];if(feature["numero_opzioni"]>0){var options=feature["opzioni"];for(var o in options){var not_available=options[o]["non_disponibili"];if(not_available){if(o==feature["selected"]){for(var na in not_available){this.not_available[na]=not_available[na].split('-');}}else{if(typeof(not_available[options[o]['id_rel']])!='undefined'){this.not_available[options[o]['id_rel']]=not_available[options[o]['id_rel']].split('-');}}}}}}},applyNotAvailable:function(no_reset){var recursion=false;var features=this.in_array;this.fetchNotAvailable();for(var id_rel in this.id_rels){var obj=this.id_rels[id_rel];if(searchKey(this.not_available,id_rel)!=-1){if(obj['non_disponibile']==false){obj["non_disponibile"]=true;obj["changed"]=true;if(typeof(obj['id_rel_padre'])!='undefined'){var parent=this.id_rels[obj['id_rel_padre']];parent["changed"]=true;if(obj["nome"]==parent["selected"]){parent["selected"]='';}}}}else if(obj['non_disponibile']==true){obj["non_disponibile"]=false;obj["changed"]=true;}}
for(var f in features){if(features[f]["numero_opzioni"]>0&&features[f]["selected"]==''){this.setFirstOption(f);recursion=true;}}
if(recursion){this.applyIncompatibility(no_reset);return;}
return true;},modifyIncompatibility:function(list){if(typeof(list)=='object'){for(var key in list){var id_rel=typeof(key)=='number'?key:isDefined(this.paths[key])?this.paths[key]['id_rel']:false;if(id_rel===false)
return false;this.data('incompatibility')[id_rel]=list[key];}
return true;}
return false;},initializeIfEmpty:function(nomeCaratteristica,min_value){var feature=this.feature(nomeCaratteristica);if(!feature||feature.tipo!=="input"){return false;}
if(isUndefined(feature.data("default_setted"))&&this.val(nomeCaratteristica)==''){this.val(nomeCaratteristica,min_value);feature.data("default_setted",true);return true;}else{return false;}},checkOriginalIncompatibility:function(nomeCaratteristica,id_rel){if(this.feature(nomeCaratteristica)){var feature=this.feature(nomeCaratteristica);var option=feature["opzioni"][feature["selected"]];var opt_incompatibilities=option["incompatibili"];if(opt_incompatibilities){return opt_incompatibilities.indexOf(id_rel)>=0;}else{return false;}}else{return false;}},applyFoldIncompatibility:function(){var excludeFormatiCheck=false;var prods_format_excluded=[354];if(isDefined(prods_format_excluded[this.id])){excludeFormatiCheck=true;}
var self=this;var ati_feature_piegatura='Piegatura';var ati_feature_formato="Formato";var ati_feature_carta='Carta';var ati_feature_grammatura='Grammatura';var ati_feature_quantita="Numero di copie";if(this.feature(ati_feature_piegatura)&&this.feature(ati_feature_formato)&&this.feature(ati_feature_carta)&&this.feature(ati_feature_grammatura)){var __val_formato=function(){return self.val(ati_feature_formato);}
var __val_carta=function(){return self.val(ati_feature_carta);}
var __val_piegatura=function(){return self.val(ati_feature_piegatura);}
var __val_grammatura=function(){return self.val(ati_feature_grammatura);}
var piegaturaSelected=__val_piegatura();var paper_folds=this.folds_info.paper_folds;var format_letter=this.folds_info.format_letter;if(__val_formato()!=this.data('afi_old_formato')||__val_carta()!=this.data('afi_old_carta')||__val_grammatura()!=this.data('afi_old_grammatura')||__val_piegatura()!=this.data('afi_old_piegatura')||true){if(isDefined(paper_folds[piegaturaSelected])){var folds_incompatibility={};var combinazioni=paper_folds[piegaturaSelected]['combinazioni'];this.applyToOptions(ati_feature_carta,function(){var id_carta="#"+this.data('id');if(!isDefined(combinazioni[id_carta])){folds_incompatibility[ati_feature_carta+'/'+this.data('name')]=true;}else{folds_incompatibility[ati_feature_carta+'/'+this.data('name')]=false;}})
this.modifyIncompatibility(folds_incompatibility);this.applyIncompatibility(true);folds_incompatibility={};var cartaSelected=this.val(ati_feature_carta);this.applyToOptions(ati_feature_grammatura,function(){var id_grammatura=parseInt(this.data('name').substring(0,3));if(!self.checkOriginalIncompatibility(ati_feature_carta,this.data('id_rel'))){if(!isDefined(combinazioni[cartaSelected][id_grammatura])){folds_incompatibility[ati_feature_grammatura+'/'+this.data('name')]=true;}else{folds_incompatibility[ati_feature_grammatura+'/'+this.data('name')]=false;}}});this.modifyIncompatibility(folds_incompatibility);this.applyIncompatibility(true);if(!excludeFormatiCheck){folds_incompatibility={};var grammaturaSelected=parseInt(this.name(ati_feature_grammatura).substring(0,3));this.applyToOptions(ati_feature_formato,function(){var id_formato="#"+this.data('id');if(!isDefined(format_letter[id_formato])){folds_incompatibility[ati_feature_formato+'/'+this.data('name')]=true;}else{var formatoLettera=format_letter[id_formato];if(combinazioni[cartaSelected][grammaturaSelected].indexOf(formatoLettera)==-1){folds_incompatibility[ati_feature_formato+'/'+this.data('name')]=true;}else{folds_incompatibility[ati_feature_formato+'/'+this.data('name')]=false;}}});this.modifyIncompatibility(folds_incompatibility);this.applyIncompatibility(true);}
if(isDefined(combinazioni[cartaSelected]['quantitaMax'])){folds_incompatibility={};var quantitaMax=parseInt(combinazioni[cartaSelected]['quantitaMax']);this.applyToOptions(ati_feature_quantita,function(){if(parseInt(this.data('name'))>quantitaMax){folds_incompatibility[ati_feature_quantita+"/"+this.data('name')]=true;}else{folds_incompatibility[ati_feature_quantita+"/"+this.data('name')]=false;}})
this.modifyIncompatibility(folds_incompatibility);this.applyIncompatibility(true);}
this.data('afi_old_formato',__val_formato());this.data('afi_old_carta',__val_carta());this.data('afi_old_grammatura',__val_grammatura());this.data('afi_old_piegatura',__val_piegatura());}}}},checkFoldIncompatibilityAvailable:function(){var fold_incompatibility_script={'tutto_il_resto_new.js':{},'pieghevoli.js':{354:1},'pieghevoli_pixna.js':{}};if(isDefined(fold_incompatibility_script[this.data('script')])&&(count(fold_incompatibility_script[this.data('script')])==0||(isDefined(fold_incompatibility_script[this.data('script')][this.id])))){return true;}
return false;},serialize:function(){var obj={},feature,i,f,o,key;for(i in this.attrs){obj[i]={};if(this.attrs[i]!==''){obj[i]['value']=this.attrs[i];}}
var features=this.getFeaturesName();for(i in features){feature=features[i];f=this.feature(feature);o=this.selected(feature);key='#'+f['id'];obj[key]={};obj[key]['value']=this.val(feature);obj[key]['id_rel_caratteristica']=f['id_rel'];if(o)
obj[key]['id_rel_opzione']=o['id_rel'];if(f.data('interno')==1)
obj[key]['interno']=1;if(f.data('esterno')==1)
obj[key]['esterno']=1;}
if(!this.data('qta_libera')){feature=this.data('caratteristica_qta');f=this.feature(feature);key='#'+f['id'];obj[key]['value']='#'+this.selected(feature)['id'];}
if(!this.activePromo()||!find(this.activePromo()['priorita'],this.get('id_priorita'))){delete(obj["id_promocode"]);}
return obj;},toFixed:function(){var values={'p_mq':5,'_B':2,'_H':2,'_B_file':2,'_H_file':2,'netto':2};for(var i in values){var val=this.get(i);if(typeof(val)!='number'){val=pixartParseFloat(val);}
this.set(i,val.toFixed(values[i]));}},finalize:function(){this.applyIncompatibility();this.setPromoByPriority(this.get('id_priorita'));this.quote();var summary=this.summary();this.set('id_bestprice',summary['modifier']=='bestprice'?'3':'0');this.set('sconto_partner',summary['modifier']=='discount'?this.data('sconto_cliente')[this.get('id_priorita')]:'');this.set('netto',summary['net']);this.set('peso',this.data('peso'));this.checkWard();this.quoteDependency();this.shippingInfo();this.fileIndications();this.vendorNet();this.complexity();this.prepayment();this.pixartTemplate();this.quoteVariation(summary);this.normalizeProcessingQuote();this.toFixed();},add:function(callback){if(!this.isValid())
return false;this.connector.addToCart(callback);return true;},log:function(level){if((level&this.logLevel)!=0){var args=Array.prototype.slice.call(arguments,1);console.log.apply(console,args);}},timer:function(group,key){if((_TIMER&this.logLevel)===0){return false;}
if(typeof(key)=='undefined'){switch(group){case'tree':var t=this.data('timer');function str_repeat(input,multiplier){var y='';while(true){if(multiplier&1){y+=input;}
multiplier>>=1;if(multiplier){input+=input;}
else{break;}}
return y;}
var tree={},counter=0,print={},indexes=[],buffer='';function _tree(t){var l=t['key']
if(typeof(tree[l])=='undefined'){var temp=(indexes.length==0?false:tree[indexes[indexes.length-1]]);counter++;indexes.push(l);tree[l]={};tree[l]['key']=l;tree[l]['index']=counter;tree[l]['start']=t['time'];tree[l]['level']=(temp?temp['level']:0)+1;}else{tree[l]['stop']=t['time'];tree[l]['level']--;print[tree[l]['index']]=tree[l];delete(tree[l]);indexes.pop();}}
for(var i in t)
_tree(t[i]);for(var i in print)
buffer+="\n"+str_repeat('- ',print[i]['level'])+print[i]['key']+' '+(print[i]['stop']-print[i]['start']);return buffer;break;default:this.data('timer',[]);break;}}else{var timer=this.data('timer');timer.push({group:group,key:key,time:new Date().getTime()});}},snapshot:function(o){var d=$("#debug");if(d.size()==0){$("<div id='debug'></div>").css({'position':'fixed','bottom':'0','left':'0','background':'#FFFFFF','width':'500px','height':'300px','overflow-y':'scroll','z-index':'9999'}).appendTo('body');}
if(false){for(var i in clone){d.append('<h3>'+i+'</h3>');var t=$("<table/>");for(var j in clone[i]['opzioni']){var opt=clone[i]['opzioni'][j];t.append('<tr'+(j==clone[i]['selected']?' style="background:#FFDDDD"':'')+'>'+'<td>'+j+(j==clone[i]['changed']?' X':'')+'</td>'+'<td>'+(opt.incompatibile?'incompatibile':'')+'</td>'+'<td>'+(opt.non_disponibile?'non disponibile':'')+'</td>'+'<td>'+(opt.changed?'change':'')+'</td>'+'</tr>')}
d.append(t);}
d.append('<hr/>');}else{d.append(o+'<hr/>');}
return clone;},toString:function(){},_debugIncompatibility:function(){var list={};for(var id_rel in this.incompatibility){if(searchKey(this.id_rels,id_rel)!=-1){var obj=this.id_rels[id_rel];var name=obj['nome'];if(obj['id_rel_padre']!='')
name=this.id_rels[obj['id_rel_padre']]['nome']+'/'+name;list[id_rel]=name;}}
return list;},stackTrace:function(){var err=new Error();return err.stack;}}
var ConversionClass=function(m_units){if(typeof(m_units)!='object'){throw new Error("The measurement units array is missing");}
this.m_units=m_units;};ConversionClass.prototype={init:function(){if(!this.verifyMUnits()){throw new Error("There are some missing fields into the measurement units array");}},verifyMUnits:function(){if(count(this.m_units)===0){return false;}
var mandatory_fields=['id','conversione','posizione_da_destra','precisione','simbolo'];for(var unit in this.m_units){for(var field in mandatory_fields){if(typeof(this.m_units[unit][mandatory_fields[field]])=='undefined'){return false;}
if(this.m_units[unit][mandatory_fields[field]]===''){return false;}}}
return true;},cmToMUnits:function(cm){cm=pixartParseFloat(cm);if(typeof(cm)!='number'){throw new Error("'cmToMUnits' parameter must be a number");}
var result={};for(var i=count(this.m_units)-1;i>=0;i--){var m_unit=this.m_units[i];var prec=m_unit['precisione'];if(this.m_units[i]['precisione']>0){var value=Math.round(cm/m_unit['conversione']*Math.pow(10,m_unit['precisione']))/Math.pow(10,m_unit['precisione']);}else{var value=Math.floor(Math.round(cm*100)/m_unit['conversione']/100);}
if(pixartParseFloat(value)>0){result[m_unit['id']]=value;}
cm-=value*m_unit['conversione'];}
return result;},mUnitTocm:function(values){if(typeof(values)!='object'||count(values)==0){throw new Error("'mUnitToCm' parameter is not an object or it is empty");}
var cm=0;var found=0;for(var unit in this.m_units){var m_unit=this.m_units[unit];if(typeof(values[m_unit['id']])!='undefined'){cm+=values[m_unit['id']]*m_unit['conversione'];found++;}}
if(found!=count(values)){throw new Error("'mUnitToCm' parameter contain a non supported measurement unit");return 0;}
return Math.round(cm*Math.pow(10,2))/Math.pow(10,2);},cmToMUnitsText:function(cm){var udm_text=[];var cm_to_idm=this.cmToMUnits(cm);for(var udm in this.m_units){var udm_obj=this.m_units[udm];if(isDefined(cm_to_idm[udm_obj['id']])){udm_text[udm_obj['posizione_da_destra']]=cm_to_idm[udm_obj['id']]+' '+udm_obj['simbolo'];}}
return udm_text.reverse().join(' ');},generateTestValues:function(limit){var values=[];var i=0;while(i<limit){var value=(Math.round(Math.random()*120000)/100).toFixed(2);while(value<1){value=(Math.round(Math.random()*120000)/100).toFixed(2);}
values.push(value);i++;}
return values;},testCmToMUnits:function(limit){var wrong=0;var wrong_values=[];var values=this.generateTestValues(limit);for(var i in values){var value=values[i];var res_inch=this.cmToMUnits(value);var res_cm=this.mUnitTocm(res_inch);if(value!=res_cm){wrong++;if(limit<=100){wrong_values.push([value,res_inch,res_cm]);}}}
console.log('testCmToMUnits => ',limit,wrong,wrong_values);},testMUnitsToCm:function(limit){var wrong=0;var wrong_values=[];var values=this.generateTestValues(limit);for(var i in values){var value=values[i];var feet=Math.floor(value/12);var inch=Math.round((value-(feet*12))*100)/100;value={};if(inch>0){value[1]=inch;}
if(feet>0){value[2]=feet;}
var res_cm=this.mUnitTocm(value);var res_inch=this.cmToMUnits(res_cm);if(value[1]!=res_inch[1]||value[2]!=res_inch[2]){wrong++;if(limit<=100){wrong_values.push([value,res_cm,res_inch]);}}}
console.log('testMUnitsToCm => ',limit,wrong,wrong_values);},testConversionJSPHP:function(limit){var wrong=0;var wrong_values=[];var values=this.generateTestValues(limit);var calls=0;for(var i in values){var value=values[i];var feet=Math.floor(value/12);var inch=Math.round((value-(feet*12))*100)/100;value={};if(inch>0){value[1]=inch;}
if(feet>0){value[2]=feet;}
var res_cm=this.mUnitTocm(value);$.post('/ajax/ajax.test_conversion.php',{val:value,cm:res_cm},function(data){eval("data = "+data+";");if(data['val'][1]!=data['inch'][1]||data['val'][2]!=data['inch'][2]){wrong++;if(limit<=100){wrong_values.push([data['val'],data['cm'],data['inch']]);}}
calls++;if(calls==limit){console.log('testConversionJSPHP => ',limit,wrong,wrong_values);}});}},msgConversion:function(msg){msg=msg.replace(/\&nbsp;|\&160;/gi," ").replace(/&#39;/gi,"'");var regexp=/(\d+[.,]?\d*[ ]?[x]?[ ]?)?\d+[.,]?\d*[ ]?((mm)|(cm)|(m))/ig;if(regexp.test(msg))
{var occurency=msg.match(regexp);if(count(occurency)>0)
{for(var i in occurency)
{var measure=String(occurency[i]);if(measure.indexOf('mm')>=0){var conversion=0.1;var replace='mm';}else if(measure.indexOf('cm')>=0){var conversion=1;var replace='cm';}else{var conversion=10;var replace='m';}
var result_str='';measure=measure.toLowerCase().replace(replace,'').replace(' ','').split('x');for(var j in measure)
{if(j>0)
{result_str+=' x ';}
var toConvert=pixartParseFloat(measure[j])*conversion;var units=this.cmToMUnits(pixartParseFloat(toConvert));if(typeof(units[1])=='undefined'){units[1]=0;}
for(var k=count(units)-1;k>=0;k--)
{if(k===0&&count(units)>1)
{result_str+=' ';}
if(isDefined(units[k+1]))
{result_str+=units[k+1]+' '+this.m_units[k]["simbolo"];}}}
msg=msg.replace(occurency[i],result_str);}}}
return msg;}};
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports!=='undefined'){module.exports=factory(require('jquery'));}else{factory(jQuery);}}(function($){'use strict';var Slick=window.Slick||{};Slick=(function(){var instanceUid=0;function Slick(element,settings){var _=this,dataSettings;_.defaults={accessibility:true,adaptiveHeight:false,appendArrows:$(element),appendDots:$(element),arrows:true,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:false,autoplaySpeed:3000,centerMode:false,centerPadding:'50px',cssEase:'ease',customPaging:function(slider,i){return'<button type="button" data-role="none" role="button" aria-required="false" tabindex="0">'+(i+1)+'</button>';},dots:false,dotsClass:'slick-dots',draggable:true,easing:'linear',edgeFriction:0.35,fade:false,focusOnSelect:false,infinite:true,initialSlide:0,lazyLoad:'ondemand',mobileFirst:false,pauseOnHover:true,pauseOnDotsHover:false,respondTo:'window',responsive:null,rows:1,rtl:false,slide:'',slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:true,swipeToSlide:false,touchMove:true,touchThreshold:5,useCSS:true,useTransform:false,variableWidth:false,vertical:false,verticalSwiping:false,waitForAnimate:true,zIndex:1000};_.initials={animating:false,dragging:false,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:false,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:false,unslicked:false};$.extend(_,_.initials);_.activeBreakpoint=null;_.animType=null;_.animProp=null;_.breakpoints=[];_.breakpointSettings=[];_.cssTransitions=false;_.hidden='hidden';_.paused=false;_.positionProp=null;_.respondTo=null;_.rowCount=1;_.shouldClick=true;_.$slider=$(element);_.$slidesCache=null;_.transformType=null;_.transitionType=null;_.visibilityChange='visibilitychange';_.windowWidth=0;_.windowTimer=null;dataSettings=$(element).data('slick')||{};_.options=$.extend({},_.defaults,dataSettings,settings);_.currentSlide=_.options.initialSlide;_.originalSettings=_.options;if(typeof document.mozHidden!=='undefined'){_.hidden='mozHidden';_.visibilityChange='mozvisibilitychange';}else if(typeof document.webkitHidden!=='undefined'){_.hidden='webkitHidden';_.visibilityChange='webkitvisibilitychange';}
_.autoPlay=$.proxy(_.autoPlay,_);_.autoPlayClear=$.proxy(_.autoPlayClear,_);_.changeSlide=$.proxy(_.changeSlide,_);_.clickHandler=$.proxy(_.clickHandler,_);_.selectHandler=$.proxy(_.selectHandler,_);_.setPosition=$.proxy(_.setPosition,_);_.swipeHandler=$.proxy(_.swipeHandler,_);_.dragHandler=$.proxy(_.dragHandler,_);_.keyHandler=$.proxy(_.keyHandler,_);_.autoPlayIterator=$.proxy(_.autoPlayIterator,_);_.instanceUid=instanceUid++;_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;_.registerBreakpoints();_.init(true);_.checkResponsive(true);}
return Slick;}());Slick.prototype.addSlide=Slick.prototype.slickAdd=function(markup,index,addBefore){var _=this;if(typeof(index)==='boolean'){addBefore=index;index=null;}else if(index<0||(index>=_.slideCount)){return false;}
_.unload();if(typeof(index)==='number'){if(index===0&&_.$slides.length===0){$(markup).appendTo(_.$slideTrack);}else if(addBefore){$(markup).insertBefore(_.$slides.eq(index));}else{$(markup).insertAfter(_.$slides.eq(index));}}else{if(addBefore===true){$(markup).prependTo(_.$slideTrack);}else{$(markup).appendTo(_.$slideTrack);}}
_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slides.each(function(index,element){$(element).attr('data-slick-index',index);});_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.animateHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.animate({height:targetHeight},_.options.speed);}};Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;_.animateHeight();if(_.options.rtl===true&&_.options.vertical===false){targetLeft=-targetLeft;}
if(_.transformsEnabled===false){if(_.options.vertical===false){_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback);}else{_.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback);}}else{if(_.cssTransitions===false){if(_.options.rtl===true){_.currentLeft=-(_.currentLeft);}
$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){now=Math.ceil(now);if(_.options.vertical===false){animProps[_.animType]='translate('+
now+'px, 0px)';_.$slideTrack.css(animProps);}else{animProps[_.animType]='translate(0px,'+
now+'px)';_.$slideTrack.css(animProps);}},complete:function(){if(callback){callback.call();}}});}else{_.applyTransition();targetLeft=Math.ceil(targetLeft);if(_.options.vertical===false){animProps[_.animType]='translate3d('+targetLeft+'px, 0px, 0px)';}else{animProps[_.animType]='translate3d(0px,'+targetLeft+'px, 0px)';}
_.$slideTrack.css(animProps);if(callback){setTimeout(function(){_.disableTransition();callback.call();},_.options.speed);}}}};Slick.prototype.asNavFor=function(index){var _=this,asNavFor=_.options.asNavFor;if(asNavFor&&asNavFor!==null){asNavFor=$(asNavFor).not(_.$slider);}
if(asNavFor!==null&&typeof asNavFor==='object'){asNavFor.each(function(){var target=$(this).slick('getSlick');if(!target.unslicked){target.slideHandler(index,true);}});}};Slick.prototype.applyTransition=function(slide){var _=this,transition={};if(_.options.fade===false){transition[_.transitionType]=_.transformType+' '+_.options.speed+'ms '+_.options.cssEase;}else{transition[_.transitionType]='opacity '+_.options.speed+'ms '+_.options.cssEase;}
if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.autoPlay=function(){var _=this;if(_.autoPlayTimer){clearInterval(_.autoPlayTimer);}
if(_.slideCount>_.options.slidesToShow&&_.paused!==true){_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed);}};Slick.prototype.autoPlayClear=function(){var _=this;if(_.autoPlayTimer){clearInterval(_.autoPlayTimer);}};Slick.prototype.autoPlayIterator=function(){var _=this;if(_.options.infinite===false){if(_.direction===1){if((_.currentSlide+1)===_.slideCount-
1){_.direction=0;}
_.slideHandler(_.currentSlide+_.options.slidesToScroll);}else{if((_.currentSlide-1===0)){_.direction=1;}
_.slideHandler(_.currentSlide-_.options.slidesToScroll);}}else{_.slideHandler(_.currentSlide+_.options.slidesToScroll);}};Slick.prototype.buildArrows=function(){var _=this;if(_.options.arrows===true){_.$prevArrow=$(_.options.prevArrow).addClass('slick-arrow');_.$nextArrow=$(_.options.nextArrow).addClass('slick-arrow');if(_.slideCount>_.options.slidesToShow){_.$prevArrow.removeClass('slick-hidden').removeAttr('aria-hidden tabindex');_.$nextArrow.removeClass('slick-hidden').removeAttr('aria-hidden tabindex');if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.prependTo(_.options.appendArrows);}
if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.appendTo(_.options.appendArrows);}
if(_.options.infinite!==true){_.$prevArrow.addClass('slick-disabled').attr('aria-disabled','true');}}else{_.$prevArrow.add(_.$nextArrow).addClass('slick-hidden').attr({'aria-disabled':'true','tabindex':'-1'});}}};Slick.prototype.buildDots=function(){var _=this,i,dotString;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){dotString='<ul class="'+_.options.dotsClass+'">';for(i=0;i<=_.getDotCount();i+=1){dotString+='<li>'+_.options.customPaging.call(this,_,i)+'</li>';}
dotString+='</ul>';_.$dots=$(dotString).appendTo(_.options.appendDots);_.$dots.find('li').first().addClass('slick-active').attr('aria-hidden','false');}};Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+':not(.slick-cloned)').addClass('slick-slide');_.slideCount=_.$slides.length;_.$slides.each(function(index,element){$(element).attr('data-slick-index',index).data('originalStyling',$(element).attr('style')||'');});_.$slider.addClass('slick-slider');_.$slideTrack=(_.slideCount===0)?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent();_.$list=_.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent();_.$slideTrack.css('opacity',0);if(_.options.centerMode===true||_.options.swipeToSlide===true){_.options.slidesToScroll=1;}
$('img[data-lazy]',_.$slider).not('[src]').addClass('slick-loading');_.setupInfinite();_.buildArrows();_.buildDots();_.updateDots();_.setSlideClasses(typeof _.currentSlide==='number'?_.currentSlide:0);if(_.options.draggable===true){_.$list.addClass('draggable');}};Slick.prototype.buildRows=function(){var _=this,a,b,c,newSlides,numOfSlides,originalSlides,slidesPerSection;newSlides=document.createDocumentFragment();originalSlides=_.$slider.children();if(_.options.rows>1){slidesPerSection=_.options.slidesPerRow*_.options.rows;numOfSlides=Math.ceil(originalSlides.length/slidesPerSection);for(a=0;a<numOfSlides;a++){var slide=document.createElement('div');for(b=0;b<_.options.rows;b++){var row=document.createElement('div');for(c=0;c<_.options.slidesPerRow;c++){var target=(a*slidesPerSection+((b*_.options.slidesPerRow)+c));if(originalSlides.get(target)){row.appendChild(originalSlides.get(target));}}
slide.appendChild(row);}
newSlides.appendChild(slide);}
_.$slider.html(newSlides);_.$slider.children().children().children().css({'width':(100/_.options.slidesPerRow)+'%','display':'inline-block'});}};Slick.prototype.checkResponsive=function(initial,forceUpdate){var _=this,breakpoint,targetBreakpoint,respondToWidth,triggerBreakpoint=false;var sliderWidth=_.$slider.width();var windowWidth=window.innerWidth||$(window).width();if(_.respondTo==='window'){respondToWidth=windowWidth;}else if(_.respondTo==='slider'){respondToWidth=sliderWidth;}else if(_.respondTo==='min'){respondToWidth=Math.min(windowWidth,sliderWidth);}
if(_.options.responsive&&_.options.responsive.length&&_.options.responsive!==null){targetBreakpoint=null;for(breakpoint in _.breakpoints){if(_.breakpoints.hasOwnProperty(breakpoint)){if(_.originalSettings.mobileFirst===false){if(respondToWidth<_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}else{if(respondToWidth>_.breakpoints[breakpoint]){targetBreakpoint=_.breakpoints[breakpoint];}}}}
if(targetBreakpoint!==null){if(_.activeBreakpoint!==null){if(targetBreakpoint!==_.activeBreakpoint||forceUpdate){_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==='unslick'){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);}
triggerBreakpoint=targetBreakpoint;}}else{_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==='unslick'){_.unslick(targetBreakpoint);}else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);}
triggerBreakpoint=targetBreakpoint;}}else{if(_.activeBreakpoint!==null){_.activeBreakpoint=null;_.options=_.originalSettings;if(initial===true){_.currentSlide=_.options.initialSlide;}
_.refresh(initial);triggerBreakpoint=targetBreakpoint;}}
if(!initial&&triggerBreakpoint!==false){_.$slider.trigger('breakpoint',[_,triggerBreakpoint]);}}};Slick.prototype.changeSlide=function(event,dontAnimate){var _=this,$target=$(event.target),indexOffset,slideOffset,unevenOffset;if($target.is('a')){event.preventDefault();}
if(!$target.is('li')){$target=$target.closest('li');}
unevenOffset=(_.slideCount%_.options.slidesToScroll!==0);indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll;switch(event.data.message){case'previous':slideOffset=indexOffset===0?_.options.slidesToScroll:_.options.slidesToShow-indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide-slideOffset,false,dontAnimate);}
break;case'next':slideOffset=indexOffset===0?_.options.slidesToScroll:indexOffset;if(_.slideCount>_.options.slidesToShow){_.slideHandler(_.currentSlide+slideOffset,false,dontAnimate);}
break;case'index':var index=event.data.index===0?0:event.data.index||$target.index()*_.options.slidesToScroll;_.slideHandler(_.checkNavigable(index),false,dontAnimate);$target.children().trigger('focus');break;default:return;}};Slick.prototype.checkNavigable=function(index){var _=this,navigables,prevNavigable;navigables=_.getNavigableIndexes();prevNavigable=0;if(index>navigables[navigables.length-1]){index=navigables[navigables.length-1];}else{for(var n in navigables){if(index<navigables[n]){index=prevNavigable;break;}
prevNavigable=navigables[n];}}
return index;};Slick.prototype.cleanUpEvents=function(){var _=this;if(_.options.dots&&_.$dots!==null){$('li',_.$dots).off('click.slick',_.changeSlide);if(_.options.pauseOnDotsHover===true&&_.options.autoplay===true){$('li',_.$dots).off('mouseenter.slick',$.proxy(_.setPaused,_,true)).off('mouseleave.slick',$.proxy(_.setPaused,_,false));}}
if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow&&_.$prevArrow.off('click.slick',_.changeSlide);_.$nextArrow&&_.$nextArrow.off('click.slick',_.changeSlide);}
_.$list.off('touchstart.slick mousedown.slick',_.swipeHandler);_.$list.off('touchmove.slick mousemove.slick',_.swipeHandler);_.$list.off('touchend.slick mouseup.slick',_.swipeHandler);_.$list.off('touchcancel.slick mouseleave.slick',_.swipeHandler);_.$list.off('click.slick',_.clickHandler);$(document).off(_.visibilityChange,_.visibility);_.$list.off('mouseenter.slick',$.proxy(_.setPaused,_,true));_.$list.off('mouseleave.slick',$.proxy(_.setPaused,_,false));if(_.options.accessibility===true){_.$list.off('keydown.slick',_.keyHandler);}
if(_.options.focusOnSelect===true){$(_.$slideTrack).children().off('click.slick',_.selectHandler);}
$(window).off('orientationchange.slick.slick-'+_.instanceUid,_.orientationChange);$(window).off('resize.slick.slick-'+_.instanceUid,_.resize);$('[draggable!=true]',_.$slideTrack).off('dragstart',_.preventDefault);$(window).off('load.slick.slick-'+_.instanceUid,_.setPosition);$(document).off('ready.slick.slick-'+_.instanceUid,_.setPosition);};Slick.prototype.cleanUpRows=function(){var _=this,originalSlides;if(_.options.rows>1){originalSlides=_.$slides.children().children();originalSlides.removeAttr('style');_.$slider.html(originalSlides);}};Slick.prototype.clickHandler=function(event){var _=this;if(_.shouldClick===false){event.stopImmediatePropagation();event.stopPropagation();event.preventDefault();}};Slick.prototype.destroy=function(refresh){var _=this;_.autoPlayClear();_.touchObject={};_.cleanUpEvents();$('.slick-cloned',_.$slider).detach();if(_.$dots){_.$dots.remove();}
if(_.$prevArrow&&_.$prevArrow.length){_.$prevArrow.removeClass('slick-disabled slick-arrow slick-hidden').removeAttr('aria-hidden aria-disabled tabindex').css("display","");if(_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}}
if(_.$nextArrow&&_.$nextArrow.length){_.$nextArrow.removeClass('slick-disabled slick-arrow slick-hidden').removeAttr('aria-hidden aria-disabled tabindex').css("display","");if(_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}}
if(_.$slides){_.$slides.removeClass('slick-slide slick-active slick-center slick-visible slick-current').removeAttr('aria-hidden').removeAttr('data-slick-index').each(function(){$(this).attr('style',$(this).data('originalStyling'));});_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.detach();_.$list.detach();_.$slider.append(_.$slides);}
_.cleanUpRows();_.$slider.removeClass('slick-slider');_.$slider.removeClass('slick-initialized');_.unslicked=true;if(!refresh){_.$slider.trigger('destroy',[_]);}};Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]='';if(_.options.fade===false){_.$slideTrack.css(transition);}else{_.$slides.eq(slide).css(transition);}};Slick.prototype.fadeSlide=function(slideIndex,callback){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).css({zIndex:_.options.zIndex});_.$slides.eq(slideIndex).animate({opacity:1},_.options.speed,_.options.easing,callback);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:1,zIndex:_.options.zIndex});if(callback){setTimeout(function(){_.disableTransition(slideIndex);callback.call();},_.options.speed);}}};Slick.prototype.fadeSlideOut=function(slideIndex){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).animate({opacity:0,zIndex:_.options.zIndex-2},_.options.speed,_.options.easing);}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:0,zIndex:_.options.zIndex-2});}};Slick.prototype.filterSlides=Slick.prototype.slickFilter=function(filter){var _=this;if(filter!==null){_.$slidesCache=_.$slides;_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.filter(filter).appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.getCurrent=Slick.prototype.slickCurrentSlide=function(){var _=this;return _.currentSlide;};Slick.prototype.getDotCount=function(){var _=this;var breakPoint=0;var counter=0;var pagerQty=0;if(_.options.infinite===true){while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToShow;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}else if(_.options.centerMode===true){pagerQty=_.slideCount;}else{while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToShow;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}}
return pagerQty-1;};Slick.prototype.getLeft=function(slideIndex){var _=this,targetLeft,verticalHeight,verticalOffset=0,targetSlide;_.slideOffset=0;verticalHeight=_.$slides.first().outerHeight(true);if(_.options.infinite===true){if(_.slideCount>_.options.slidesToShow){_.slideOffset=(_.slideWidth*_.options.slidesToShow)*-1;verticalOffset=(verticalHeight*_.options.slidesToShow)*-1;}
if(_.slideCount%_.options.slidesToScroll!==0){if(slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow){if(slideIndex>_.slideCount){_.slideOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*_.slideWidth)*-1;verticalOffset=((_.options.slidesToShow-(slideIndex-_.slideCount))*verticalHeight)*-1;}else{_.slideOffset=((_.slideCount%_.options.slidesToScroll)*_.slideWidth)*-1;verticalOffset=((_.slideCount%_.options.slidesToScroll)*verticalHeight)*-1;}}}}else{if(slideIndex+_.options.slidesToShow>_.slideCount){_.slideOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*_.slideWidth;verticalOffset=((slideIndex+_.options.slidesToShow)-_.slideCount)*verticalHeight;}}
if(_.slideCount<=_.options.slidesToShow){_.slideOffset=0;verticalOffset=0;}
if(_.options.centerMode===true&&_.options.infinite===true){_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)-_.slideWidth;}else if(_.options.centerMode===true){_.slideOffset=0;_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2);}
if(_.options.vertical===false){targetLeft=((slideIndex*_.slideWidth)*-1)+_.slideOffset;}else{targetLeft=((slideIndex*verticalHeight)*-1)+verticalOffset;}
if(_.options.variableWidth===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex);}else{targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex+_.options.slidesToShow);}
targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;if(_.options.centerMode===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false){targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex);}else{targetSlide=_.$slideTrack.children('.slick-slide').eq(slideIndex+_.options.slidesToShow+1);}
targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;targetLeft+=(_.$list.width()-targetSlide.outerWidth())/2;}}
return targetLeft;};Slick.prototype.getOption=Slick.prototype.slickGetOption=function(option){var _=this;return _.options[option];};Slick.prototype.getNavigableIndexes=function(){var _=this,breakPoint=0,counter=0,indexes=[],max;if(_.options.infinite===false){max=_.slideCount;}else{breakPoint=_.options.slidesToScroll*-1;counter=_.options.slidesToScroll*-1;max=_.slideCount*2;}
while(breakPoint<max){indexes.push(breakPoint);breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow;}
return indexes;};Slick.prototype.getSlick=function(){return this;};Slick.prototype.getSlideCount=function(){var _=this,slidesTraversed,swipedSlide,centerOffset;centerOffset=_.options.centerMode===true?_.slideWidth*Math.floor(_.options.slidesToShow/2):0;if(_.options.swipeToSlide===true){_.$slideTrack.find('.slick-slide').each(function(index,slide){if(slide.offsetLeft-centerOffset+($(slide).outerWidth()/2)>(_.swipeLeft*-1)){swipedSlide=slide;return false;}});slidesTraversed=Math.abs($(swipedSlide).attr('data-slick-index')-_.currentSlide)||1;return slidesTraversed;}else{return _.options.slidesToScroll;}};Slick.prototype.goTo=Slick.prototype.slickGoTo=function(slide,dontAnimate){var _=this;_.changeSlide({data:{message:'index',index:parseInt(slide)}},dontAnimate);};Slick.prototype.init=function(creation){var _=this;if(!$(_.$slider).hasClass('slick-initialized')){$(_.$slider).addClass('slick-initialized');_.buildRows();_.buildOut();_.setProps();_.startLoad();_.loadSlider();_.initializeEvents();_.updateArrows();_.updateDots();}
if(creation){_.$slider.trigger('init',[_]);}
if(_.options.accessibility===true){_.initADA();}};Slick.prototype.initArrowEvents=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.on('click.slick',{message:'previous'},_.changeSlide);_.$nextArrow.on('click.slick',{message:'next'},_.changeSlide);}};Slick.prototype.initDotEvents=function(){var _=this;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){$('li',_.$dots).on('click.slick',{message:'index'},_.changeSlide);}
if(_.options.dots===true&&_.options.pauseOnDotsHover===true&&_.options.autoplay===true){$('li',_.$dots).on('mouseenter.slick',$.proxy(_.setPaused,_,true)).on('mouseleave.slick',$.proxy(_.setPaused,_,false));}};Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents();_.initDotEvents();_.$list.on('touchstart.slick mousedown.slick',{action:'start'},_.swipeHandler);_.$list.on('touchmove.slick mousemove.slick',{action:'move'},_.swipeHandler);_.$list.on('touchend.slick mouseup.slick',{action:'end'},_.swipeHandler);_.$list.on('touchcancel.slick mouseleave.slick',{action:'end'},_.swipeHandler);_.$list.on('click.slick',_.clickHandler);$(document).on(_.visibilityChange,$.proxy(_.visibility,_));_.$list.on('mouseenter.slick',$.proxy(_.setPaused,_,true));_.$list.on('mouseleave.slick',$.proxy(_.setPaused,_,false));if(_.options.accessibility===true){_.$list.on('keydown.slick',_.keyHandler);}
if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on('click.slick',_.selectHandler);}
$(window).on('orientationchange.slick.slick-'+_.instanceUid,$.proxy(_.orientationChange,_));$(window).on('resize.slick.slick-'+_.instanceUid,$.proxy(_.resize,_));$('[draggable!=true]',_.$slideTrack).on('dragstart',_.preventDefault);$(window).on('load.slick.slick-'+_.instanceUid,_.setPosition);$(document).on('ready.slick.slick-'+_.instanceUid,_.setPosition);};Slick.prototype.initUI=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.show();_.$nextArrow.show();}
if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.show();}
if(_.options.autoplay===true){_.autoPlay();}};Slick.prototype.keyHandler=function(event){var _=this;if(!event.target.tagName.match('TEXTAREA|INPUT|SELECT')){if(event.keyCode===37&&_.options.accessibility===true){_.changeSlide({data:{message:'previous'}});}else if(event.keyCode===39&&_.options.accessibility===true){_.changeSlide({data:{message:'next'}});}}};Slick.prototype.lazyLoad=function(){var _=this,loadRange,cloneRange,rangeStart,rangeEnd;function loadImages(imagesScope){$('img[data-lazy]',imagesScope).each(function(){var image=$(this),imageSource=$(this).attr('data-lazy'),imageToLoad=document.createElement('img');imageToLoad.onload=function(){image.animate({opacity:0},100,function(){image.attr('src',imageSource).animate({opacity:1},200,function(){image.removeAttr('data-lazy').removeClass('slick-loading');});});};imageToLoad.src=imageSource;});}
if(_.options.centerMode===true){if(_.options.infinite===true){rangeStart=_.currentSlide+(_.options.slidesToShow/2+1);rangeEnd=rangeStart+_.options.slidesToShow+2;}else{rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow/2+1));rangeEnd=2+(_.options.slidesToShow/2+1)+_.currentSlide;}}else{rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide;rangeEnd=rangeStart+_.options.slidesToShow;if(_.options.fade===true){if(rangeStart>0)rangeStart--;if(rangeEnd<=_.slideCount)rangeEnd++;}}
loadRange=_.$slider.find('.slick-slide').slice(rangeStart,rangeEnd);loadImages(loadRange);if(_.slideCount<=_.options.slidesToShow){cloneRange=_.$slider.find('.slick-slide');loadImages(cloneRange);}else
if(_.currentSlide>=_.slideCount-_.options.slidesToShow){cloneRange=_.$slider.find('.slick-cloned').slice(0,_.options.slidesToShow);loadImages(cloneRange);}else if(_.currentSlide===0){cloneRange=_.$slider.find('.slick-cloned').slice(_.options.slidesToShow*-1);loadImages(cloneRange);}};Slick.prototype.loadSlider=function(){var _=this;_.setPosition();_.$slideTrack.css({opacity:1});_.$slider.removeClass('slick-loading');_.initUI();if(_.options.lazyLoad==='progressive'){_.progressiveLazyLoad();}};Slick.prototype.next=Slick.prototype.slickNext=function(){var _=this;_.changeSlide({data:{message:'next'}});};Slick.prototype.orientationChange=function(){var _=this;_.checkResponsive();_.setPosition();};Slick.prototype.pause=Slick.prototype.slickPause=function(){var _=this;_.autoPlayClear();_.paused=true;};Slick.prototype.play=Slick.prototype.slickPlay=function(){var _=this;_.paused=false;_.autoPlay();};Slick.prototype.postSlide=function(index){var _=this;_.$slider.trigger('afterChange',[_,index]);_.animating=false;_.setPosition();_.swipeLeft=null;if(_.options.autoplay===true&&_.paused===false){_.autoPlay();}
if(_.options.accessibility===true){_.initADA();}};Slick.prototype.prev=Slick.prototype.slickPrev=function(){var _=this;_.changeSlide({data:{message:'previous'}});};Slick.prototype.preventDefault=function(event){event.preventDefault();};Slick.prototype.progressiveLazyLoad=function(){var _=this,imgCount,targetImage;imgCount=$('img[data-lazy]',_.$slider).length;if(imgCount>0){targetImage=$('img[data-lazy]',_.$slider).first();targetImage.attr('src',null);targetImage.attr('src',targetImage.attr('data-lazy')).removeClass('slick-loading').load(function(){targetImage.removeAttr('data-lazy');_.progressiveLazyLoad();if(_.options.adaptiveHeight===true){_.setPosition();}}).error(function(){targetImage.removeAttr('data-lazy');_.progressiveLazyLoad();});}};Slick.prototype.refresh=function(initializing){var _=this,currentSlide,firstVisible;firstVisible=_.slideCount-_.options.slidesToShow;if(!_.options.infinite){if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}else if(_.currentSlide>firstVisible){_.currentSlide=firstVisible;}}
currentSlide=_.currentSlide;_.destroy(true);$.extend(_,_.initials,{currentSlide:currentSlide});_.init();if(!initializing){_.changeSlide({data:{message:'index',index:currentSlide}},false);}};Slick.prototype.registerBreakpoints=function(){var _=this,breakpoint,currentBreakpoint,l,responsiveSettings=_.options.responsive||null;if($.type(responsiveSettings)==="array"&&responsiveSettings.length){_.respondTo=_.options.respondTo||'window';for(breakpoint in responsiveSettings){l=_.breakpoints.length-1;currentBreakpoint=responsiveSettings[breakpoint].breakpoint;if(responsiveSettings.hasOwnProperty(breakpoint)){while(l>=0){if(_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint){_.breakpoints.splice(l,1);}
l--;}
_.breakpoints.push(currentBreakpoint);_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].settings;}}
_.breakpoints.sort(function(a,b){return(_.options.mobileFirst)?a-b:b-a;});}};Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass('slick-slide');_.slideCount=_.$slides.length;if(_.currentSlide>=_.slideCount&&_.currentSlide!==0){_.currentSlide=_.currentSlide-_.options.slidesToScroll;}
if(_.slideCount<=_.options.slidesToShow){_.currentSlide=0;}
_.registerBreakpoints();_.setProps();_.setupInfinite();_.buildArrows();_.updateArrows();_.initArrowEvents();_.buildDots();_.updateDots();_.initDotEvents();_.checkResponsive(false,true);if(_.options.focusOnSelect===true){$(_.$slideTrack).children().on('click.slick',_.selectHandler);}
_.setSlideClasses(0);_.setPosition();_.$slider.trigger('reInit',[_]);if(_.options.autoplay===true){_.focusHandler();}};Slick.prototype.resize=function(){var _=this;if($(window).width()!==_.windowWidth){clearTimeout(_.windowDelay);_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width();_.checkResponsive();if(!_.unslicked){_.setPosition();}},50);}};Slick.prototype.removeSlide=Slick.prototype.slickRemove=function(index,removeBefore,removeAll){var _=this;if(typeof(index)==='boolean'){removeBefore=index;index=removeBefore===true?0:_.slideCount-1;}else{index=removeBefore===true?--index:index;}
if(_.slideCount<1||index<0||index>_.slideCount-1){return false;}
_.unload();if(removeAll===true){_.$slideTrack.children().remove();}else{_.$slideTrack.children(this.options.slide).eq(index).remove();}
_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slidesCache=_.$slides;_.reinit();};Slick.prototype.setCSS=function(position){var _=this,positionProps={},x,y;if(_.options.rtl===true){position=-position;}
x=_.positionProp=='left'?Math.ceil(position)+'px':'0px';y=_.positionProp=='top'?Math.ceil(position)+'px':'0px';positionProps[_.positionProp]=position;if(_.transformsEnabled===false){_.$slideTrack.css(positionProps);}else{positionProps={};if(_.cssTransitions===false){positionProps[_.animType]='translate('+x+', '+y+')';_.$slideTrack.css(positionProps);}else{positionProps[_.animType]='translate3d('+x+', '+y+', 0px)';_.$slideTrack.css(positionProps);}}};Slick.prototype.setDimensions=function(){var _=this;if(_.options.vertical===false){if(_.options.centerMode===true){_.$list.css({padding:('0px '+_.options.centerPadding)});}}else{_.$list.height(_.$slides.first().outerHeight(true)*_.options.slidesToShow);if(_.options.centerMode===true){_.$list.css({padding:(_.options.centerPadding+' 0px')});}}
_.listWidth=_.$list.width();_.listHeight=_.$list.height();if(_.options.vertical===false&&_.options.variableWidth===false){_.slideWidth=Math.ceil(_.listWidth/_.options.slidesToShow);_.$slideTrack.width(Math.ceil((_.slideWidth*_.$slideTrack.children('.slick-slide').length)));}else if(_.options.variableWidth===true){_.$slideTrack.width(5000*_.slideCount);}else{_.slideWidth=Math.ceil(_.listWidth);_.$slideTrack.height(Math.ceil((_.$slides.first().outerHeight(true)*_.$slideTrack.children('.slick-slide').length)));}
var offset=_.$slides.first().outerWidth(true)-_.$slides.first().width();if(_.options.variableWidth===false)_.$slideTrack.children('.slick-slide').width(_.slideWidth-offset);};Slick.prototype.setFade=function(){var _=this,targetLeft;_.$slides.each(function(index,element){targetLeft=(_.slideWidth*index)*-1;if(_.options.rtl===true){$(element).css({position:'relative',right:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}else{$(element).css({position:'relative',left:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});}});_.$slides.eq(_.currentSlide).css({zIndex:_.options.zIndex-1,opacity:1});};Slick.prototype.setHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.css('height',targetHeight);}};Slick.prototype.setOption=Slick.prototype.slickSetOption=function(option,value,refresh){var _=this,l,item;if(option==="responsive"&&$.type(value)==="array"){for(item in value){if($.type(_.options.responsive)!=="array"){_.options.responsive=[value[item]];}else{l=_.options.responsive.length-1;while(l>=0){if(_.options.responsive[l].breakpoint===value[item].breakpoint){_.options.responsive.splice(l,1);}
l--;}
_.options.responsive.push(value[item]);}}}else{_.options[option]=value;}
if(refresh===true){_.unload();_.reinit();}};Slick.prototype.setPosition=function(){var _=this;_.setDimensions();_.setHeight();if(_.options.fade===false){_.setCSS(_.getLeft(_.currentSlide));}else{_.setFade();}
_.$slider.trigger('setPosition',[_]);};Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===true?'top':'left';if(_.positionProp==='top'){_.$slider.addClass('slick-vertical');}else{_.$slider.removeClass('slick-vertical');}
if(bodyStyle.WebkitTransition!==undefined||bodyStyle.MozTransition!==undefined||bodyStyle.msTransition!==undefined){if(_.options.useCSS===true){_.cssTransitions=true;}}
if(_.options.fade){if(typeof _.options.zIndex==='number'){if(_.options.zIndex<3){_.options.zIndex=3;}}else{_.options.zIndex=_.defaults.zIndex;}}
if(bodyStyle.OTransform!==undefined){_.animType='OTransform';_.transformType='-o-transform';_.transitionType='OTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false;}
if(bodyStyle.MozTransform!==undefined){_.animType='MozTransform';_.transformType='-moz-transform';_.transitionType='MozTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.MozPerspective===undefined)_.animType=false;}
if(bodyStyle.webkitTransform!==undefined){_.animType='webkitTransform';_.transformType='-webkit-transform';_.transitionType='webkitTransition';if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false;}
if(bodyStyle.msTransform!==undefined){_.animType='msTransform';_.transformType='-ms-transform';_.transitionType='msTransition';if(bodyStyle.msTransform===undefined)_.animType=false;}
if(bodyStyle.transform!==undefined&&_.animType!==false){_.animType='transform';_.transformType='transform';_.transitionType='transition';}
_.transformsEnabled=_.options.useTransform&&(_.animType!==null&&_.animType!==false);};Slick.prototype.setSlideClasses=function(index){var _=this,centerOffset,allSlides,indexOffset,remainder;allSlides=_.$slider.find('.slick-slide').removeClass('slick-active slick-center slick-current').attr('aria-hidden','true');_.$slides.eq(index).addClass('slick-current');if(_.options.centerMode===true){centerOffset=Math.floor(_.options.slidesToShow/2);if(_.options.infinite===true){if(index>=centerOffset&&index<=(_.slideCount-1)-centerOffset){_.$slides.slice(index-centerOffset,index+centerOffset+1).addClass('slick-active').attr('aria-hidden','false');}else{indexOffset=_.options.slidesToShow+index;allSlides.slice(indexOffset-centerOffset+1,indexOffset+centerOffset+2).addClass('slick-active').attr('aria-hidden','false');}
if(index===0){allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass('slick-center');}else if(index===_.slideCount-1){allSlides.eq(_.options.slidesToShow).addClass('slick-center');}}
_.$slides.eq(index).addClass('slick-center');}else{if(index>=0&&index<=(_.slideCount-_.options.slidesToShow)){_.$slides.slice(index,index+_.options.slidesToShow).addClass('slick-active').attr('aria-hidden','false');}else if(allSlides.length<=_.options.slidesToShow){allSlides.addClass('slick-active').attr('aria-hidden','false');}else{remainder=_.slideCount%_.options.slidesToShow;indexOffset=_.options.infinite===true?_.options.slidesToShow+index:index;if(_.options.slidesToShow==_.options.slidesToScroll&&(_.slideCount-index)<_.options.slidesToShow){allSlides.slice(indexOffset-(_.options.slidesToShow-remainder),indexOffset+remainder).addClass('slick-active').attr('aria-hidden','false');}else{allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass('slick-active').attr('aria-hidden','false');}}}
if(_.options.lazyLoad==='ondemand'){_.lazyLoad();}};Slick.prototype.setupInfinite=function(){var _=this,i,slideIndex,infiniteCount;if(_.options.fade===true){_.options.centerMode=false;}
if(_.options.infinite===true&&_.options.fade===false){slideIndex=null;if(_.slideCount>_.options.slidesToShow){if(_.options.centerMode===true){infiniteCount=_.options.slidesToShow+1;}else{infiniteCount=_.options.slidesToShow;}
for(i=_.slideCount;i>(_.slideCount-
infiniteCount);i-=1){slideIndex=i-1;$(_.$slides[slideIndex]).clone(true).attr('id','').attr('data-slick-index',slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass('slick-cloned');}
for(i=0;i<infiniteCount;i+=1){slideIndex=i;$(_.$slides[slideIndex]).clone(true).attr('id','').attr('data-slick-index',slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass('slick-cloned');}
_.$slideTrack.find('.slick-cloned').find('[id]').each(function(){$(this).attr('id','');});}}};Slick.prototype.setPaused=function(paused){var _=this;if(_.options.autoplay===true&&_.options.pauseOnHover===true){_.paused=paused;if(!paused){_.autoPlay();}else{_.autoPlayClear();}}};Slick.prototype.selectHandler=function(event){var _=this;var targetElement=$(event.target).is('.slick-slide')?$(event.target):$(event.target).parents('.slick-slide');var index=parseInt(targetElement.attr('data-slick-index'));if(!index)index=0;if(_.slideCount<=_.options.slidesToShow){_.setSlideClasses(index);_.asNavFor(index);return;}
_.slideHandler(index);};Slick.prototype.slideHandler=function(index,sync,dontAnimate){var targetSlide,animSlide,oldSlide,slideLeft,targetLeft=null,_=this;sync=sync||false;if(_.animating===true&&_.options.waitForAnimate===true){return;}
if(_.options.fade===true&&_.currentSlide===index){return;}
if(_.slideCount<=_.options.slidesToShow){return;}
if(sync===false){_.asNavFor(index);}
targetSlide=index;targetLeft=_.getLeft(targetSlide);slideLeft=_.getLeft(_.currentSlide);_.currentLeft=_.swipeLeft===null?slideLeft:_.swipeLeft;if(_.options.infinite===false&&_.options.centerMode===false&&(index<0||index>_.getDotCount()*_.options.slidesToScroll)){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}
return;}else if(_.options.infinite===false&&_.options.centerMode===true&&(index<0||index>(_.slideCount-_.options.slidesToScroll))){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true){_.animateSlide(slideLeft,function(){_.postSlide(targetSlide);});}else{_.postSlide(targetSlide);}}
return;}
if(_.options.autoplay===true){clearInterval(_.autoPlayTimer);}
if(targetSlide<0){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=_.slideCount-(_.slideCount%_.options.slidesToScroll);}else{animSlide=_.slideCount+targetSlide;}}else if(targetSlide>=_.slideCount){if(_.slideCount%_.options.slidesToScroll!==0){animSlide=0;}else{animSlide=targetSlide-_.slideCount;}}else{animSlide=targetSlide;}
_.animating=true;_.$slider.trigger('beforeChange',[_,_.currentSlide,animSlide]);oldSlide=_.currentSlide;_.currentSlide=animSlide;_.setSlideClasses(_.currentSlide);_.updateDots();_.updateArrows();if(_.options.fade===true){if(dontAnimate!==true){_.fadeSlideOut(oldSlide);_.fadeSlide(animSlide,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}
_.animateHeight();return;}
if(dontAnimate!==true){_.animateSlide(targetLeft,function(){_.postSlide(animSlide);});}else{_.postSlide(animSlide);}};Slick.prototype.startLoad=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.hide();_.$nextArrow.hide();}
if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$dots.hide();}
_.$slider.addClass('slick-loading');};Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;xDist=_.touchObject.startX-_.touchObject.curX;yDist=_.touchObject.startY-_.touchObject.curY;r=Math.atan2(yDist,xDist);swipeAngle=Math.round(r*180/Math.PI);if(swipeAngle<0){swipeAngle=360-Math.abs(swipeAngle);}
if((swipeAngle<=45)&&(swipeAngle>=0)){return(_.options.rtl===false?'left':'right');}
if((swipeAngle<=360)&&(swipeAngle>=315)){return(_.options.rtl===false?'left':'right');}
if((swipeAngle>=135)&&(swipeAngle<=225)){return(_.options.rtl===false?'right':'left');}
if(_.options.verticalSwiping===true){if((swipeAngle>=35)&&(swipeAngle<=135)){return'left';}else{return'right';}}
return'vertical';};Slick.prototype.swipeEnd=function(event){var _=this,slideCount;_.dragging=false;_.shouldClick=(_.touchObject.swipeLength>10)?false:true;if(_.touchObject.curX===undefined){return false;}
if(_.touchObject.edgeHit===true){_.$slider.trigger('edge',[_,_.swipeDirection()]);}
if(_.touchObject.swipeLength>=_.touchObject.minSwipe){switch(_.swipeDirection()){case'left':slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide+_.getSlideCount()):_.currentSlide+_.getSlideCount();_.slideHandler(slideCount);_.currentDirection=0;_.touchObject={};_.$slider.trigger('swipe',[_,'left']);break;case'right':slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide-_.getSlideCount()):_.currentSlide-_.getSlideCount();_.slideHandler(slideCount);_.currentDirection=1;_.touchObject={};_.$slider.trigger('swipe',[_,'right']);break;}}else{if(_.touchObject.startX!==_.touchObject.curX){_.slideHandler(_.currentSlide);_.touchObject={};}}};Slick.prototype.swipeHandler=function(event){var _=this;if((_.options.swipe===false)||('ontouchend'in document&&_.options.swipe===false)){return;}else if(_.options.draggable===false&&event.type.indexOf('mouse')!==-1){return;}
_.touchObject.fingerCount=event.originalEvent&&event.originalEvent.touches!==undefined?event.originalEvent.touches.length:1;_.touchObject.minSwipe=_.listWidth/_.options.touchThreshold;if(_.options.verticalSwiping===true){_.touchObject.minSwipe=_.listHeight/_.options.touchThreshold;}
switch(event.data.action){case'start':_.swipeStart(event);break;case'move':_.swipeMove(event);break;case'end':_.swipeEnd(event);break;}};Slick.prototype.swipeMove=function(event){var _=this,edgeWasHit=false,curLeft,swipeDirection,swipeLength,positionOffset,touches;touches=event.originalEvent!==undefined?event.originalEvent.touches:null;if(!_.dragging||touches&&touches.length!==1){return false;}
curLeft=_.getLeft(_.currentSlide);_.touchObject.curX=touches!==undefined?touches[0].pageX:event.clientX;_.touchObject.curY=touches!==undefined?touches[0].pageY:event.clientY;_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-_.touchObject.startX,2)));if(_.options.verticalSwiping===true){_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curY-_.touchObject.startY,2)));}
swipeDirection=_.swipeDirection();if(swipeDirection==='vertical'){return;}
if(event.originalEvent!==undefined&&_.touchObject.swipeLength>4){event.preventDefault();}
positionOffset=(_.options.rtl===false?1:-1)*(_.touchObject.curX>_.touchObject.startX?1:-1);if(_.options.verticalSwiping===true){positionOffset=_.touchObject.curY>_.touchObject.startY?1:-1;}
swipeLength=_.touchObject.swipeLength;_.touchObject.edgeHit=false;if(_.options.infinite===false){if((_.currentSlide===0&&swipeDirection==='right')||(_.currentSlide>=_.getDotCount()&&swipeDirection==='left')){swipeLength=_.touchObject.swipeLength*_.options.edgeFriction;_.touchObject.edgeHit=true;}}
if(_.options.vertical===false){_.swipeLeft=curLeft+swipeLength*positionOffset;}else{_.swipeLeft=curLeft+(swipeLength*(_.$list.height()/_.listWidth))*positionOffset;}
if(_.options.verticalSwiping===true){_.swipeLeft=curLeft+swipeLength*positionOffset;}
if(_.options.fade===true||_.options.touchMove===false){return false;}
if(_.animating===true){_.swipeLeft=null;return false;}
_.setCSS(_.swipeLeft);};Slick.prototype.swipeStart=function(event){var _=this,touches;if(_.touchObject.fingerCount!==1||_.slideCount<=_.options.slidesToShow){_.touchObject={};return false;}
if(event.originalEvent!==undefined&&event.originalEvent.touches!==undefined){touches=event.originalEvent.touches[0];}
_.touchObject.startX=_.touchObject.curX=touches!==undefined?touches.pageX:event.clientX;_.touchObject.startY=_.touchObject.curY=touches!==undefined?touches.pageY:event.clientY;_.dragging=true;};Slick.prototype.unfilterSlides=Slick.prototype.slickUnfilter=function(){var _=this;if(_.$slidesCache!==null){_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.appendTo(_.$slideTrack);_.reinit();}};Slick.prototype.unload=function(){var _=this;$('.slick-cloned',_.$slider).remove();if(_.$dots){_.$dots.remove();}
if(_.$prevArrow&&_.htmlExpr.test(_.options.prevArrow)){_.$prevArrow.remove();}
if(_.$nextArrow&&_.htmlExpr.test(_.options.nextArrow)){_.$nextArrow.remove();}
_.$slides.removeClass('slick-slide slick-active slick-visible slick-current').attr('aria-hidden','true').css('width','');};Slick.prototype.unslick=function(fromBreakpoint){var _=this;_.$slider.trigger('unslick',[_,fromBreakpoint]);_.destroy();};Slick.prototype.updateArrows=function(){var _=this,centerOffset;centerOffset=Math.floor(_.options.slidesToShow/2);if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow&&!_.options.infinite){_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');_.$nextArrow.removeClass('slick-disabled').attr('aria-disabled','false');if(_.currentSlide===0){_.$prevArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$nextArrow.removeClass('slick-disabled').attr('aria-disabled','false');}else if(_.currentSlide>=_.slideCount-_.options.slidesToShow&&_.options.centerMode===false){_.$nextArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');}else if(_.currentSlide>=_.slideCount-1&&_.options.centerMode===true){_.$nextArrow.addClass('slick-disabled').attr('aria-disabled','true');_.$prevArrow.removeClass('slick-disabled').attr('aria-disabled','false');}}};Slick.prototype.updateDots=function(){var _=this;if(_.$dots!==null){_.$dots.find('li').removeClass('slick-active').attr('aria-hidden','true');_.$dots.find('li').eq(Math.floor(_.currentSlide/_.options.slidesToScroll)).addClass('slick-active').attr('aria-hidden','false');}};Slick.prototype.visibility=function(){var _=this;if(document[_.hidden]){_.paused=true;_.autoPlayClear();}else{if(_.options.autoplay===true){_.paused=false;_.autoPlay();}}};Slick.prototype.initADA=function(){var _=this;_.$slides.add(_.$slideTrack.find('.slick-cloned')).attr({'aria-hidden':'true','tabindex':'-1'}).find('a, input, button, select').attr({'tabindex':'-1'});_.$slideTrack.attr('role','listbox');_.$slides.not(_.$slideTrack.find('.slick-cloned')).each(function(i){$(this).attr({'role':'option','aria-describedby':'slick-slide'+_.instanceUid+i+''});});if(_.$dots!==null){_.$dots.attr('role','tablist').find('li').each(function(i){$(this).attr({'role':'presentation','aria-selected':'false','aria-controls':'navigation'+_.instanceUid+i+'','id':'slick-slide'+_.instanceUid+i+''});}).first().attr('aria-selected','true').end().find('button').attr('role','button').end().closest('div').attr('role','toolbar');}
_.activateADA();};Slick.prototype.activateADA=function(){var _=this;_.$slideTrack.find('.slick-active').attr({'aria-hidden':'false'}).find('a, input, button, select').attr({'tabindex':'0'});};Slick.prototype.focusHandler=function(){var _=this;_.$slider.on('focus.slick blur.slick','*',function(event){event.stopImmediatePropagation();var sf=$(this);setTimeout(function(){if(_.isPlay){if(sf.is(':focus')){_.autoPlayClear();_.paused=true;}else{_.paused=false;_.autoPlay();}}},0);});};$.fn.slick=function(){var _=this,opt=arguments[0],args=Array.prototype.slice.call(arguments,1),l=_.length,i,ret;for(i=0;i<l;i++){if(typeof opt=='object'||typeof opt=='undefined')
_[i].slick=new Slick(_[i],opt);else
ret=_[i].slick[opt].apply(_[i].slick,args);if(typeof ret!='undefined')return ret;}
return _;};}));!function($){"use strict";var TabCollapse=function(el,options){this.options=options;this.$tabs=$(el);this._accordionVisible=false;this._initAccordion();this._checkStateOnResize();var that=this;setTimeout(function(){that.checkState();},0);};TabCollapse.DEFAULTS={accordionClass:'visible-xs',tabsClass:'hidden-xs',accordionTemplate:function(heading,groupId,parentId,active){return'<div class="panel panel-info">'+'   <div class="panel-heading">'+'      <h4 class="panel-title">'+'      </h4>'+'      <span class="pull-right"><i class="fa fa-'+(active?'chevron-up':'chevron-down')+'" aria-hidden="true"></i></span>'+'   </div>'+'   <div id="'+groupId+'" class="panel-collapse collapse '+(active?'in':'')+'">'+'       <div class="panel-body js-tabcollapse-panel-body">'+'       </div>'+'   </div>'+'</div>'}};TabCollapse.prototype.checkState=function(){if(this.$tabs.is(':visible')&&this._accordionVisible){this.showTabs();this._accordionVisible=false;}else if(this.$accordion.is(':visible')&&!this._accordionVisible){this.showAccordion();this._accordionVisible=true;}};TabCollapse.prototype.showTabs=function(){var view=this;this.$tabs.trigger($.Event('show-tabs.bs.tabcollapse'));this.$tabs.parent().addClass('panel-body');this.$tabs.parent().parent().addClass('panel panel-default');var $panelHeadings=this.$accordion.find('.js-tabcollapse-panel-heading').detach();$panelHeadings.each(function(){var $panelHeading=$(this),$parentLi=$panelHeading.data('bs.tabcollapse.parentLi');var $oldHeading=view._panelHeadingToTabHeading($panelHeading);$parentLi.removeClass('active');if($parentLi.parent().hasClass('dropdown-menu')&&!$parentLi.siblings('li').hasClass('active')){$parentLi.parent().parent().removeClass('active');}
if(!$oldHeading.hasClass('collapsed')){$parentLi.addClass('active');if($parentLi.parent().hasClass('dropdown-menu')){$parentLi.parent().parent().addClass('active');}}else{$oldHeading.removeClass('collapsed');}
$parentLi.append($panelHeading);});if(!$('li').hasClass('active')){$('li').first().addClass('active')}
var $panelBodies=this.$accordion.find('.js-tabcollapse-panel-body');$panelBodies.each(function(){var $panelBody=$(this),$tabPane=$panelBody.data('bs.tabcollapse.tabpane');$tabPane.append($panelBody.contents().detach());});this.$accordion.html('');if(this.options.updateLinks){var $tabContents=this.getTabContentElement();$tabContents.find('[data-toggle-was="tab"], [data-toggle-was="pill"]').each(function(){var $el=$(this);var href=$el.attr('href').replace(/-collapse$/g,'');$el.attr({'data-toggle':$el.attr('data-toggle-was'),'data-toggle-was':'','data-parent':'',href:href});});}
this.$tabs.trigger($.Event('shown-tabs.bs.tabcollapse'));};TabCollapse.prototype.getTabContentElement=function(){var $tabContents=$(this.options.tabContentSelector);if($tabContents.length===0){$tabContents=this.$tabs.siblings('.tab-content');}
return $tabContents;};TabCollapse.prototype.showAccordion=function(){this.$tabs.parent().removeClass('panel-body');this.$tabs.parent().parent().removeClass('panel panel-default');this.$tabs.trigger($.Event('show-accordion.bs.tabcollapse'));var $headings=this.$tabs.find('li:not(.dropdown) [data-toggle="tab"], li:not(.dropdown) [data-toggle="pill"]'),view=this;$headings.each(function(){var $heading=$(this),$parentLi=$heading.parent();$heading.data('bs.tabcollapse.parentLi',$parentLi);view.$accordion.append(view._createAccordionGroup(view.$accordion.attr('id'),$heading.detach()));});if(this.options.updateLinks){var parentId=this.$accordion.attr('id');var $selector=this.$accordion.find('.js-tabcollapse-panel-body');$selector.find('[data-toggle="tab"], [data-toggle="pill"]').each(function(){var $el=$(this);var href=$el.attr('href')+'-collapse';$el.attr({'data-toggle-was':$el.attr('data-toggle'),'data-toggle':'collapse','data-parent':'#'+parentId,href:href});});}
this.$tabs.trigger($.Event('shown-accordion.bs.tabcollapse'));};TabCollapse.prototype._panelHeadingToTabHeading=function($heading){var href=$heading.attr('href').replace(/-collapse$/g,'');$heading.attr({'data-toggle':'tab','href':href,'data-parent':''});return $heading;};TabCollapse.prototype._tabHeadingToPanelHeading=function($heading,groupId,parentId,active){$heading.addClass('js-tabcollapse-panel-heading btn-block '+(active?'':'collapsed'));$heading.attr({'data-toggle':'collapse','data-parent':'#'+parentId,'href':'#'+groupId});return $heading;};TabCollapse.prototype._checkStateOnResize=function(){var view=this;$(window).resize(function(){clearTimeout(view._resizeTimeout);view._resizeTimeout=setTimeout(function(){view.checkState();},100);});};TabCollapse.prototype._initAccordion=function(){var randomString=function(){var result="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<5;i++){result+=possible.charAt(Math.floor(Math.random()*possible.length));}
return result;};var srcId=this.$tabs.attr('id'),accordionId=(srcId?srcId:randomString())+'-accordion';this.$accordion=$('<div class="panel-group '+this.options.accordionClass+'" id="'+accordionId+'"></div>');this.$tabs.after(this.$accordion);this.$tabs.addClass(this.options.tabsClass);this.getTabContentElement().addClass(this.options.tabsClass);};TabCollapse.prototype._createAccordionGroup=function(parentId,$heading){var tabSelector=$heading.attr('data-target'),active=$heading.data('bs.tabcollapse.parentLi').is('.active');if(!tabSelector){tabSelector=$heading.attr('href');tabSelector=tabSelector&&tabSelector.replace(/.*(?=#[^\s]*$)/,'');}
var $tabPane=$(tabSelector),groupId=$tabPane.attr('id')+'-collapse',$panel=$(this.options.accordionTemplate($heading,groupId,parentId,active));$panel.find('.panel-heading > .panel-title').append(this._tabHeadingToPanelHeading($heading,groupId,parentId,active));$panel.find('.panel-body').append($tabPane.contents().detach()).data('bs.tabcollapse.tabpane',$tabPane);return $panel;};$.fn.tabCollapse=function(option){console.log('option',option);return this.each(function(){var $this=$(this);var data=$this.data('bs.tabcollapse');var options=$.extend({},TabCollapse.DEFAULTS,$this.data(),typeof option==='object'&&option);if(!data)$this.data('bs.tabcollapse',new TabCollapse(this,options));});};$.fn.tabCollapse.Constructor=TabCollapse;}(window.jQuery);
(function(){var slice=[].slice;(function($,window){"use strict";var BootstrapSwitch;BootstrapSwitch=(function(){function BootstrapSwitch(element,options){if(options==null){options={};}
this.$element=$(element);this.options=$.extend({},$.fn.bootstrapSwitch.defaults,{state:this.$element.is(":checked"),size:this.$element.data("size"),animate:this.$element.data("animate"),disabled:this.$element.is(":disabled"),readonly:this.$element.is("[readonly]"),indeterminate:this.$element.data("indeterminate"),inverse:this.$element.data("inverse"),radioAllOff:this.$element.data("radio-all-off"),onColor:this.$element.data("on-color"),offColor:this.$element.data("off-color"),onText:this.$element.data("on-text"),offText:this.$element.data("off-text"),labelText:this.$element.data("label-text"),handleWidth:this.$element.data("handle-width"),labelWidth:this.$element.data("label-width"),baseClass:this.$element.data("base-class"),wrapperClass:this.$element.data("wrapper-class")},options);this.prevOptions={};this.$wrapper=$("<div>",{"class":(function(_this){return function(){var classes;classes=[""+_this.options.baseClass].concat(_this._getClasses(_this.options.wrapperClass));classes.push(_this.options.state?_this.options.baseClass+"-on":_this.options.baseClass+"-off");if(_this.options.size!=null){classes.push(_this.options.baseClass+"-"+_this.options.size);}
if(_this.options.disabled){classes.push(_this.options.baseClass+"-disabled");}
if(_this.options.readonly){classes.push(_this.options.baseClass+"-readonly");}
if(_this.options.indeterminate){classes.push(_this.options.baseClass+"-indeterminate");}
if(_this.options.inverse){classes.push(_this.options.baseClass+"-inverse");}
if(_this.$element.attr("id")){classes.push(_this.options.baseClass+"-id-"+(_this.$element.attr("id")));}
return classes.join(" ");};})(this)()});this.$container=$("<div>",{"class":this.options.baseClass+"-container"});this.$on=$("<span>",{html:this.options.onText,"class":this.options.baseClass+"-handle-on "+this.options.baseClass+"-"+this.options.onColor});this.$off=$("<span>",{html:this.options.offText,"class":this.options.baseClass+"-handle-off "+this.options.baseClass+"-"+this.options.offColor});this.$label=$("<span>",{html:this.options.labelText,"class":this.options.baseClass+"-label"});this.$element.on("init.bootstrapSwitch",(function(_this){return function(){return _this.options.onInit.apply(element,arguments);};})(this));this.$element.on("switchChange.bootstrapSwitch",(function(_this){return function(e){if(false===_this.options.onSwitchChange.apply(element,arguments)){if(_this.$element.is(":radio")){return $("[name='"+(_this.$element.attr('name'))+"']").trigger("previousState.bootstrapSwitch",true);}else{return _this.$element.trigger("previousState.bootstrapSwitch",true);}}};})(this));this.$container=this.$element.wrap(this.$container).parent();this.$wrapper=this.$container.wrap(this.$wrapper).parent();this.$element.before(this.options.inverse?this.$off:this.$on).before(this.$label).before(this.options.inverse?this.$on:this.$off);if(this.options.indeterminate){this.$element.prop("indeterminate",true);}
this._init();this._elementHandlers();this._handleHandlers();this._labelHandlers();this._formHandler();this._externalLabelHandler();this.$element.trigger("init.bootstrapSwitch",this.options.state);}
BootstrapSwitch.prototype._constructor=BootstrapSwitch;BootstrapSwitch.prototype.setPrevOptions=function(){return this.prevOptions=$.extend(true,{},this.options);};BootstrapSwitch.prototype.state=function(value,skip){if(typeof value==="undefined"){return this.options.state;}
if(this.options.disabled||this.options.readonly){return this.$element;}
if(this.options.state&&!this.options.radioAllOff&&this.$element.is(":radio")){return this.$element;}
if(this.$element.is(":radio")){$("[name='"+(this.$element.attr('name'))+"']").trigger("setPreviousOptions.bootstrapSwitch");}else{this.$element.trigger("setPreviousOptions.bootstrapSwitch");}
if(this.options.indeterminate){this.indeterminate(false);}
value=!!value;this.$element.prop("checked",value).trigger("change.bootstrapSwitch",skip);return this.$element;};BootstrapSwitch.prototype.toggleState=function(skip){if(this.options.disabled||this.options.readonly){return this.$element;}
if(this.options.indeterminate){this.indeterminate(false);return this.state(true);}else{return this.$element.prop("checked",!this.options.state).trigger("change.bootstrapSwitch",skip);}};BootstrapSwitch.prototype.size=function(value){if(typeof value==="undefined"){return this.options.size;}
if(this.options.size!=null){this.$wrapper.removeClass(this.options.baseClass+"-"+this.options.size);}
if(value){this.$wrapper.addClass(this.options.baseClass+"-"+value);}
this._width();this._containerPosition();this.options.size=value;return this.$element;};BootstrapSwitch.prototype.animate=function(value){if(typeof value==="undefined"){return this.options.animate;}
value=!!value;if(value===this.options.animate){return this.$element;}
return this.toggleAnimate();};BootstrapSwitch.prototype.toggleAnimate=function(){this.options.animate=!this.options.animate;this.$wrapper.toggleClass(this.options.baseClass+"-animate");return this.$element;};BootstrapSwitch.prototype.disabled=function(value){if(typeof value==="undefined"){return this.options.disabled;}
value=!!value;if(value===this.options.disabled){return this.$element;}
return this.toggleDisabled();};BootstrapSwitch.prototype.toggleDisabled=function(){this.options.disabled=!this.options.disabled;this.$element.prop("disabled",this.options.disabled);this.$wrapper.toggleClass(this.options.baseClass+"-disabled");return this.$element;};BootstrapSwitch.prototype.readonly=function(value){if(typeof value==="undefined"){return this.options.readonly;}
value=!!value;if(value===this.options.readonly){return this.$element;}
return this.toggleReadonly();};BootstrapSwitch.prototype.toggleReadonly=function(){this.options.readonly=!this.options.readonly;this.$element.prop("readonly",this.options.readonly);this.$wrapper.toggleClass(this.options.baseClass+"-readonly");return this.$element;};BootstrapSwitch.prototype.indeterminate=function(value){if(typeof value==="undefined"){return this.options.indeterminate;}
value=!!value;if(value===this.options.indeterminate){return this.$element;}
return this.toggleIndeterminate();};BootstrapSwitch.prototype.toggleIndeterminate=function(){this.options.indeterminate=!this.options.indeterminate;this.$element.prop("indeterminate",this.options.indeterminate);this.$wrapper.toggleClass(this.options.baseClass+"-indeterminate");this._containerPosition();return this.$element;};BootstrapSwitch.prototype.inverse=function(value){if(typeof value==="undefined"){return this.options.inverse;}
value=!!value;if(value===this.options.inverse){return this.$element;}
return this.toggleInverse();};BootstrapSwitch.prototype.toggleInverse=function(){var $off,$on;this.$wrapper.toggleClass(this.options.baseClass+"-inverse");$on=this.$on.clone(true);$off=this.$off.clone(true);this.$on.replaceWith($off);this.$off.replaceWith($on);this.$on=$off;this.$off=$on;this.options.inverse=!this.options.inverse;return this.$element;};BootstrapSwitch.prototype.onColor=function(value){var color;color=this.options.onColor;if(typeof value==="undefined"){return color;}
if(color!=null){this.$on.removeClass(this.options.baseClass+"-"+color);}
this.$on.addClass(this.options.baseClass+"-"+value);this.options.onColor=value;return this.$element;};BootstrapSwitch.prototype.offColor=function(value){var color;color=this.options.offColor;if(typeof value==="undefined"){return color;}
if(color!=null){this.$off.removeClass(this.options.baseClass+"-"+color);}
this.$off.addClass(this.options.baseClass+"-"+value);this.options.offColor=value;return this.$element;};BootstrapSwitch.prototype.onText=function(value){if(typeof value==="undefined"){return this.options.onText;}
this.$on.html(value);this._width();this._containerPosition();this.options.onText=value;return this.$element;};BootstrapSwitch.prototype.offText=function(value){if(typeof value==="undefined"){return this.options.offText;}
this.$off.html(value);this._width();this._containerPosition();this.options.offText=value;return this.$element;};BootstrapSwitch.prototype.labelText=function(value){if(typeof value==="undefined"){return this.options.labelText;}
this.$label.html(value);this._width();this.options.labelText=value;return this.$element;};BootstrapSwitch.prototype.handleWidth=function(value){if(typeof value==="undefined"){return this.options.handleWidth;}
this.options.handleWidth=value;this._width();this._containerPosition();return this.$element;};BootstrapSwitch.prototype.labelWidth=function(value){if(typeof value==="undefined"){return this.options.labelWidth;}
this.options.labelWidth=value;this._width();this._containerPosition();return this.$element;};BootstrapSwitch.prototype.baseClass=function(value){return this.options.baseClass;};BootstrapSwitch.prototype.wrapperClass=function(value){if(typeof value==="undefined"){return this.options.wrapperClass;}
if(!value){value=$.fn.bootstrapSwitch.defaults.wrapperClass;}
this.$wrapper.removeClass(this._getClasses(this.options.wrapperClass).join(" "));this.$wrapper.addClass(this._getClasses(value).join(" "));this.options.wrapperClass=value;return this.$element;};BootstrapSwitch.prototype.radioAllOff=function(value){if(typeof value==="undefined"){return this.options.radioAllOff;}
value=!!value;if(value===this.options.radioAllOff){return this.$element;}
this.options.radioAllOff=value;return this.$element;};BootstrapSwitch.prototype.onInit=function(value){if(typeof value==="undefined"){return this.options.onInit;}
if(!value){value=$.fn.bootstrapSwitch.defaults.onInit;}
this.options.onInit=value;return this.$element;};BootstrapSwitch.prototype.onSwitchChange=function(value){if(typeof value==="undefined"){return this.options.onSwitchChange;}
if(!value){value=$.fn.bootstrapSwitch.defaults.onSwitchChange;}
this.options.onSwitchChange=value;return this.$element;};BootstrapSwitch.prototype.destroy=function(){var $form;$form=this.$element.closest("form");if($form.length){$form.off("reset.bootstrapSwitch").removeData("bootstrap-switch");}
this.$container.children().not(this.$element).remove();this.$element.unwrap().unwrap().off(".bootstrapSwitch").removeData("bootstrap-switch");return this.$element;};BootstrapSwitch.prototype._width=function(){var $handles,handleWidth;$handles=this.$on.add(this.$off);$handles.add(this.$label).css("width","");handleWidth=this.options.handleWidth==="auto"?Math.max(this.$on.width(),this.$off.width()):this.options.handleWidth;$handles.width(handleWidth);this.$label.width((function(_this){return function(index,width){if(_this.options.labelWidth!=="auto"){return _this.options.labelWidth;}
if(width<handleWidth){return handleWidth;}else{return width;}};})(this));this._handleWidth=this.$on.outerWidth();this._labelWidth=this.$label.outerWidth();this.$container.width((this._handleWidth*2)+this._labelWidth);return this.$wrapper.width(this._handleWidth+this._labelWidth);};BootstrapSwitch.prototype._containerPosition=function(state,callback){if(state==null){state=this.options.state;}
this.$container.css("margin-left",(function(_this){return function(){var values;values=[0,"-"+_this._handleWidth+"px"];if(_this.options.indeterminate){return"-"+(_this._handleWidth/2)+"px";}
if(state){if(_this.options.inverse){return values[1];}else{return values[0];}}else{if(_this.options.inverse){return values[0];}else{return values[1];}}};})(this));if(!callback){return;}
return setTimeout(function(){return callback();},50);};BootstrapSwitch.prototype._init=function(){var init,initInterval;init=(function(_this){return function(){_this.setPrevOptions();_this._width();return _this._containerPosition(null,function(){if(_this.options.animate){return _this.$wrapper.addClass(_this.options.baseClass+"-animate");}});};})(this);if(this.$wrapper.is(":visible")){return init();}
return initInterval=window.setInterval((function(_this){return function(){if(_this.$wrapper.is(":visible")){init();return window.clearInterval(initInterval);}};})(this),50);};BootstrapSwitch.prototype._elementHandlers=function(){return this.$element.on({"setPreviousOptions.bootstrapSwitch":(function(_this){return function(e){return _this.setPrevOptions();};})(this),"previousState.bootstrapSwitch":(function(_this){return function(e){_this.options=_this.prevOptions;if(_this.options.indeterminate){_this.$wrapper.addClass(_this.options.baseClass+"-indeterminate");}
return _this.$element.prop("checked",_this.options.state).trigger("change.bootstrapSwitch",true);};})(this),"change.bootstrapSwitch":(function(_this){return function(e,skip){var state;e.preventDefault();e.stopImmediatePropagation();state=_this.$element.is(":checked");_this._containerPosition(state);if(state===_this.options.state){return;}
_this.options.state=state;_this.$wrapper.toggleClass(_this.options.baseClass+"-off").toggleClass(_this.options.baseClass+"-on");if(!skip){if(_this.$element.is(":radio")){$("[name='"+(_this.$element.attr('name'))+"']").not(_this.$element).prop("checked",false).trigger("change.bootstrapSwitch",true);}
return _this.$element.trigger("switchChange.bootstrapSwitch",[state]);}};})(this),"focus.bootstrapSwitch":(function(_this){return function(e){e.preventDefault();return _this.$wrapper.addClass(_this.options.baseClass+"-focused");};})(this),"blur.bootstrapSwitch":(function(_this){return function(e){e.preventDefault();return _this.$wrapper.removeClass(_this.options.baseClass+"-focused");};})(this),"keydown.bootstrapSwitch":(function(_this){return function(e){if(!e.which||_this.options.disabled||_this.options.readonly){return;}
switch(e.which){case 37:e.preventDefault();e.stopImmediatePropagation();return _this.state(false);case 39:e.preventDefault();e.stopImmediatePropagation();return _this.state(true);}};})(this)});};BootstrapSwitch.prototype._handleHandlers=function(){this.$on.on("click.bootstrapSwitch",(function(_this){return function(event){event.preventDefault();event.stopPropagation();_this.state(false);return _this.$element.trigger("focus.bootstrapSwitch");};})(this));return this.$off.on("click.bootstrapSwitch",(function(_this){return function(event){event.preventDefault();event.stopPropagation();_this.state(true);return _this.$element.trigger("focus.bootstrapSwitch");};})(this));};BootstrapSwitch.prototype._labelHandlers=function(){return this.$label.on({"click":function(e){return e.stopPropagation();},"mousedown.bootstrapSwitch touchstart.bootstrapSwitch":(function(_this){return function(e){if(_this._dragStart||_this.options.disabled||_this.options.readonly){return;}
e.preventDefault();e.stopPropagation();_this._dragStart=(e.pageX||e.originalEvent.touches[0].pageX)-parseInt(_this.$container.css("margin-left"),10);if(_this.options.animate){_this.$wrapper.removeClass(_this.options.baseClass+"-animate");}
return _this.$element.trigger("focus.bootstrapSwitch");};})(this),"mousemove.bootstrapSwitch touchmove.bootstrapSwitch":(function(_this){return function(e){var difference;if(_this._dragStart==null){return;}
e.preventDefault();difference=(e.pageX||e.originalEvent.touches[0].pageX)-_this._dragStart;if(difference<-_this._handleWidth||difference>0){return;}
_this._dragEnd=difference;return _this.$container.css("margin-left",_this._dragEnd+"px");};})(this),"mouseup.bootstrapSwitch touchend.bootstrapSwitch":(function(_this){return function(e){var state;if(!_this._dragStart){return;}
e.preventDefault();if(_this.options.animate){_this.$wrapper.addClass(_this.options.baseClass+"-animate");}
if(_this._dragEnd){state=_this._dragEnd>-(_this._handleWidth/2);_this._dragEnd=false;_this.state(_this.options.inverse?!state:state);}else{_this.state(!_this.options.state);}
return _this._dragStart=false;};})(this),"mouseleave.bootstrapSwitch":(function(_this){return function(e){return _this.$label.trigger("mouseup.bootstrapSwitch");};})(this)});};BootstrapSwitch.prototype._externalLabelHandler=function(){var $externalLabel;$externalLabel=this.$element.closest("label");return $externalLabel.on("click",(function(_this){return function(event){event.preventDefault();event.stopImmediatePropagation();if(event.target===$externalLabel[0]){return _this.toggleState();}};})(this));};BootstrapSwitch.prototype._formHandler=function(){var $form;$form=this.$element.closest("form");if($form.data("bootstrap-switch")){return;}
return $form.on("reset.bootstrapSwitch",function(){return window.setTimeout(function(){return $form.find("input").filter(function(){return $(this).data("bootstrap-switch");}).each(function(){return $(this).bootstrapSwitch("state",this.checked);});},1);}).data("bootstrap-switch",true);};BootstrapSwitch.prototype._getClasses=function(classes){var c,cls,i,len;if(!$.isArray(classes)){return[this.options.baseClass+"-"+classes];}
cls=[];for(i=0,len=classes.length;i<len;i++){c=classes[i];cls.push(this.options.baseClass+"-"+c);}
return cls;};return BootstrapSwitch;})();$.fn.bootstrapSwitch=function(){var args,option,ret;option=arguments[0],args=2<=arguments.length?slice.call(arguments,1):[];ret=this;this.each(function(){var $this,data;$this=$(this);data=$this.data("bootstrap-switch");if(!data){$this.data("bootstrap-switch",data=new BootstrapSwitch(this,option));}
if(typeof option==="string"){return ret=data[option].apply(data,args);}});return ret;};$.fn.bootstrapSwitch.Constructor=BootstrapSwitch;return $.fn.bootstrapSwitch.defaults={state:true,size:null,animate:true,disabled:false,readonly:false,indeterminate:false,inverse:false,radioAllOff:false,onColor:"primary",offColor:"default",onText:"ON",offText:"OFF",labelText:"&nbsp;",handleWidth:"auto",labelWidth:"auto",baseClass:"bootstrap-switch",wrapperClass:"wrapper",onInit:function(){},onSwitchChange:function(){}};})(window.jQuery,window);}).call(this);
(function(root,factory){if(typeof exports==='object'){factory(exports);}else if(typeof define==='function'&&define.amd){define(['exports'],factory);}else{factory(root);}}(this,function(exports){var VERSION='2.0.1';function IntroJs(obj){this._targetElement=obj;this._introItems=[];this._options={nextLabel:'Next &rarr;',prevLabel:'&larr; Back',skipLabel:'Skip',doneLabel:'Done',tooltipPosition:'bottom',tooltipClass:'',highlightClass:'',exitOnEsc:true,exitOnOverlayClick:true,showStepNumbers:true,keyboardNavigation:true,showButtons:true,showBullets:true,showProgress:false,scrollToElement:true,overlayOpacity:0.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:false,hintPosition:'top-middle',hintButtonLabel:'Got it'};}
function _introForElement(targetElm){var introItems=[],self=this;if(this._options.steps){for(var i=0,stepsLength=this._options.steps.length;i<stepsLength;i++){var currentItem=_cloneObject(this._options.steps[i]);currentItem.step=introItems.length+1;if(typeof(currentItem.element)==='string'){currentItem.element=document.querySelector(currentItem.element);}
if(typeof(currentItem.element)==='undefined'||currentItem.element==null){var floatingElementQuery=document.querySelector(".introjsFloatingElement");if(floatingElementQuery==null){floatingElementQuery=document.createElement('div');floatingElementQuery.className='introjsFloatingElement';document.body.appendChild(floatingElementQuery);}
currentItem.element=floatingElementQuery;currentItem.position='floating';}
if(currentItem.element!=null){introItems.push(currentItem);}}}else{var allIntroSteps=targetElm.querySelectorAll('*[data-intro]');if(allIntroSteps.length<1){return false;}
for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];if(currentElement.style.display=='none'){continue;}
var step=parseInt(currentElement.getAttribute('data-step'),10);if(step>0){introItems[step-1]={element:currentElement,intro:currentElement.getAttribute('data-intro'),step:parseInt(currentElement.getAttribute('data-step'),10),tooltipClass:currentElement.getAttribute('data-tooltipClass'),highlightClass:currentElement.getAttribute('data-highlightClass'),position:currentElement.getAttribute('data-position')||this._options.tooltipPosition};}}
var nextStep=0;for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];if(currentElement.getAttribute('data-step')==null){while(true){if(typeof introItems[nextStep]=='undefined'){break;}else{nextStep++;}}
introItems[nextStep]={element:currentElement,intro:currentElement.getAttribute('data-intro'),step:nextStep+1,tooltipClass:currentElement.getAttribute('data-tooltipClass'),highlightClass:currentElement.getAttribute('data-highlightClass'),position:currentElement.getAttribute('data-position')||this._options.tooltipPosition};}}}
var tempIntroItems=[];for(var z=0;z<introItems.length;z++){introItems[z]&&tempIntroItems.push(introItems[z]);}
introItems=tempIntroItems;introItems.sort(function(a,b){return a.step-b.step;});self._introItems=introItems;if(_addOverlayLayer.call(self,targetElm)){_nextStep.call(self);var skipButton=targetElm.querySelector('.introjs-skipbutton'),nextStepButton=targetElm.querySelector('.introjs-nextbutton');self._onKeyDown=function(e){if(e.keyCode===27&&self._options.exitOnEsc==true){if(self._introExitCallback!=undefined){self._introExitCallback.call(self);}
_exitIntro.call(self,targetElm);}else if(e.keyCode===37){_previousStep.call(self);}else if(e.keyCode===39){_nextStep.call(self);}else if(e.keyCode===13){var target=e.target||e.srcElement;if(target&&target.className.indexOf('introjs-prevbutton')>0){_previousStep.call(self);}else if(target&&target.className.indexOf('introjs-skipbutton')>0){if(self._introItems.length-1==self._currentStep&&typeof(self._introCompleteCallback)==='function'){self._introCompleteCallback.call(self);}
if(self._introExitCallback!=undefined){self._introExitCallback.call(self);}
_exitIntro.call(self,targetElm);}else{_nextStep.call(self);}
if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}}};self._onResize=function(e){_setHelperLayerPosition.call(self,document.querySelector('.introjs-helperLayer'));_setHelperLayerPosition.call(self,document.querySelector('.introjs-tooltipReferenceLayer'));};if(window.addEventListener){if(this._options.keyboardNavigation){window.addEventListener('keydown',self._onKeyDown,true);}
window.addEventListener('resize',self._onResize,true);}else if(document.attachEvent){if(this._options.keyboardNavigation){document.attachEvent('onkeydown',self._onKeyDown);}
document.attachEvent('onresize',self._onResize);}}
return false;}
function _cloneObject(object){if(object==null||typeof(object)!='object'||typeof(object.nodeType)!='undefined'){return object;}
var temp={};for(var key in object){if(typeof(jQuery)!='undefined'&&object[key]instanceof jQuery){temp[key]=object[key];}else{temp[key]=_cloneObject(object[key]);}}
return temp;}
function _goToStep(step){this._currentStep=step-2;if(typeof(this._introItems)!=='undefined'){_nextStep.call(this);}}
function _nextStep(){this._direction='forward';if(typeof(this._currentStep)==='undefined'){this._currentStep=0;}else{++this._currentStep;}
if((this._introItems.length)<=this._currentStep){if(typeof(this._introCompleteCallback)==='function'){this._introCompleteCallback.call(this);}
_exitIntro.call(this,this._targetElement);return;}
var nextStep=this._introItems[this._currentStep];if(typeof(this._introBeforeChangeCallback)!=='undefined'){this._introBeforeChangeCallback.call(this,nextStep.element);}
_showElement.call(this,nextStep);}
function _previousStep(){this._direction='backward';if(this._currentStep===0){return false;}
var nextStep=this._introItems[--this._currentStep];if(typeof(this._introBeforeChangeCallback)!=='undefined'){this._introBeforeChangeCallback.call(this,nextStep.element);}
_showElement.call(this,nextStep);}
function _exitIntro(targetElement){var overlayLayer=targetElement.querySelector('.introjs-overlay');if(overlayLayer==null){return;}
overlayLayer.style.opacity=0;setTimeout(function(){if(overlayLayer.parentNode){overlayLayer.parentNode.removeChild(overlayLayer);}},500);var helperLayer=targetElement.querySelector('.introjs-helperLayer');if(helperLayer){helperLayer.parentNode.removeChild(helperLayer);}
var referenceLayer=targetElement.querySelector('.introjs-tooltipReferenceLayer');if(referenceLayer){referenceLayer.parentNode.removeChild(referenceLayer);}
var disableInteractionLayer=targetElement.querySelector('.introjs-disableInteraction');if(disableInteractionLayer){disableInteractionLayer.parentNode.removeChild(disableInteractionLayer);}
var floatingElement=document.querySelector('.introjsFloatingElement');if(floatingElement){floatingElement.parentNode.removeChild(floatingElement);}
var showElement=document.querySelector('.introjs-showElement');if(showElement){showElement.className=showElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'');}
var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'');}}
if(window.removeEventListener){window.removeEventListener('keydown',this._onKeyDown,true);}else if(document.detachEvent){document.detachEvent('onkeydown',this._onKeyDown);}
this._currentStep=undefined;}
function _placeTooltip(targetElement,tooltipLayer,arrowLayer,helperNumberLayer,hintMode){var tooltipCssClass='',currentStepObj,tooltipOffset,targetOffset,windowSize,currentTooltipPosition;hintMode=hintMode||false;tooltipLayer.style.top=null;tooltipLayer.style.right=null;tooltipLayer.style.bottom=null;tooltipLayer.style.left=null;tooltipLayer.style.marginLeft=null;tooltipLayer.style.marginTop=null;arrowLayer.style.display='inherit';if(typeof(helperNumberLayer)!='undefined'&&helperNumberLayer!=null){helperNumberLayer.style.top=null;helperNumberLayer.style.left=null;}
if(!this._introItems[this._currentStep])return;currentStepObj=this._introItems[this._currentStep];if(typeof(currentStepObj.tooltipClass)==='string'){tooltipCssClass=currentStepObj.tooltipClass;}else{tooltipCssClass=this._options.tooltipClass;}
tooltipLayer.className=('introjs-tooltip '+tooltipCssClass).replace(/^\s+|\s+$/g,'');currentTooltipPosition=this._introItems[this._currentStep].position;if((currentTooltipPosition=="auto"||this._options.tooltipPosition=="auto")){if(currentTooltipPosition!="floating"){currentTooltipPosition=_determineAutoPosition.call(this,targetElement,tooltipLayer,currentTooltipPosition);}}
targetOffset=_getOffset(targetElement);tooltipOffset=_getOffset(tooltipLayer);windowSize=_getWinSize();switch(currentTooltipPosition){case'top':arrowLayer.className='introjs-arrow bottom';if(hintMode){var tooltipLayerStyleLeft=0;}else{var tooltipLayerStyleLeft=15;}
_checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer);tooltipLayer.style.bottom=(targetOffset.height+20)+'px';break;case'right':tooltipLayer.style.left=(targetOffset.width+20)+'px';if(targetOffset.top+tooltipOffset.height>windowSize.height){arrowLayer.className="introjs-arrow left-bottom";tooltipLayer.style.top="-"+(tooltipOffset.height-targetOffset.height-20)+"px";}else{arrowLayer.className='introjs-arrow left';}
break;case'left':if(!hintMode&&this._options.showStepNumbers==true){tooltipLayer.style.top='15px';}
if(targetOffset.top+tooltipOffset.height>windowSize.height){tooltipLayer.style.top="-"+(tooltipOffset.height-targetOffset.height-20)+"px";arrowLayer.className='introjs-arrow right-bottom';}else{arrowLayer.className='introjs-arrow right';}
tooltipLayer.style.right=(targetOffset.width+20)+'px';break;case'floating':arrowLayer.style.display='none';tooltipLayer.style.left='50%';tooltipLayer.style.top='50%';tooltipLayer.style.marginLeft='-'+(tooltipOffset.width/2)+'px';tooltipLayer.style.marginTop='-'+(tooltipOffset.height/2)+'px';if(typeof(helperNumberLayer)!='undefined'&&helperNumberLayer!=null){helperNumberLayer.style.left='-'+((tooltipOffset.width/2)+18)+'px';helperNumberLayer.style.top='-'+((tooltipOffset.height/2)+18)+'px';}
break;case'bottom-right-aligned':arrowLayer.className='introjs-arrow top-right';var tooltipLayerStyleRight=0;_checkLeft(targetOffset,tooltipLayerStyleRight,tooltipOffset,tooltipLayer);tooltipLayer.style.top=(targetOffset.height+20)+'px';break;case'bottom-middle-aligned':arrowLayer.className='introjs-arrow top-middle';var tooltipLayerStyleLeftRight=targetOffset.width/2-tooltipOffset.width/2;if(hintMode){tooltipLayerStyleLeftRight+=5;}
if(_checkLeft(targetOffset,tooltipLayerStyleLeftRight,tooltipOffset,tooltipLayer)){tooltipLayer.style.right=null;_checkRight(targetOffset,tooltipLayerStyleLeftRight,tooltipOffset,windowSize,tooltipLayer);}
tooltipLayer.style.top=(targetOffset.height+20)+'px';break;case'bottom-left-aligned':case'bottom':default:arrowLayer.className='introjs-arrow top';var tooltipLayerStyleLeft=0;_checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer);tooltipLayer.style.top=(targetOffset.height+20)+'px';break;}}
function _checkRight(targetOffset,tooltipLayerStyleLeft,tooltipOffset,windowSize,tooltipLayer){if(targetOffset.left+tooltipLayerStyleLeft+tooltipOffset.width>windowSize.width){tooltipLayer.style.left=(windowSize.width-tooltipOffset.width-targetOffset.left)+'px';return false;}
tooltipLayer.style.left=tooltipLayerStyleLeft+'px';return true;}
function _checkLeft(targetOffset,tooltipLayerStyleRight,tooltipOffset,tooltipLayer){if(targetOffset.left+targetOffset.width-tooltipLayerStyleRight-tooltipOffset.width<0){tooltipLayer.style.left=(-targetOffset.left)+'px';return false;}
tooltipLayer.style.right=tooltipLayerStyleRight+'px';return true;}
function _determineAutoPosition(targetElement,tooltipLayer,desiredTooltipPosition){var possiblePositions=this._options.positionPrecedence.slice();var windowSize=_getWinSize();var tooltipHeight=_getOffset(tooltipLayer).height+10;var tooltipWidth=_getOffset(tooltipLayer).width+20;var targetOffset=_getOffset(targetElement);var calculatedPosition="floating";if(targetOffset.left+tooltipWidth>windowSize.width||((targetOffset.left+(targetOffset.width/2))-tooltipWidth)<0){_removeEntry(possiblePositions,"bottom");_removeEntry(possiblePositions,"top");}else{if((targetOffset.height+targetOffset.top+tooltipHeight)>windowSize.height){_removeEntry(possiblePositions,"bottom");}
if(targetOffset.top-tooltipHeight<0){_removeEntry(possiblePositions,"top");}}
if(targetOffset.width+targetOffset.left+tooltipWidth>windowSize.width){_removeEntry(possiblePositions,"right");}
if(targetOffset.left-tooltipWidth<0){_removeEntry(possiblePositions,"left");}
if(possiblePositions.length>0){calculatedPosition=possiblePositions[0];}
if(desiredTooltipPosition&&desiredTooltipPosition!="auto"){if(possiblePositions.indexOf(desiredTooltipPosition)>-1){calculatedPosition=desiredTooltipPosition;}}
return calculatedPosition;}
function _removeEntry(stringArray,stringToRemove){if(stringArray.indexOf(stringToRemove)>-1){stringArray.splice(stringArray.indexOf(stringToRemove),1);}}
function _setHelperLayerPosition(helperLayer){if(helperLayer){if(!this._introItems[this._currentStep])return;var currentElement=this._introItems[this._currentStep],elementPosition=_getOffset(currentElement.element),widthHeightPadding=10;if(_isFixed(currentElement.element)){helperLayer.className+=' introjs-fixedTooltip';}else{helperLayer.className=helperLayer.className.replace(' introjs-fixedTooltip','');}
if(currentElement.position=='floating'){widthHeightPadding=0;}
helperLayer.setAttribute('style','width: '+(elementPosition.width+widthHeightPadding)+'px; '+'height:'+(elementPosition.height+widthHeightPadding)+'px; '+'top:'+(elementPosition.top-5)+'px;'+'left: '+(elementPosition.left-5)+'px;');}}
function _disableInteraction(){var disableInteractionLayer=document.querySelector('.introjs-disableInteraction');if(disableInteractionLayer===null){disableInteractionLayer=document.createElement('div');disableInteractionLayer.className='introjs-disableInteraction';this._targetElement.appendChild(disableInteractionLayer);}
_setHelperLayerPosition.call(this,disableInteractionLayer);}
function _showElement(targetElement){if(typeof(this._introChangeCallback)!=='undefined'){this._introChangeCallback.call(this,targetElement.element);}
var self=this,oldHelperLayer=document.querySelector('.introjs-helperLayer'),oldReferenceLayer=document.querySelector('.introjs-tooltipReferenceLayer'),highlightClass='introjs-helperLayer',elementPosition=_getOffset(targetElement.element);if(typeof(targetElement.highlightClass)==='string'){highlightClass+=(' '+targetElement.highlightClass);}
if(typeof(this._options.highlightClass)==='string'){highlightClass+=(' '+this._options.highlightClass);}
if(oldHelperLayer!=null){var oldHelperNumberLayer=oldReferenceLayer.querySelector('.introjs-helperNumberLayer'),oldtooltipLayer=oldReferenceLayer.querySelector('.introjs-tooltiptext'),oldArrowLayer=oldReferenceLayer.querySelector('.introjs-arrow'),oldtooltipContainer=oldReferenceLayer.querySelector('.introjs-tooltip'),skipTooltipButton=oldReferenceLayer.querySelector('.introjs-skipbutton'),prevTooltipButton=oldReferenceLayer.querySelector('.introjs-prevbutton'),nextTooltipButton=oldReferenceLayer.querySelector('.introjs-nextbutton');oldHelperLayer.className=highlightClass;oldtooltipContainer.style.opacity=0;oldtooltipContainer.style.display="none";if(oldHelperNumberLayer!=null){var lastIntroItem=this._introItems[(targetElement.step-2>=0?targetElement.step-2:0)];if(lastIntroItem!=null&&(this._direction=='forward'&&lastIntroItem.position=='floating')||(this._direction=='backward'&&targetElement.position=='floating')){oldHelperNumberLayer.style.opacity=0;}}
_setHelperLayerPosition.call(self,oldHelperLayer);_setHelperLayerPosition.call(self,oldReferenceLayer);var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'');};}
var oldShowElement=document.querySelector('.introjs-showElement');if(oldShowElement){oldShowElement.className=oldShowElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'');}
if(self._lastShowElementTimer){clearTimeout(self._lastShowElementTimer);}
self._lastShowElementTimer=setTimeout(function(){if(oldHelperNumberLayer!=null){oldHelperNumberLayer.innerHTML=targetElement.step;}
oldtooltipLayer.innerHTML=targetElement.intro;oldtooltipContainer.style.display="block";_placeTooltip.call(self,targetElement.element,oldtooltipContainer,oldArrowLayer,oldHelperNumberLayer);oldReferenceLayer.querySelector('.introjs-bullets li > a.active').className='';oldReferenceLayer.querySelector('.introjs-bullets li > a[data-stepnumber="'+targetElement.step+'"]').className='active';oldReferenceLayer.querySelector('.introjs-progress .introjs-progressbar').setAttribute('style','width:'+_getProgress.call(self)+'%;');oldtooltipContainer.style.opacity=1;if(oldHelperNumberLayer)oldHelperNumberLayer.style.opacity=1;if(nextTooltipButton.tabIndex===-1){skipTooltipButton.focus();}else{nextTooltipButton.focus();}},350);}else{var helperLayer=document.createElement('div'),referenceLayer=document.createElement('div'),arrowLayer=document.createElement('div'),tooltipLayer=document.createElement('div'),tooltipTextLayer=document.createElement('div'),bulletsLayer=document.createElement('div'),progressLayer=document.createElement('div'),buttonsLayer=document.createElement('div');helperLayer.className=highlightClass;referenceLayer.className='introjs-tooltipReferenceLayer';_setHelperLayerPosition.call(self,helperLayer);_setHelperLayerPosition.call(self,referenceLayer);this._targetElement.appendChild(helperLayer);this._targetElement.appendChild(referenceLayer);arrowLayer.className='introjs-arrow';tooltipTextLayer.className='introjs-tooltiptext';tooltipTextLayer.innerHTML=targetElement.intro;bulletsLayer.className='introjs-bullets';if(this._options.showBullets===false){bulletsLayer.style.display='none';}
var ulContainer=document.createElement('ul');for(var i=0,stepsLength=this._introItems.length;i<stepsLength;i++){var innerLi=document.createElement('li');var anchorLink=document.createElement('a');anchorLink.onclick=function(){self.goToStep(this.getAttribute('data-stepnumber'));};if(i===(targetElement.step-1))anchorLink.className='active';anchorLink.href='javascript:void(0);';anchorLink.innerHTML="&nbsp;";anchorLink.setAttribute('data-stepnumber',this._introItems[i].step);innerLi.appendChild(anchorLink);ulContainer.appendChild(innerLi);}
bulletsLayer.appendChild(ulContainer);progressLayer.className='introjs-progress';if(this._options.showProgress===false){progressLayer.style.display='none';}
var progressBar=document.createElement('div');progressBar.className='introjs-progressbar';progressBar.setAttribute('style','width:'+_getProgress.call(this)+'%;');progressLayer.appendChild(progressBar);buttonsLayer.className='introjs-tooltipbuttons';if(this._options.showButtons===false){buttonsLayer.style.display='none';}
tooltipLayer.className='introjs-tooltip';tooltipLayer.appendChild(tooltipTextLayer);tooltipLayer.appendChild(bulletsLayer);tooltipLayer.appendChild(progressLayer);if(this._options.showStepNumbers==true){var helperNumberLayer=document.createElement('span');helperNumberLayer.className='introjs-helperNumberLayer';helperNumberLayer.innerHTML=targetElement.step;referenceLayer.appendChild(helperNumberLayer);}
tooltipLayer.appendChild(arrowLayer);referenceLayer.appendChild(tooltipLayer);var nextTooltipButton=document.createElement('a');nextTooltipButton.onclick=function(){if(self._introItems.length-1!=self._currentStep){_nextStep.call(self);}};nextTooltipButton.href='javascript:void(0);';nextTooltipButton.innerHTML=this._options.nextLabel;var prevTooltipButton=document.createElement('a');prevTooltipButton.onclick=function(){if(self._currentStep!=0){_previousStep.call(self);}};prevTooltipButton.href='javascript:void(0);';prevTooltipButton.innerHTML=this._options.prevLabel;var skipTooltipButton=document.createElement('a');skipTooltipButton.className='introjs-button introjs-skipbutton';skipTooltipButton.href='javascript:void(0);';skipTooltipButton.innerHTML=this._options.skipLabel;skipTooltipButton.onclick=function(){if(self._introItems.length-1==self._currentStep&&typeof(self._introCompleteCallback)==='function'){self._introCompleteCallback.call(self);}
if(self._introItems.length-1!=self._currentStep&&typeof(self._introExitCallback)==='function'){self._introExitCallback.call(self);}
_exitIntro.call(self,self._targetElement);};buttonsLayer.appendChild(skipTooltipButton);if(this._introItems.length>1){buttonsLayer.appendChild(prevTooltipButton);buttonsLayer.appendChild(nextTooltipButton);}
tooltipLayer.appendChild(buttonsLayer);_placeTooltip.call(self,targetElement.element,tooltipLayer,arrowLayer,helperNumberLayer);}
if(this._options.disableInteraction===true){_disableInteraction.call(self);}
prevTooltipButton.removeAttribute('tabIndex');nextTooltipButton.removeAttribute('tabIndex');if(this._currentStep==0&&this._introItems.length>1){prevTooltipButton.className='introjs-button introjs-prevbutton introjs-disabled';prevTooltipButton.tabIndex='-1';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel;}else if(this._introItems.length-1==this._currentStep||this._introItems.length==1){skipTooltipButton.innerHTML=this._options.doneLabel;prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton introjs-disabled';nextTooltipButton.tabIndex='-1';}else{prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel;}
nextTooltipButton.focus();targetElement.element.className+=' introjs-showElement';var currentElementPosition=_getPropValue(targetElement.element,'position');if(currentElementPosition!=='absolute'&&currentElementPosition!=='relative'&&currentElementPosition!=='fixed'){targetElement.element.className+=' introjs-relativePosition';}
var parentElm=targetElement.element.parentNode;while(parentElm!=null){if(parentElm.tagName.toLowerCase()==='body')break;var zIndex=_getPropValue(parentElm,'z-index');var opacity=parseFloat(_getPropValue(parentElm,'opacity'));var transform=_getPropValue(parentElm,'transform')||_getPropValue(parentElm,'-webkit-transform')||_getPropValue(parentElm,'-moz-transform')||_getPropValue(parentElm,'-ms-transform')||_getPropValue(parentElm,'-o-transform');if(/[0-9]+/.test(zIndex)||opacity<1||(transform!=='none'&&transform!==undefined)){parentElm.className+=' introjs-fixParent';}
parentElm=parentElm.parentNode;}
if(!_elementInViewport(targetElement.element)&&this._options.scrollToElement===true){var rect=targetElement.element.getBoundingClientRect(),winHeight=_getWinSize().height,top=rect.bottom-(rect.bottom-rect.top),bottom=rect.bottom-winHeight;if(top<0||targetElement.element.clientHeight>winHeight){window.scrollBy(0,top-30);}else{window.scrollBy(0,bottom+100);}}
if(typeof(this._introAfterChangeCallback)!=='undefined'){this._introAfterChangeCallback.call(this,targetElement.element);}}
function _getPropValue(element,propName){var propValue='';if(element.currentStyle){propValue=element.currentStyle[propName];}else if(document.defaultView&&document.defaultView.getComputedStyle){propValue=document.defaultView.getComputedStyle(element,null).getPropertyValue(propName);}
if(propValue&&propValue.toLowerCase){return propValue.toLowerCase();}else{return propValue;}};function _isFixed(element){var p=element.parentNode;if(p.nodeName==='HTML'){return false;}
if(_getPropValue(element,'position')=='fixed'){return true;}
return _isFixed(p);};function _getWinSize(){if(window.innerWidth!=undefined){return{width:window.innerWidth,height:window.innerHeight};}else{var D=document.documentElement;return{width:D.clientWidth,height:D.clientHeight};}}
function _elementInViewport(el){var rect=el.getBoundingClientRect();return(rect.top>=0&&rect.left>=0&&(rect.bottom+80)<=window.innerHeight&&rect.right<=window.innerWidth);}
function _addOverlayLayer(targetElm){var overlayLayer=document.createElement('div'),styleText='',self=this;overlayLayer.className='introjs-overlay';if(targetElm.tagName.toLowerCase()==='body'){styleText+='top: 0;bottom: 0; left: 0;right: 0;position: fixed;';overlayLayer.setAttribute('style',styleText);}else{var elementPosition=_getOffset(targetElm);if(elementPosition){styleText+='width: '+elementPosition.width+'px; height:'+elementPosition.height+'px; top:'+elementPosition.top+'px;left: '+elementPosition.left+'px;';overlayLayer.setAttribute('style',styleText);}}
targetElm.appendChild(overlayLayer);overlayLayer.onclick=function(){if(self._options.exitOnOverlayClick==true){if(self._introExitCallback!=undefined){self._introExitCallback.call(self);}
_exitIntro.call(self,targetElm);}};setTimeout(function(){styleText+='opacity: '+self._options.overlayOpacity.toString()+';';overlayLayer.setAttribute('style',styleText);},10);return true;};function _removeHintTooltip(){var tooltip=this._targetElement.querySelector('.introjs-hintReference');if(tooltip){var step=tooltip.getAttribute('data-step');tooltip.parentNode.removeChild(tooltip);return step;}};function _populateHints(targetElm){var self=this;this._introItems=[]
if(this._options.hints){for(var i=0,l=this._options.hints.length;i<l;i++){var currentItem=_cloneObject(this._options.hints[i]);if(typeof(currentItem.element)==='string'){currentItem.element=document.querySelector(currentItem.element);}
currentItem.hintPosition=currentItem.hintPosition||'top-middle';if(currentItem.element!=null){this._introItems.push(currentItem);}}}else{var hints=targetElm.querySelectorAll('*[data-hint]');if(hints.length<1){return false;}
for(var i=0,l=hints.length;i<l;i++){var currentElement=hints[i];this._introItems.push({element:currentElement,hint:currentElement.getAttribute('data-hint'),hintPosition:currentElement.getAttribute('data-hintPosition')||this._options.hintPosition,tooltipClass:currentElement.getAttribute('data-tooltipClass'),position:currentElement.getAttribute('data-position')||this._options.tooltipPosition});}}
_addHints.call(this);if(document.addEventListener){document.addEventListener('click',_removeHintTooltip.bind(this),false);window.addEventListener('resize',_reAlignHints.bind(this),true);}else if(document.attachEvent){document.attachEvent('onclick',_removeHintTooltip.bind(this));document.attachEvent('onresize',_reAlignHints.bind(this));}};function _reAlignHints(){for(var i=0,l=this._introItems.length;i<l;i++){var item=this._introItems[i];if(typeof(item.targetElement)=='undefined')continue;_alignHintPosition.call(this,item.hintPosition,item.element,item.targetElement)}}
function _hideHint(stepId){_removeHintTooltip.call(this);var hint=this._targetElement.querySelector('.introjs-hint[data-step="'+stepId+'"]');if(hint){hint.className+=' introjs-hidehint';}
if(typeof(this._hintCloseCallback)!=='undefined'){this._hintCloseCallback.call(this,stepId);}};function _addHints(){var self=this;var oldHintsWrapper=document.querySelector('.introjs-hints');if(oldHintsWrapper!=null){hintsWrapper=oldHintsWrapper;}else{var hintsWrapper=document.createElement('div');hintsWrapper.className='introjs-hints';}
for(var i=0,l=this._introItems.length;i<l;i++){var item=this._introItems[i];if(document.querySelector('.introjs-hint[data-step="'+i+'"]'))
continue;var hint=document.createElement('a');hint.href="javascript:void(0);";(function(hint,item,i){hint.onclick=function(e){var evt=e?e:window.event;if(evt.stopPropagation)evt.stopPropagation();if(evt.cancelBubble!=null)evt.cancelBubble=true;_hintClick.call(self,hint,item,i);};}(hint,item,i));hint.className='introjs-hint';if(_isFixed(item.element)){hint.className+=' introjs-fixedhint';}
var hintDot=document.createElement('div');hintDot.className='introjs-hint-dot';var hintPulse=document.createElement('div');hintPulse.className='introjs-hint-pulse';hint.appendChild(hintDot);hint.appendChild(hintPulse);hint.setAttribute('data-step',i);item.targetElement=item.element;item.element=hint;_alignHintPosition.call(this,item.hintPosition,hint,item.targetElement);hintsWrapper.appendChild(hint);}
document.body.appendChild(hintsWrapper);if(typeof(this._hintsAddedCallback)!=='undefined'){this._hintsAddedCallback.call(this);}};function _alignHintPosition(position,hint,element){var offset=_getOffset.call(this,element);switch(position){default:case'top-left':hint.style.left=offset.left+'px';hint.style.top=offset.top+'px';break;case'top-right':hint.style.left=(offset.left+offset.width)+'px';hint.style.top=offset.top+'px';break;case'bottom-left':hint.style.left=offset.left+'px';hint.style.top=(offset.top+offset.height)+'px';break;case'bottom-right':hint.style.left=(offset.left+offset.width)+'px';hint.style.top=(offset.top+offset.height)+'px';break;case'bottom-middle':hint.style.left=(offset.left+(offset.width/2))+'px';hint.style.top=(offset.top+offset.height)+'px';break;case'top-middle':hint.style.left=(offset.left+(offset.width/2))+'px';hint.style.top=offset.top+'px';break;}};function _hintClick(hintElement,item,stepId){if(typeof(this._hintClickCallback)!=='undefined'){this._hintClickCallback.call(this,hintElement,item,stepId);}
var removedStep=_removeHintTooltip.call(this);if(parseInt(removedStep,10)==stepId){return;}
var tooltipLayer=document.createElement('div');var tooltipTextLayer=document.createElement('div');var arrowLayer=document.createElement('div');var referenceLayer=document.createElement('div');tooltipLayer.className='introjs-tooltip';tooltipLayer.onclick=function(e){if(e.stopPropagation){e.stopPropagation();}
else{e.cancelBubble=true;}};tooltipTextLayer.className='introjs-tooltiptext';var tooltipWrapper=document.createElement('p');tooltipWrapper.innerHTML=item.hint;var closeButton=document.createElement('a');closeButton.className='introjs-button';closeButton.innerHTML=this._options.hintButtonLabel;closeButton.onclick=_hideHint.bind(this,stepId);tooltipTextLayer.appendChild(tooltipWrapper);tooltipTextLayer.appendChild(closeButton);arrowLayer.className='introjs-arrow';tooltipLayer.appendChild(arrowLayer);tooltipLayer.appendChild(tooltipTextLayer);this._currentStep=hintElement.getAttribute('data-step');referenceLayer.className='introjs-tooltipReferenceLayer introjs-hintReference';referenceLayer.setAttribute('data-step',hintElement.getAttribute('data-step'));_setHelperLayerPosition.call(this,referenceLayer);referenceLayer.appendChild(tooltipLayer);document.body.appendChild(referenceLayer);_placeTooltip.call(this,hintElement,tooltipLayer,arrowLayer,null,true);};function _getOffset(element){var elementPosition={};elementPosition.width=element.offsetWidth;elementPosition.height=element.offsetHeight;var _x=0;var _y=0;while(element&&!isNaN(element.offsetLeft)&&!isNaN(element.offsetTop)){_x+=element.offsetLeft;_y+=element.offsetTop;element=element.offsetParent;}
elementPosition.top=_y;elementPosition.left=_x;return elementPosition;};function _getProgress(){var currentStep=parseInt((this._currentStep+1),10);return((currentStep/this._introItems.length)*100);};function _mergeOptions(obj1,obj2){var obj3={};for(var attrname in obj1){obj3[attrname]=obj1[attrname];}
for(var attrname in obj2){obj3[attrname]=obj2[attrname];}
return obj3;};var introJs=function(targetElm){if(typeof(targetElm)==='object'){return new IntroJs(targetElm);}else if(typeof(targetElm)==='string'){var targetElement=document.querySelector(targetElm);if(targetElement){return new IntroJs(targetElement);}else{throw new Error('There is no element with given selector.');}}else{return new IntroJs(document.body);}};introJs.version=VERSION;introJs.fn=IntroJs.prototype={clone:function(){return new IntroJs(this);},setOption:function(option,value){this._options[option]=value;return this;},setOptions:function(options){this._options=_mergeOptions(this._options,options);return this;},start:function(){_introForElement.call(this,this._targetElement);return this;},goToStep:function(step){_goToStep.call(this,step);return this;},nextStep:function(){_nextStep.call(this);return this;},previousStep:function(){_previousStep.call(this);return this;},exit:function(){_exitIntro.call(this,this._targetElement);return this;},refresh:function(){_setHelperLayerPosition.call(this,document.querySelector('.introjs-helperLayer'));_setHelperLayerPosition.call(this,document.querySelector('.introjs-tooltipReferenceLayer'));_reAlignHints.call(this);return this;},onbeforechange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introBeforeChangeCallback=providedCallback;}else{throw new Error('Provided callback for onbeforechange was not a function');}
return this;},onchange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introChangeCallback=providedCallback;}else{throw new Error('Provided callback for onchange was not a function.');}
return this;},onafterchange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introAfterChangeCallback=providedCallback;}else{throw new Error('Provided callback for onafterchange was not a function');}
return this;},oncomplete:function(providedCallback){if(typeof(providedCallback)==='function'){this._introCompleteCallback=providedCallback;}else{throw new Error('Provided callback for oncomplete was not a function.');}
return this;},onhintsadded:function(providedCallback){if(typeof(providedCallback)==='function'){this._hintsAddedCallback=providedCallback;}else{throw new Error('Provided callback for onhintsadded was not a function.');}
return this;},onhintclick:function(providedCallback){if(typeof(providedCallback)==='function'){this._hintClickCallback=providedCallback;}else{throw new Error('Provided callback for onhintclick was not a function.');}
return this;},onhintclose:function(providedCallback){if(typeof(providedCallback)==='function'){this._hintCloseCallback=providedCallback;}else{throw new Error('Provided callback for onhintclose was not a function.');}
return this;},onexit:function(providedCallback){if(typeof(providedCallback)==='function'){this._introExitCallback=providedCallback;}else{throw new Error('Provided callback for onexit was not a function.');}
return this;},addHints:function(){_populateHints.call(this,this._targetElement);return this;}};exports.introJs=introJs;return introJs;}));